%!PS-Adobe-3.0
%%Creator: groff version 1.15
%%CreationDate: Sat Jan 27 21:33:02 2001
%%DocumentNeededResources: font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%+ font Courier
%%DocumentSuppliedResources: procset grops 1.15 1
%%Pages: 24
%%PageOrder: Ascend
%%Orientation: Portrait
%%EndComments
%%BeginProlog
%%BeginResource: procset grops 1.15 1
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/MF{
findfont
[5 2 roll
0 3 1 roll
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}bind def
/DA{
newpath arcn stroke
}bind def
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
/DL{
SN
moveto
SN
lineto stroke
}bind def
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
/FL{
currentgray exch setgray fill setgray
}bind def
/BL/fill load def
/LW/setlinewidth load def
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
}bind def
/PEND{
clear
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%IncludeResource: font Times-Bold
%%IncludeResource: font Times-Italic
%%IncludeResource: font Times-Roman
%%IncludeResource: font Courier
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 841.89 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron
/Zcaron/scaron/zcaron/Ydieresis/trademark/quotesingle/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/Courier@0 ENC0/Courier RE/Times-Roman@0 ENC0/Times-Roman RE
/Times-Italic@0 ENC0/Times-Italic RE/Times-Bold@0 ENC0/Times-Bold RE
%%EndProlog
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
/F0 12/Times-Bold@0 SF(The A)208.476 123 Q(pollo Incident: Evidence.)-.3
E/F1 10/Times-Italic@0 SF(Thomas Roessler <r)189.25 147 Q
(oessler@does-not-e)-.45 E(xist.or)-.2 E(g>)-.37 E(ABSTRA)264.535 183 Q
(CT)-.3 E/F2 10/Times-Roman@0 SF(apollo.hone)133 210.6 Q .56(yp.edu w)
-.15 F .56(as attack)-.1 F .56(ed on No)-.1 F 3.06(v72)-.15 G .56
(000, 23:11:51, e)-3.06 F .56(xploiting a format b)-.15 F(ug)-.2 E .53
(present in)108 222.6 R/F3 10/Times-Bold@0 SF -.1(rp)3.03 G(c.statd).1 E
F2 5.53(.T)C .53(he e)-5.53 F .53(xploit used is kno)-.15 F .53(wn as)
-.25 F F3(statdx)3.03 E F2 5.53(.T)C .53(he attack)-5.53 F(er)-.1 E 3.03
(,o)-.4 G .53(perating from)-3.03 F .913(the IP addresses 216.216.74.2 \
and 24.12.200.186, then installed a collection of trojaned)108 234.6 R
.246(programs from v)108 246.6 R .246(arious root kits.)-.25 F 2.746(Ap)
5.246 G(ack)-2.746 E .246(et snif)-.1 F .246(fer w)-.25 F .246
(as started, and a v)-.1 F .246(ersion of)-.15 F F3(sshd)2.746 E F2
(con-)2.746 E .368(taining a back-door and a passw)108 258.6 R .368
(ord logging f)-.1 F .368(acility w)-.1 F .368(as installed.)-.1 F .367
(Also, the)5.367 F F3(BitchX)2.867 E F2(IRC)2.867 E 1.138(client w)108
270.6 R 1.138(as run, and an attempt w)-.1 F 1.139
(as made to install the)-.1 F F3(eggdr)3.639 E(op)-.18 E F2 1.139
(IRC bot.)3.639 F 1.139(The intruder)6.139 F .516(installed v)108 282.6
R .516(arious tools suitable for attacking other systems.)-.25 F .515
(At the same time, he tried to)5.516 F(mak)108 294.6 Q 2.5(es)-.1 G
(ure that apollo w)-2.5 E(as itself not vulnerable to these attacks.)-.1
E F3 2.5(1. T)72 330.6 R(ools used f)-.92 E(or the in)-.25 E -.1(ve)-.4
G(stigation).1 E F2(The most important tools used in the in)87 346.2 Q
-.15(ve)-.4 G(stig).15 E(ation of this incident were:)-.05 E F3<83>87
361.8 Q F2 4.453(The Unix)21.5 F F3(strings)6.953 E F2 4.453
(\(1\) command, which w)B 4.454(as applied in order to e)-.1 F 4.454
(xtract human-readable)-.15 F(information from all kinds of binary \214\
les, including the hard disk images pro)112 373.8 Q(vided.)-.15 E F3<83>
87 389.4 Q F2 -1.11(Va)21.5 G .069(rious commands from)1.11 F F1 .069
(The Cor)2.569 F(oner')-.45 E 2.569(sT)-.4 G(oolkit)-3.489 E F2 .068
(by W)2.569 F .068(ietse V)-.4 F .068(enema and Dan F)-1.11 F(armer)-.15
E 5.068(.I)-.55 G 2.568(np)-5.068 G(articular)-2.568 E(,)-.4 E F3(gra)
112 401.4 Q -.1(ve)-.25 G(-r).1 E(ob)-.18 E(ber)-.1 E F2(\(1\),)A F3
(ils)2.5 E F2(\(1\),)A F3(icat)2.5 E F2(\(1\), and)A F3(mactime)2.5 E F2
(\(1\) were v)A(ery helpful.)-.15 E F3<83>87 417 Q F2(The)21.5 E F3 -.1
(rp)3.034 G(m).1 E F2 .534(package manager)3.034 F 5.534(.T)-.55 G .534
(his program helped to identify \214les which had been altered by the)
-5.534 F(intruder)112 429 Q(.)-.55 E F3<83>87 444.6 Q F2
(Standard Unix board means, including)21.5 E F3(awk)2.5 E F2(\(1\),)A F3
(gr)2.5 E(ep)-.18 E F2(\(1\),)A F3(sed)2.5 E F2(\(1\), and)A F3(sort)2.5
E F2(\(1\).)A F3 21.5<836f>87 460.2 S(bjdump)-21.5 E F2(\(1\), and)A F3
(gdb)2.5 E F2(\(1\) were used to disassemble one binary)A(.)-.65 E
(The system used to perform the actual analysis w)87 475.8 Q
(as a standard Debian GNU/Linux 2.2 system.)-.1 E F3 2.5(2. Gi)72 499.8
R -.1(ve)-.1 G 2.5(ni).1 G(nf)-2.5 E(ormation)-.25 E F2(The follo)87
515.4 Q(wing pieces of e)-.25 E
(vidence and informations on the system were kno)-.25 E(wn beforehand:)
-.25 E F3<83>87 531 Q F2(apollo w)21.5 E
(as a standard RedHat 6.2 installation.)-.1 E F3<83>87 546.6 Q F2 3.279
(An intrusion detection system installed on the same netw)21.5 F 3.279
(ork had logged the information)-.1 F(published at [http://project.hone)
112 558.6 Q(ynet.or)-.15 E(g].)-.18 E(As a basis for the in)87 574.2 Q
-.15(ve)-.4 G(stig).15 E
(ation, dd'ed disk images from the system had been made a)-.05 E -.25
(va)-.2 G(ilable.).25 E F3 2.5(3. Modi\214ed)72 598.2 R
(system \214les: The r)2.5 E(oot kit \(and other backdoors\).)-.18 E F2
.483(As a v)87 613.8 R .484
(ery \214rst step, the disk images were mounted as mnt/, and consistenc)
-.15 F 2.984(yo)-.15 G 2.984(ft)-2.984 G .484(he system w)-2.984 F .484
(as v)-.1 F(eri\214ed)-.15 E(using)87 625.8 Q F3 -.1(rp)2.5 G(m).1 E F2
(\(8\), speci\214cally looking for md5 checksum mismatches:)A/F4 8
/Courier@0 SF 4.8(#r)102 643.8 S(pm -V -a --root=`pwd`/mnt/ | grep ^..5)
-4.8 E F2(The output [see \214le)87 665.4 Q/F5 10/Courier@0 SF
(md5sum.mismatches)2.5 E F2
(for full results] in particular contains the follo)2.5 E(wing lines:)
-.25 E F4 9.6(S.5..... /bin/ls)102 683.4 R 9.6(S.5..... /bin/netstat)102
695.4 R 9.6(S.5..... /sbin/ifconfig)102 707.4 R 9.6
(SM5..... /usr/sbin/in.identd)102 719.4 R 9.6(S.5..... /bin/ps)102 731.4
R F2(27 January 2001)254.95 768 Q EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-2-)282.17 48 Q/F1 8/Courier@0 SF 9.6
(S.5..... /usr/bin/top)102 84 R 9.6(S.5..... /usr/sbin/tcpd)102 96 R F0
.513(This implies that each of these programs has a size and md5 checks\
um dif)87 114 R .513(ferent from the ones present)-.25 F .631
(in the package manager')87 126 R 3.131(sd)-.55 G .631(atabase, b)-3.131
F .631(ut that the time stamps, \212 with the e)-.2 F .632
(xception of in.identd \212 \214le)-.15 F(modes, and o)87 138 Q
(wnerships are identical to the ones listed in the package manager')-.25
E 2.5(sd)-.55 G(atabase.)-2.5 E 1.644(This observ)87 153.6 R 1.644
(ation leads to the suspicion that the attack)-.25 F 1.643
(er has installed a root kit on the system, and)-.1 F 1.889
(modi\214ed the \214les' time stamps.)87 165.6 R 1.889(It is e)6.889 F
1.889(xpected that these programs will hide netw)-.15 F 1.89
(ork connections,)-.1 F(processes, and \214les.)87 177.6 Q 2.105 -.8
(We i)87 193.2 T -1.85 -.4(nv e).8 H(stig).4 E .505
(ate each of the binaries with the)-.05 F/F2 10/Times-Bold@0 SF(strings)
3.005 E F0 .505(\(1\) command \(using the)B/F3 10/Courier@0 SF(-a)3.004
E F0 .504(command line switch\),)3.004 F(looking for unusual strings.)87
205.2 Q 1.6 -.8(We \214)5 H(nd the follo).8 E(wing remarkable f)-.25 E
(acts:)-.1 E F2(/bin/ls)87 220.8 Q F0 .374
(This \214le is \212 quite unusual for a glibc-based Linux distrib)112
232.8 R .374(ution \212 a binary link)-.2 F .374(ed ag)-.1 F .374
(ainst libc5,)-.05 F(using)112 244.8 Q F2(ld-linux.so.1)4.253 E F0 6.753
(.F)C 1.752(urther inspecting the output of)-6.753 F F2(strings)4.252 E
F0 1.752(\(1\), we \214nd a reference to a \214le)B(named)112 256.8 Q F2
(/usr/man/r)3.525 E F0 3.525(,w)C 1.025(hich is certainly untypical for)
-3.525 F F2(ls)3.525 E F0 6.025(.T)C 1.025(he \214le does, ho)-6.025 F
(we)-.25 E -.15(ve)-.25 G 1.825 -.4(r, e).15 H 1.025(xist on apollo,).25
F 1.478(and contains a list of \214les most lik)112 268.8 R 1.478
(ely hidden by this v)-.1 F 1.477(ersion of)-.15 F F2(ls)3.977 E F0
6.477(.A)C(dditionally)-6.477 E 3.977(,w)-.65 G 3.977<658c>-3.977 G
1.477(nd the)-3.977 F(follo)112 280.8 Q(wing strings in the)-.25 E F2
(ls)2.5 E F0(binary \(which is not stripped\):)2.5 E F1
(/home/aarons2/. /.d/lrk4/fileutils-3.13/src/)137 298.8 Q
(/home/aarons2/. /.d/lrk4/fileutils-3.13/intl/)137 310.8 Q
(/home/aarons2/. /.d/lrk4/fileutils-3.13/lib/)137 322.8 Q F0 .212
(From this, we conclude that the trojaned \214les most lik)112 340.8 R
.212(ely come from)-.1 F F3(lrk4)2.712 E F0 2.712<8a74>C .212
(he Linux Root Kit)-2.712 F -.15(ve)112 352.8 S(rsion 4.).15 E(The)5 E
2.5(ya)-.15 G(lso gi)-2.5 E .3 -.15(ve s)-.25 H
(ome hints on where this v).15 E(ersion of the root kit w)-.15 E(as b)
-.1 E(uilt.)-.2 E F2(/bin/netstat)87 368.4 Q F0 2.452
(This \214le is once ag)112 380.4 R 2.452(ain a binary link)-.05 F 2.452
(ed ag)-.1 F 2.452(ainst libc5.)-.05 F 4.052 -.8(We \214)7.452 H 2.451
(nd a reference to a \214le named).8 F F2(/usr/libexec/awk/addy)112
392.4 Q(.awk)-.7 E F0 5.523(,w)C 3.024
(hich is present on apollo, and consists of pairs of one-digit)-5.523 F
.249(numbers and IP addresses.)112 404.4 R .249
(This \214le is contained in the list of \214les hidden by the trojaned)
5.249 F F2(/bin/ls)2.748 E F0(.)A
(The published source code of lrk4 yields the follo)112 416.4 Q
(wing interpretation:)-.25 E F2<83>112 432 Q F0(An)21.5 E 3.844(yc)-.15
G 1.345(onnections from or to IP addresses which contain \212 when writ\
ten in dotted-quad)-3.844 F(notation \212 the strings)137 444 Q F3(65.1)
2.5 E F0(or)2.5 E F3(216.149)2.5 E F0(are not displayed in)2.5 E F2
(netstat)2.5 E F0 1.1 -.55('s o)D(utput.).55 E F2<83>112 459.6 Q F0
(The tw)21.5 E 2.5(ol)-.1 G(ines)-2.5 E F1 4.8(11)162 477.6 S
(34518464.134518444)-4.8 E 4.8(21)162 489.6 S(34518464.134518444)-4.8 E
F0(do not, ho)137 507.6 Q(we)-.25 E -.15(ve)-.25 G .8 -.4(r, m).15 H(ak)
.4 E 2.5(ea)-.1 G .3 -.15(ny i)-2.5 H(mmediate sense from the root kit')
.15 E 2.5(ss)-.55 G(ource code.)-2.5 E F2(/sbin/ifcon\214g)87 523.2 Q F0
1.385(This is another binary link)112 535.2 R 1.385(ed ag)-.1 F 1.385
(ainst libc5.)-.05 F 1.385(There are no e)6.385 F 1.384
(vidently strange strings in this \214le.)-.25 F(Ho)112 547.2 Q(we)-.25
E -.15(ve)-.25 G 2.076 -.4(r, w).15 H 3.776(ed).4 G(o)-3.776 E/F4 10
/Times-Italic@0 SF(not)3.776 E F0 1.276(see the string)3.776 F F3
(PROMISC)3.776 E F0 1.276(in the)3.776 F F2(strings)3.776 E F0 1.276
(\(1\) output produced. This string is)B .808(normally present in)112
559.2 R F2(/sbin/ifcon\214g)3.307 E F0 5.807(.W)C 3.307(ec)-6.607 G .807
(onclude that this v)-3.307 F .807(ersion of)-.15 F F2(ifcon\214g)3.307
E F0 .807(is unable to report)3.307 F .28(that an interf)112 571.2 R .28
(ace is in promiscuous mode \212 probably to co)-.1 F -.15(ve)-.15 G
2.78(ru).15 G 2.78(pap)-2.78 G(ack)-2.78 E .28(et snif)-.1 F .28
(fer installed on the)-.25 F(tar)112 583.2 Q(get system.)-.18 E F2
(/usr/sbin/in.identd)87 598.8 Q F0 .306(This program w)112 610.8 R .306
(as link)-.1 F .306(ed ag)-.1 F .306(ainst glibc, and thus most lik)-.05
F .305(ely does not come from the same source)-.1 F
(as the root kit programs. Interesting strings we w)112 622.8 Q(ouldn')
-.1 E 2.5(te)-.18 G(xpect here include these:)-2.65 E F1(-i)137 640.8 Q
(sh)137 652.8 Q(/bin/sh)137 664.8 Q(/tmp/.fileMeYV0p)137 676.8 Q
(open exec file)137 688.8 Q(execute program)137 700.8 Q
(envoye_don_le_trojan)137 712.8 Q F0(27 January 2001)254.95 768 Q EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-3-)282.17 48 Q 2.614(Aw)112 84 S .114
(eb search for some of these speci\214c strings is not successful.)
-2.614 F .115(In order to \214nd out the function)5.115 F
(of the program, we tak)112 96 Q 2.5(eal)-.1 G
(ook at the disassembly output generated by the command:)-2.5 E/F1 8
/Courier@0 SF 4.8(#o)137 114 S(bjdump -CdRS)-4.8 E F0([See \214le)112
132 Q/F2 10/Courier@0 SF(in.identd.S)2.5 E F0(for the ra)2.5 E 2.5(wo)
-.15 G(utput.])-2.5 E 1.6 -.8(We n)112 147.6 T
(ote in particular the follo).8 E(wing f)-.25 E(acts:)-.1 E/F3 10
/Times-Bold@0 SF 21.5<8369>112 163.2 S(n.identd)-21.5 E F0 1.762
(\214rst in)4.262 F -.2(vo)-.4 G -.1(ke).2 G 4.261(st).1 G 1.761
(he function)-4.261 F F2(envoye_don_le_trojan)4.261 E F0 6.761(.T)C
1.761(his function checks)-6.761 F 1.388
(the origin of an incoming connection using)137 175.2 R F3(getpeer)3.888
E(name)-.15 E F0 3.888(\(2\). If)B 1.389(the connection')3.888 F 3.889
(ss)-.55 G(ource)-3.889 E(port is 49239 or 49240, an interacti)137 187.2
Q .3 -.15(ve s)-.25 H(hell is started.).15 E F3<83>112 202.8 Q F0
(Otherwise,)21.5 E F3(in.identd)7.747 E F0 5.246(copies a lar)7.747 F
5.246(ge part of its data se)-.18 F 5.246(gment to a \214le named)-.15 F
F3(/tmp/.\214leMeYV0p)137 214.8 Q F0 3.817(,c)C(hmod')-3.817 E 3.817(st)
-.55 G 1.318(his \214le to mode 0700, and then uses)-3.817 F F3(execv)
3.818 E(e)-.1 E F0 1.318(\(2\) to run that)B 5.246(program. [A)137 226.8
R(cop)5.246 E 5.246(yi)-.1 G 5.246(si)-5.246 G 2.746(ncluded as)-5.246 F
F2(dot-fileMeYV0p)5.245 E F0 7.745(.I)C 5.245(tw)-7.745 G 2.745
(as generated by actually)-5.345 F(running the f)137 238.8 Q(ak)-.1 E(e)
-.1 E F3(in.identd)2.5 E F0(.])A 1.763(See \214le)112 254.4 R F2
(in.identd.s)4.263 E F0 1.763(for an annotated v)4.263 F 1.763
(ersion of the rele)-.15 F -.25(va)-.25 G 1.764
(nt code sections' disassembler).25 F 3.198(listings. It')112 266.4 R
3.198(sw)-.55 G .698
(orth noting that the coding style used is at times bizarre:)-3.298 F
-.15(Fo)5.697 G 3.197(ri).15 G .697(nstance, the actual)-3.197 F
(binary is written using calls of the type:)112 278.4 Q F1
(fprintf \(fp, "%c", mem[i]\))137 296.4 Q F0(This is not v)112 314.4 Q
(ery ef)-.15 E(\214cient.)-.25 E 3.627 -.8(We n)112 330 T 2.527 -.25
(ow t).8 H 2.027(urn to).25 F F3(.\214leMeYV0p)4.527 E F0 7.028(.R)C
(unning)-7.028 E F3(strings)4.528 E F0 2.028(\(1\) on it re)B -.15(ve)
-.25 G 2.028(als, in particular).15 F 4.528(,t)-.4 G 2.028(he follo)
-4.528 F(wing)-.25 E(character strings:)112 342 Q F1(/.noident)137 360 Q
(/.fakeid)137 372 Q
(parse.c: trying to do masqueraded ident: %lX %X %X %lX %X)137 384 Q
(parse.c: succesful determined masqueraded ident)137 396 Q
(/usr/local/etc/identd.masq)137 408 Q(/proc/net/ip_masquerade)137 420 Q
(2.8.5fm)137 432 Q F0 .831(These strings are consistent with, for insta\
nce, the description of a modi\214ed v)112 450 R .83(ersion of)-.15 F F3
(pidentd)3.33 E F0 2.49(which is at least distrib)112 462 R 2.49
(uted with Mandrak)-.2 F 4.99(eL)-.1 G 2.49(inux, see http://www)-4.99 F
(.sjc.com/LinuxSoft/rpms/-)-.65 E(RPMS/mandrak)112 474 Q
(e7.0/rpms/pidentd-2.8.5-7mdk.i586.html for details.)-.1 E .95(The o)112
489.6 R -.15(ve)-.15 G .95(rall structure observ).15 F .949
(ed can best be described as a generic backdoor wrapper for serv)-.15 F
(ers)-.15 E(which are e)112 501.6 Q(xpected to be e)-.15 E -.15(xe)-.15
G(cuted from).15 E F3(inetd)2.5 E F0(\(8\).)A 2.516 -.8(We \214)112
517.2 T .916
(nally note that the trojan features of this program were not acti).8 F
-.15(ve)-.25 G 3.417(,s).15 G .917(ince the ident daemon)-3.417 F
(used is)112 529.2 Q F3(/usr/bin/identd)2.5 E F0 2.5(,a)C
(nd since this service is not run from)-2.5 E F3(inetd)2.5 E F0(\(8\).)A
F3(/bin/ps)87 544.8 Q(/usr/bin/top)87 560.4 Q F0 .406
(These are libc5 binaries, too.)112 572.4 R .406(The most remarkable f)
5.406 F .406(act is a reference to)-.1 F F3(/de)2.906 E(v/ptyp)-.15 E F0
2.906(,w)C .406(hich e)-2.906 F(xists)-.15 E .396(in both programs.)112
584.4 R .396(This \214le e)5.396 F .396
(xists on apollo, and consists of pairs of one-digit numbers and what)
-.15 F .07(looks lik)112 596.4 R 2.57(ef)-.1 G .07
(ragments of program names.)-2.57 F .07
(According to the published source code of lrk4, the lines)5.07 F
(pre\214x)112 608.4 Q .568
(ed with the digit 2 contain strings which are matched e)-.15 F .569
(xactly ag)-.15 F .569(ainst a process name \(and,)-.05 F 1.031
(if matched, hidden\), while lines pre\214x)112 620.4 R 1.031
(ed with the digit 3 contain fragments which are matched)-.15 F(ag)112
632.4 Q(ainst process names.)-.05 E F3(/usr/bin/tcpd)87 648 Q F0 1.124
(This is a binary link)112 660 R 1.124(ed ag)-.1 F 1.125
(ainst glibc, and thus may come from a dif)-.05 F 1.125(ferent source .)
-.25 F 1.125(Looking at)6.125 F F3(strings)112 672 Q F0
(\(1\) output, we \214nd the follo)A(wing interesting string:)-.25 E F1
(/usr/man/.a)137 690 Q F0 1.649(Looking at the \214le)112 708 R F3
(/usr/man/.a)4.149 E F0 1.649(on apollo, we once ag)4.149 F 1.648
(ain \214nd pairs of one-digit inte)-.05 F 1.648(gers and)-.15 F 2.692
(strings. These)112 720 R .193(strings include what looks lik)2.692 F
2.693(ef)-.1 G .193(ragments of IP addresses and ports.)-2.693 F .193
(The one-digit)5.193 F(27 January 2001)254.95 768 Q EP
%%Page: 4 4
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-4-)282.17 48 Q(inte)112 84 Q .095
(gers range from 1 to 4.)-.15 F .095
(Looking at the public source of lrk4, we notice that this v)5.095 F
.094(ersion of the)-.15 F(root kit only supports a "magic" v)112 96 Q
(alue of 1 here.)-.25 E 1.958 -.8(We n)112 111.6 T .358(ote, ho).8 F(we)
-.25 E -.15(ve)-.25 G 1.158 -.4(r, t).15 H .358(hat the \214le').4 F
2.858(sf)-.55 G .358(ormat w)-2.858 F .358(ould mak)-.1 F 2.858(es)-.1 G
.358(ense for lrk5')-2.858 F 2.858(sm)-.55 G .358(odi\214ed v)-2.858 F
.358(ersion of)-.15 F/F1 10/Times-Bold@0 SF(netstat)2.858 E F0(.)A 2.163
-.8(We a)112 123.6 T .563(lso note that, with a "def).8 F .563(ault b)
-.1 F .563(uild" of either v)-.2 F .563(ersion 4 or 5 of lrk,)-.15 F F1
(tcpd)3.063 E F0(and)3.063 E F1(netstat)3.063 E F0 .563(use the)3.063 F
(same con\214guration \214le.)112 135.6 Q(Apparently)112 151.2 Q 3.228
(,t)-.65 G .729(he root kit binaries and con\214guration \214les actual\
ly used by the intruder come from)-3.228 F(dif)112 163.2 Q
(ferent sources, and b)-.25 E(uilds of root kit v)-.2 E(ersions.)-.15 E
1.6 -.8(We n)87 178.8 T .5 -.25(ow t).8 H(urn to other \214les which we\
re changed on the system, or added to system directories.).25 E F1
(/usr/sbin/named)87 194.4 Q(/usr/local/sbin/named)87 210 Q
(/usr/local/sbin/named-bootconf)87 225.6 Q(/usr/local/sbin/ndc)87 241.2
Q(/usr/local/sbin/ir)87 256.8 Q(pd)-.1 E F0 3.572 -.8(We n)112 268.8 T
1.972(ote that).8 F F1(/usr/sbin/named)4.472 E F0(and)4.472 E F1
(/usr/local/sbin/named)4.472 E F0 1.972
(are identical binaries, and that the)4.472 F(system')112 280.8 Q 2.679
(sd)-.55 G(ef)-2.679 E(ault)-.1 E F1(named)2.679 E F0 .179
(binary has been changed.)2.679 F(Applying)5.179 E F1(strings)2.679 E F0
.179(\(1\) to this binary)B 2.68(,w)-.65 G 2.68<658c>-2.68 G .18(nd the)
-2.68 F(follo)112 292.8 Q(wing interesting strings:)-.25 E/F2 8
/Courier@0 SF(@\(#\)named 8.2.2-P5 Thu Nov 25 16:18:38 CST 1999)137
310.8 Q(\\)33.6 E(root@zagnut.goobe.net:/dev/.oz/src/bin/named)162 322.8
Q($Id: version.c,v 8.3 1999/01/02 06:05:14 vixie Exp $)137 334.8 Q
(named 8.2.2-P5 Thu Nov 25 16:18:38 CST 1999)137 346.8 Q
(root@zagnut.goobe.net:/dev/.oz/src/bin/named)137 358.8 Q(8.2.2-P5)137
370.8 Q F0(\(Lines brok)112 388.8 Q(en for readability)-.1 E(.\))-.65 E
5.172(This does, in particular)112 404.4 R 7.672(,t)-.4 G 5.172
(ell us that this v)-7.672 F 5.172(ersion of)-.15 F F1(named)7.672 E F0
-.1(wa)7.672 G 7.672(sb).1 G 5.172(uilt on the host)-7.872 F/F3 10
/Courier@0 SF(zagunt.goobe.net)112 416.4 Q F0 2.342(in directory)4.842 F
F1(/de)4.842 E(v/.oz)-.15 E F0 7.342(.I)C 4.842(ti)-7.342 G 4.842(sl)
-4.842 G(ik)-4.842 E 2.342(ely that)-.1 F F3(zagunt.goobe.net)4.842 E F0
-.1(wa)4.842 G 4.842(sa).1 G .425(system attack)112 428.4 R .425
(ed earlier)-.1 F 2.925(,a)-.4 G .425(nd that the)-2.925 F F1(/de)2.925
E(v/.oz)-.15 E F0 .425(directory w)2.925 F .424(as the intruder')-.1 F
2.924(sw)-.55 G .424(orking directory)-3.024 F 5.424(.T)-.65 G(he)-5.424
E -.2(bu)112 440.4 S .658(ild w).2 F .658(as performed on No)-.1 F 3.158
(v2)-.15 G 3.158(51)-3.158 G 3.158(999. 8.2.2-P5)-3.158 F .658(is the v)
3.158 F .658(ersion of)-.15 F F1(named)3.158 E F0 .658(which w)3.158 F
.659(as released by)-.1 F .679(the ISC on No)112 452.4 R 3.179(v1)-.15 G
3.179(21)-3.179 G .679(999 in response to the security holes co)-3.179 F
-.15(ve)-.15 G .678(red in CER).15 F 3.178(Ta)-.6 G .678
(dvisory CA-99.14.)-3.178 F .681(It seems lik)112 464.4 R .681
(ely that this v)-.1 F .681(ersion of)-.15 F F1(bind)3.181 E F0 -.1(wa)
3.181 G 3.181(si).1 G .681
(nstalled in an attempt to secure the system ag)-3.181 F(ainst)-.05 E
(other intruders trying to e)112 476.4 Q(xploit these errors.)-.15 E
2.974 -.8(We \214)112 492 T 1.373
(nally note that there are more \214les in).8 F F1(/usr/local/)3.873 E
F0 1.373(which belong to a ne)3.873 F 1.373(wly installed bind)-.25 F
(distrib)112 504 Q(ution.)-.2 E F1(/etc/r)87 519.6 Q(c.d/r)-.18 E
(c.local)-.18 E(/usr/local/sbin/sshd1)87 535.2 Q F0 .059(The attack)112
547.2 R .059(er has installed an ssh1 serv)-.1 F(er)-.15 E 5.059(.W)-.55
G 2.559(ew)-5.859 G .06(ill come back to this serv)-2.559 F .06
(er in the dumpster di)-.15 F(ving)-.25 E(section of this report.)112
559.2 Q(It contains a back-door and passw)5 E(ord logging code.)-.1 E F1
(/usr/sbin/in.telnetd)87 574.8 Q F0 -.8(We)112 586.8 S -.1('l).8 G 3.588
(ll).1 G 1.087(ater \214nd out that this md5 mismatch is actually cause\
d by a con\215ict between a package)-3.588 F(installed by the attack)112
598.8 Q(er and a package which w)-.1 E(as part of the def)-.1 E
(ault installation.)-.1 E F1(/usr/tmp/nap)87 614.4 Q F0 .19
(This \214le contains what looks lik)112 626.4 R 2.69(et)-.1 G .19
(he output of a passw)-2.69 F .19(ord-logging backdoor)-.1 F 5.19(.W)
-.55 G(e')-5.99 E .19(ll later \214nd out)-.1 F
(that it has been generated by the ssh1 serv)112 638.4 Q
(er on the system.)-.15 E 1.67 -.8(We n)87 654 T .57 -.25(ow u).8 H(se)
.25 E F1(\214nd)2.57 E F0 .07
(to search for recently-modi\214ed directories.)2.57 F .069
(The output can be found in)5.069 F F3(dirlist)2.569 E F0 5.069(.A)C(t)
-5.069 E 1.861(this point, we just mention the)87 666 R F1(/usr/man/.Ci)
4.361 E F0(directory)4.361 E 4.361(,a)-.65 G 1.862(nd the \214le)-4.361
F F1(/bin/bx)4.362 E F0(.)A F1(/usr/man/.Ci)6.862 E F0 -.1(wa)4.362 G
4.362(st).1 G(he)-4.362 E(intruder')87 678 Q 3.98(st)-.55 G 1.48
(ool chest.)-3.98 F -.8(We)6.48 G -.1('l).8 G 3.98(lc).1 G -.15(ove)
-3.98 G 3.98(ri).15 G 3.98(ti)-3.98 G 3.98(nd)-3.98 G 1.479
(etail in the timeline section of this report.)-3.98 F F1(/bin/bx)6.479
E F0 1.479(is some)3.979 F -.15(ve)87 690 S
(rsion of the BitchX IRC client which gi).15 E -.15(ve)-.25 G 2.5(su).15
G 2.5(sah)-2.5 G(int about the intruder')-2.5 E 2.5(sm)-.55 G(oti)-2.5 E
-.15(ve)-.25 G(s.).15 E(Finally)87 705.6 Q 3.635(,w)-.65 G 3.635(em)
-3.635 G 1.135(ention that four \214les are stored in the directory)
-3.635 F F1(/usr/man)3.635 E F0 3.635(,n)C(amely)-3.635 E F1(.a)3.635 E
F0(,)A F1(.p)3.635 E F0(,)A F1(p)3.635 E F0 3.635(,a)C(nd)-3.635 E F1(r)
3.635 E F0 6.135(.W)C(e)-6.935 E(ha)87 717.6 Q 3.048 -.15(ve a)-.2 H
2.748(lready seen that).15 F F1(r)5.248 E F0 2.748
(is the con\214guration \214le for the root kit')5.248 F(s)-.55 E F1(ls)
5.248 E F0(binary)5.248 E 5.248(,a)-.65 G 2.748(nd that)-5.248 F F1(.a)
5.248 E F0 2.747(is the)5.247 F .867
(con\214guration \214le for the trojan horse v)87 729.6 R .867
(ersion of)-.15 F F1(tcpd)3.367 E F0 3.367(\(8\). W)B(e')-.8 E .867
(ll later see that)-.1 F F1(.p)3.367 E F0 .868(is used by an unused)
3.367 F(27 January 2001)254.95 768 Q EP
%%Page: 5 5
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-5-)282.17 48 Q 1.072(root kit v)87 84 R 1.072
(ersion of)-.15 F/F1 10/Times-Bold@0 SF(pstr)3.571 E(ee)-.18 E F0 1.071
(which is a)3.571 F -.25(va)-.2 G 1.071(ilable in the attack).25 F(er')
-.1 E 3.571(st)-.55 G 1.071(ool chest.)-3.571 F F1(p)6.071 E F0 2.171
-.55('s c)D 1.071(ontents are identical to).55 F F1(.p)87 96 Q F0 -.55
('s)C 2.996(,a).55 G .496(nd we')-2.996 F .496
(ll later \214nd a reference for a \214le with the same name, b)-.1 F
.496(ut in a dif)-.2 F .497(ferent directory in a root)-.25 F(kit v)87
108 Q(ersion of)-.15 E F1(killall)2.5 E F0(.)A(Finally)87 123.6 Q 4.019
(,w)-.65 G 4.019(eu)-4.019 G 1.519(nmount the)-4.019 F F1(/usr)4.019 E
F0(,)A F1(/v)4.019 E(ar)-.1 E F0(,)A F1(/boot)4.019 E F0 4.019(,a)C(nd)
-4.019 E F1(/home)4.019 E F0 1.519
(partitions from apollo, and look for an)4.019 F 4.018<798c>-.15 G(les)
-4.018 E(hidden in the mount point directories of the root partition.)87
135.6 Q 1.6 -.8(We \214)5 H(nd nothing.).8 E F1 2.5(4. Dumpster)72 159.6
R(di)2.5 E(ving 1: Looking f)-.1 E(or log \214les.)-.25 E F0
(In this section, we look mainly for)87 175.2 Q F1(syslog)2.5 E F0
(-generated, and)A F1(.bash_history)2.5 E F0(\214les.)2.5 E F1 2.5
(4.1. Shell)72 199.2 R(histories.)2.5 E(\214nd)87 214.8 Q F0(\(1\) re)A
-.15(ve)-.25 G(als the follo).15 E(wing \214les and symbolic links:)-.25
E/F2 8/Courier@0 SF(./.bash_history -> /dev/null)106.8 232.8 Q
(./home/drosen/.bash_history)106.8 244.8 Q
(./root/.bash_history -> /dev/null)106.8 256.8 Q
(./tmp/.bash_history -> /dev/null)106.8 268.8 Q
(./usr/games/.bash_history -> /dev/null)106.8 280.8 Q F0([See)87 298.8 Q
/F3 10/Courier@0 SF(bash-histories)2.5 E F0
(for full output including time stamps.])2.5 E 5.03 -.8(We n)87 314.4 T
3.43(ote that all symbolic links ha).8 F 3.73 -.15(ve c)-.2 H 3.43
(times and mtimes dating on No).15 F 5.93(v80)-.15 G 3.43(8:52 CST)-5.93
F 5.93(,w)-.74 G(hile)-5.93 E F1(/home/dr)87 326.4 Q(osen/.bash_history)
-.18 E F0 1.767 -.55('s m)D .667(time and ctime are both 08:59 CST).55 F
5.667(.T)-.74 G .667(he contents of this \214le hea)-5.667 F(vily)-.2 E
.528(look lik)87 338.4 R 3.028(es)-.1 G .528
(omeone installed \(and possibly compiled\) softw)-3.028 F .529
(are using the)-.1 F F3(drosen)3.029 E F0 3.029(account. W)3.029 F(e')
-.8 E .529(ll come)-.1 F(back to this \214le in the dumpster di)87 350.4
Q(ving 3 and timeline sections of this report.)-.25 E F1 2.5
(4.2. System)72 374.4 R(log \214les and snippets.)2.5 E F0(Inspecting)87
390 Q F1(/v)3.785 E(ar/log/messages)-.1 E F0 3.785(,w)C 3.785(en)-3.785
G 1.285(ote that this \214le doesn')-3.785 F 3.785(ts)-.18 G(ho)-3.785 E
3.785(wa)-.25 G 1.585 -.15(ny s)-3.785 H 1.285
(igns of the RPC-based attack).15 F .025
(mentioned in the intrusion detection system')87 402 R 2.525(sl)-.55 G
2.526(og. W)-2.525 F 2.526(ec)-.8 G .026
(an therefore assume that this \214le w)-2.526 F .026(as edited.)-.1 F
-.8(To)5.026 G 2.9(\214nd traces of unedited v)87 414 R 2.899
(ersions of this \214le, we apply the)-.15 F F1(strings)5.399 E F0 2.899
(\(1\) and)B F1(gr)5.399 E(ep)-.18 E F0 2.899(\(1\) commands to)B F3
(honeypot.hda7.dd)87 426 Q F0 7.37(.M)C 2.37(ore precisely)-7.37 F 4.87
(,w)-.65 G 4.871(eu)-4.87 G 2.371(se the follo)-4.871 F 2.371
(wing command in order to \214nd log \214le)-.25 F(snippets:)87 438 Q F2
4.8(#s)102 456 S(trings < /attic/forensics/honeypot.hda7.dd | \\)-4.8 E
(grep 'Nov)127 468 Q 4.8('|s)9.6 G(ort -u)-4.8 E F0
(The full results can be found in the \214le)87 486 Q F3(logsnippets)2.5
E F0 5(.I)C 2.5(np)-5 G(articular)-2.5 E 2.5(,w)-.4 G 2.5(en)-2.5 G
(otice the follo)-2.5 E(wing entries:)-.25 E F2 4.8(Nov 8)102 504 R
(00:08:40 apollo in.telnetd[2077]: connect from 216.216.74.2)4.8 E 4.8
(Nov 8)102 516 R
(00:08:40 apollo in.telnetd[2078]: connect from 216.216.74.2)4.8 E 4.8
(Nov 8)102 528 R(00:08:41 apollo inetd[408]: pid 2077: exit status 1)4.8
E 4.8(Nov 8)102 540 R
(00:08:41 apollo inetd[408]: pid 2078: exit status 1)4.8 E 4.8(Nov 8)102
552 R(00:09:00 apollo rpc.statd[270]: SM_MON request for)4.8 E(\\)26.4 E
(hostname containing '/': ^D)127 564 Q F0 1.013
(The pattern we can observ)87 582 R 3.513(eh)-.15 G 1.013(ere is f)
-3.513 F 1.012(amiliar from the IDS output a)-.1 F -.25(va)-.2 G 3.512
(ilable: First,).25 F(tw)3.512 E 3.512(oc)-.1 G 1.012(onnections to)
-3.512 F F1(in.telnetd)87 594 Q F0 1.879
(are attempted from 216.216.74.2 \(A)4.378 F 4.379
(THM-216-216-xxx-2.home.net\). 20)-1.11 F 1.879(seconds later)4.379 F
4.379(,a)-.4 G(n)-4.379 E .753
(RPC request is made. Although the time stamps dif)87 606 R .753
(fer by almost an hour)-.25 F 3.252(,i)-.4 G 3.252(ti)-3.252 G 3.252(sv)
-3.252 G .752(ery lik)-3.402 F .752(ely that the log)-.1 F(\214le entir\
es and the IDS output actually describe the same sequence of e)87 618 Q
-.15(ve)-.25 G(nts.).15 E 4.53 -.8(We t)87 633.6 T 2.93
(herefore conclude that the system').8 F 5.43(sc)-.55 G 2.93(lock w)
-5.43 F 2.93(as actually 57:09 minutes ahead of NTP time.)-.1 F
(Additionally)87 645.6 Q 3.316(,f)-.65 G .816(rom the combination of ID\
S entries and log \214le entries, we conclude that the)-3.316 F F1 -.1
(rp)3.316 G(c.statd).1 E F0 3.063(format problem initially described by)
87 657.6 R/F4 10/Times-Italic@0 SF 3.063(Daniel J)5.563 F 3.063
(acobowitz <dr)-.35 F(ow@F)-.45 E(ALSE.ORG>)-1.15 E F0 3.063(on the)
5.563 F F1 -.2(bu)5.563 G(gtraq).2 E F0 1.997
(mailing list on Jul 16 2000 w)87 669.6 R 1.997(as e)-.1 F 4.497
(xploited. From)-.15 F 1.997
(the nature of the format string used, we further)4.497 F 6.848
(conclude that the e)87 681.6 R 6.848(xploit actually used w)-.15 F(as)
-.1 E F1(statdx)9.348 E F0 9.349(,p)C 6.849(osted to)-9.349 F F1 -.2(bu)
9.349 G(gtraq).2 E F0(by)9.349 E F4 -.45(ro)9.349 G 6.849(n1n \212).45 F
(<shellcode@HO)87 693.6 Q(TMAIL.COM>)-.4 E F0(on Aug 05 2000.)2.5 E
(Finally)87 709.2 Q 2.5(,w)-.65 G 2.5(ea)-2.5 G
(pply a simliar method to the sw)-2.5 E(ap image:)-.1 E F2 4.8(#s)102
727.2 S(trings < /attic/forensics/honeypot.hda9.dd | \\)-4.8 E F0
(27 January 2001)254.95 768 Q EP
%%Page: 6 6
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-6-)282.17 48 Q/F1 8/Courier@0 SF
(grep -A3 'Nov ')127 84 Q F0 .199(The full output is a)87 102 R -.25(va)
-.2 G .199(ilable as).25 F/F2 10/Courier@0 SF(logsnippets.swap)2.699 E
F0 5.198(.T)C .198(he follo)-5.198 F .198
(wing snippets are of particular interest)-.25 F(\(wrapped for con)87
114 Q -.15(ve)-.4 G(nience\):).15 E F1 4.8(<30>Nov 8)102 132 R
(20:54:25 named[2965]: XSTATS 973738465 973695265 \\)4.8 E
(RR=3 RNXD=0 RFwdR=1 RDupR=0 RFail=0 RFErr=0 RErr=0)127 144 Q(\\)9.6 E
(RAXFR=0 RLame=1 ROpts=0 SSysQ=1 SAns=37 SFwdQ=2)127 156 Q(\\)24 E
(SDupQ=8 SErr=0 RQ=39 RIQ=0 RFwdQ=0 RDupQ=0 RTCP=0)127 168 Q(\\)14.4 E
(SFwdR=1 SFail=0 SFErr=0 SNaAns=36 SNXD=0)127 180 Q(--)102 192 Q 4.8
(<85>Nov 8)102 204 R(20:37:37 login: ROOT LOGIN ON tty1)4.8 E(sion o)102
216 Q 4.8(df)102 228 S(or user root by LOGIN\(uid=0\))-4.8 E(of type %s)
106.8 240 Q(--)102 252 Q 4.8(<30>Nov 8)102 264 R
(08:54:25 named[2964]: Forwarding source address is)4.8 E(\\)32.2 E
([0.0.0.0].1037)127 276 Q 4.8(<30>Nov 8)102 288 R
(08:54:25 named[2964]: listening on [172.16.1.107].53 \(eth0\))4.8 E 4.8
(<30>Nov 8)102 300 R
(08:54:25 named[2964]: master zone "0.0.127.in-addr.arpa")4.8 E(\\)28.4
E(\(IN\) loaded \(serial 1997022700\))127 312 Q 4.8(<28>Nov 8)102 324 R
(08:54:25 named[2964]: Zone "0.0.127.in-addr.arpa")4.8 E(\\)37 E
(\(file named.local\): No default TTL set using SOA minimum instead)127
336 Q 4.8(<28>Nov 8)102 348 R
(08:59:52 inetd[408]: pid 2387: exit status 1)4.8 E 4.8(<86>Nov 8)102
360 R(08:28:41 login: LOGIN ON 0 BY adm1 FROM)4.8 E(\\)60 E
(c871553-b.jffsn1.mo.home.com)127 372 Q(--)102 384 Q 4.8(<38>Nov 8)102
396 R(0)4.8 E
(@pwdb[2404]: \(su\) session opened for user own by adm1\(uid=5000\))102
408 Q F0 .522
(It is interesting to note that most of these entries were not e)87
429.6 R -.15(ve)-.25 G 3.023(np).15 G .523(resent on the)-3.023 F/F3 10
/Times-Bold@0 SF(hda7)3.023 E F0 3.023(image. This)3.023 F(most)3.023 E
(lik)87 441.6 Q 4.169(ely implies that)-.1 F F3(syslogd)6.669 E F0 4.169
(has been shut do)6.669 F 4.168(wn before these e)-.25 F -.15(ve)-.25 G
4.168(nts occured.).15 F 4.168(\(According to)9.168 F F3(/etc/syslog)87
453.6 Q(.conf)-.15 E F0(,)A F3(syslogd)2.5 E F0 -.1(wa)2.5 G 2.5(sr).1 G
(unning in synchronuous mode.\))-2.5 E F3 2.5(5. Dumpster)72 477.6 R(di)
2.5 E(ving 2: Gr)-.1 E(epping f)-.18 E(or some random debris)-.25 E 2.5
(5.1. Looking)72 501.6 R -.25(fo)2.5 G 2.5(re).25 G -.4(nv)-2.5 G(ir).4
E(onments on the swap.)-.18 E F0 1.6 -.8(We n)87 517.2 T .5 -.25(ow l).8
H(ook for program en).25 E(vironments in the sw)-.4 E(ap space. W)-.1 E
2.5(eu)-.8 G(se the follo)-2.5 E(wing command:)-.25 E F1 4.8(#s)102
535.2 S(trings /attic/forensics/honeypot.hda9.dd | \\)-4.8 E
(egrep -A3 '[A-Z]+=')127 547.2 Q F0 1.236(Full output is a)87 565.2 R
-.25(va)-.2 G 1.236(ilable as).25 F F2(swap-environments)3.737 E F0
6.237(.I)C 3.737(np)-6.237 G(articular)-3.737 E 3.737(,w)-.4 G 3.737
<658c>-3.737 G 1.237(nd se)-3.737 F -.15(ve)-.25 G 1.237(ral en).15 F
1.237(vironments lik)-.4 F(e)-.1 E(this:)87 577.2 Q F1
(LESSOPEN=|/usr/bin/lesspipe.sh %s)102 595.2 Q(HISTSIZE=1000)102 607.2 Q
(HOSTNAME=apollo.honeyp.edu)102 619.2 Q(LOGNAME=adm1)102 631.2 Q
(REMOTEHOST=c871553-b.jffsn1.mo.home.com)102 643.2 Q
(MAIL=/var/spool/mail/adm1)102 655.2 Q(TERM=vt100)102 667.2 Q
(HOSTTYPE=i386)102 679.2 Q
(PATH=/usr/local/bin:/bin:/usr/bin:/usr/X11R6/bin)102 691.2 Q
(HOME=/root)102 703.2 Q(INPUTRC=/etc/inputrc)102 715.2 Q
(SHELL=/bin/bash)102 727.2 Q F0(27 January 2001)254.95 768 Q EP
%%Page: 7 7
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-7-)282.17 48 Q/F1 8/Courier@0 SF(USER=adm1)102
84 Q(LANG=en_US)102 96 Q(OSTYPE=Linux)102 108 Q(_=/usr/sbin/named)102
120 Q F0 .616(Elements common to these en)87 138 R .616
(vironments are the)-.4 F/F2 10/Courier@0 SF(vt100)3.116 E F0 .616
(terminal, the)3.116 F F2(REMOTEHOST)3.116 E F0 -.25(va)3.115 G(riable')
.25 E 3.115(sv)-.55 G(alue,)-3.365 E .082(and the)87 150 R F2 -3.418
(adm1 USER)2.582 F F0(or)2.582 E F2(LOGNAME)2.582 E F0 2.582
(settings. The)2.582 F F2(_)2.582 E F0(en)2.582 E .082(vironment v)-.4 F
.083(ariable is set by)-.25 F/F3 10/Times-Bold@0 SF(bash)2.583 E F0 .083
(\(1\) to contain the)B(last typed command.)87 162 Q 1.6 -.8(We d)5 H
(o, in particular).8 E 2.5<2c8c>-.4 G(nd the follo)-2.5 E(wing strings:)
-.25 E F1(_=/bin/su)102 180 Q(_=/usr/local/sbin/sshd)102 192 Q
(_=/usr/sbin/named)102 204 Q F0
(Each of these strings can be found in an en)87 222 Q
(vironment which mentions the)-.4 E F2(adm1)2.5 E F0(user)2.5 E(.)-.55 E
(Finally)87 237.6 Q 3.527(,w)-.65 G 3.527(ed)-3.527 G 1.027
(igress and \214nd some en)-3.527 F 1.027(vironment fragments which gi)
-.4 F 1.327 -.15(ve s)-.25 H 1.026(ome indication of ho).15 F 3.526(wt)
-.25 G 1.026(he \214le)-3.526 F
(system dumps were generated in the aftermath of the intrusion:)87 249.6
Q F1(LESSOPEN=|/usr/bin/lesspipe.sh %s)102 267.6 Q(USERNAME=root)102
279.6 Q(ENV=/root/.bashrc)102 291.6 Q(HISTSIZE=1000)102 303.6 Q
(HOSTNAME=apollo.honeyp.edu)102 315.6 Q(LOGNAME=root)102 327.6 Q
(MAIL=/var/spool/mail/root)102 339.6 Q(TERM=linux)102 351.6 Q
(HOSTTYPE=i386)102 363.6 Q(HOME=/root)102 375.6 Q(INPUTRC=/etc/inputrc)
102 387.6 Q(:*.xpm=)102 399.6 Q(SHELL=/bin/bash)102 411.6 Q(tif=)102
423.6 Q(USER=root)102 435.6 Q(LANG=en_US)102 447.6 Q(SHLVL=1)102 459.6 Q
(_=./nc)102 471.6 Q F0 .33(The follo)87 489.6 R .33(wing snippet is e)
-.25 F -.15(ve)-.25 G 2.83(nm).15 G .33(ore re)-2.83 F -.15(ve)-.25 G
.33(aling, although it').15 F 2.831(sp)-.55 G .331(ossibly not from a b)
-2.831 F(uf)-.2 E .331(fer used for an en)-.25 F(vi-)-.4 E
(ronment \(wrapped for con)87 501.6 Q -.15(ve)-.4 G(nience\):).15 E F1
([root@apollo linux]# ./dd bs=1024 < /dev/hda8 |)102 519.6 Q(\\)24.4 E
(./nc 192.168.1.10 10000 -w 3)127 531.6 Q(LANG)102 543.6 Q(en_US)102
555.6 Q(LANG)102 567.6 Q F3 2.5(5.2. What)72 597.6 R(accounts ha)2.5 E
.2 -.1(ve e)-.25 H -.1(ve)-.05 G 2.5(re).1 G
(xisted on the system? \212 and another disco)-2.5 E -.1(ve)-.1 G(ry).1
E(.)-.7 E F0 1.924 -.8(We h)87 613.2 T -2.25 -.2(av e).8 H 2.824(,s).2 G
2.824(of)-2.824 G(ar)-2.924 E 2.824(,s)-.4 G .324(een some e)-2.824 F
.324(vidence of accounts named)-.25 F F2(own)2.824 E F0(and)2.824 E F2
(adm1)2.824 E F0 .324(which seem to ha)2.824 F .623 -.15(ve ex)-.2 H
.323(isted on).15 F 1.493(the system.)87 625.2 R 1.493
(Still, none of these accounts occur in the)6.493 F F3(/etc/passwd)3.993
E F0(and)3.994 E F3(/etc/shado)3.994 E(w)-.1 E F0 1.494
(\214les on apollo.)3.994 F 2.943(Since it')87 637.2 R 5.443(st)-.55 G
2.943(ypical for entries in these \214les to contain colon-enclosed num\
bers, we simply apply)-5.443 F F3(strings)87 649.2 Q F0(\(1\) and)A F3
(gr)2.5 E(ep)-.18 E F0(\(1\) to the ra)A 2.5(wi)-.15 G
(mage, looking for such patterns:)-2.5 E F1 4.8(#s)102 667.2 S
(trings /attic/forensics/honeypot.hda8.dd | egrep ':[0-9]+:')-4.8 E F0
.076(The full output can be found in \214le)87 685.2 R F2
(passwd.suspects)2.576 E F0 5.076(.I)C -1.85 -.4(nv e)-5.076 H(stig).4 E
.077(ating that \214le, we \214nd lots of strings)-.05 F .66(which cont\
ain time stamps for source code \(which is something we are going to lo\
ok for in Dumpster)87 697.2 R(Di)87 709.2 Q .706(ving 3\).)-.25 F .707
(Still, we can isolate se)5.707 F -.15(ve)-.25 G .707(ral passwd-lik).15
F 3.207(ee)-.1 G .707(ntries which are stored in)-3.207 F F2
(passwd.snippets)3.207 E F0(.)A(Ev)87 721.2 Q .974(en better)-.15 F
3.474(,w)-.4 G 3.474<658c>-3.474 G .974(nd what looks lik)-3.474 F 3.474
(et)-.1 G .974(he remainder of a)-3.474 F F3(.bash_history)3.473 E F0
.973(\214le which informs us ho)3.473 F 3.473(wt)-.25 G(he)-3.473 E
(27 January 2001)254.95 768 Q EP
%%Page: 8 8
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-8-)282.17 48 Q/F1 10/Courier@0 SF(own)87 84 Q
F0(and)2.5 E F1(adm1)2.5 E F0(accounts were most lik)2.5 E(ely created:)
-.1 E/F2 8/Courier@0 SF(echo own:x:0:0::/root:/bin/bash >> /etc/passwd)
102 102 Q
(echo adm1:x:5000:5000:Tech Admin:/tmp:/bin/bash >> /etc/passwd)102 114
Q(echo own::10865:0:99999:7:-1:-1:134538460 >> /etc/shadow)102 126 Q
(echo adm1:Yi2yCGHo0wOwg:10884:0:99999:7:-1:-1:134538412 >> /etc/shadow)
102 138 Q F0 2.722 -.8(We r)87 159.6 T -.25(ev).8 G 1.122
(isit the root partition').25 F 3.622(sd)-.55 G 1.123(d'ed image with)
-3.622 F/F3 10/Times-Bold@0 SF(strings)3.623 E F0 3.623(,a)C 1.123
(nd reco)-3.623 F -.15(ve)-.15 G 3.623(rw).15 G 1.123(hat looks lik)
-3.623 F 3.623(ef)-.1 G 1.123(ragments from)-3.623 F F1(root)87 171.6 Q
F0 -.55('s)C F3(.bash_history)3.897 E F0 .847(\214le, see)3.347 F F1
(bash_history.root)3.347 E F0 5.847(.W)C 3.347(er)-6.647 G .846
(eproduce the section of this \214le which)-3.347 F(may gi)87 183.6 Q .3
-.15(ve u)-.25 H 2.5(sal).15 G(ook at the intruder')-2.5 E 2.5(se)-.55 G
(arly acti)-2.5 E(vities:)-.25 E F2(uptime)102 201.6 Q
(rm -rf /etc/hosts.deny)102 213.6 Q(touch /etc/hosts.deny)102 225.6 Q
(rm -rf /var/log/wtmp)102 237.6 Q(touch /var/log/wtmp)102 249.6 Q
(killall -9 klogd)102 261.6 Q(killall -9 syslogd)102 273.6 Q
(rm -rf /etc/rc.d/init.d/*log*)102 285.6 Q
(echo own:x:0:0::/root:/bin/bash >> /etc/passwd)102 297.6 Q
(echo adm1:x:5000:5000:Tech Admin:/tmp:/bin/bash >> /etc/passwd)102
309.6 Q(echo own::10865:0:99999:7:-1:-1:134538460 >> /etc/shadow)102
321.6 Q
(echo adm1:Yi2yCGHo0wOwg:10884:0:99999:7:-1:-1:134538412 >> /etc/shadow)
102 333.6 Q(cat /etc/inetd.conf | grep tel)102 345.6 Q(exit)102 357.6 Q
F0 .16(In particular)87 375.6 R 2.66(,t)-.4 G .16
(his con\214rms our earlier claim that)-2.66 F F3(syslogd)2.66 E F0(and)
2.66 E F3(klogd)2.66 E F0 .16(were killed by the intruder at a v)2.66 F
(ery)-.15 E .509(early stage.)87 387.6 R .509(The \214nal)5.509 F F3(gr)
3.009 E(ep)-.18 E F0 .509
(can be read to indicate that the intruder planned to re)3.009 F .508
(visit the system using)-.25 F F3(telnet)87 399.6 Q F0 5.063(.F)C
(inally)-5.063 E 2.563(,w)-.65 G 2.563(en)-2.563 G .063(otice that)
-2.563 F F1(own)2.563 E F0 -.1(wa)2.563 G 2.563(sap).1 G(assw)-2.563 E
(ord-less)-.1 E F1(root)2.563 E F0 .063(account, and that)2.563 F F1
(adm1)2.563 E F0 -.1(wa)2.563 G 2.564(sap).1 G(assw)-2.564 E(ord-)-.1 E
.821(protected user account used to telnet into the system.)87 411.6 R
.82(This is consistent with the)5.821 F F3(login)3.32 E F0(and)3.32 E F3
(pwdb)3.32 E F0(log)3.32 E(\214le snippets we reco)87 423.6 Q -.15(ve)
-.15 G(red from the system').15 E 2.5(ss)-.55 G -.1(wa)-2.5 G(p.).1 E F3
2.5(6. Dumpster)72 447.6 R(di)2.5 E
(ving 3: Reconstructing and analyzing fr)-.1 E(ee inodes.)-.18 E F0
(Finally)87 463.2 Q 3.391(,w)-.65 G 3.391(ea)-3.391 G .892(pply the)
-3.391 F F3(ils)3.392 E F0 .892(\(1\) and)B F3(icat)3.392 E F0 .892
(\(1\) programs from)B/F4 10/Times-Italic@0 SF .892(The Cor)3.392 F
(oner')-.45 E 3.392(sT)-.4 G(oolkit)-4.312 E F0 .892(to e)3.392 F .892
(xtract free, b)-.15 F .892(ut non-)-.2 F .69
(empty inodes from the disk images.)87 475.2 R .69(In what follo)5.69 F
.689(ws, we will use the notation hda)-.25 F F4(N)A F0(/)A F4(inum)A F0
.689(for the \214les)3.189 F(reco)87 487.2 Q -.15(ve)-.15 G(red that w)
.15 E(ay)-.1 E 5(.W)-.65 G 2.5(ee)-5.8 G(xtract the inodes lik)-2.65 E
2.5(et)-.1 G(his:)-2.5 E F2 4.8(#f)102 505.2 S
(or f in hda1 hda5 hda6 hda7 hda8 ; do \\)-4.8 E(mkdir $f ; \\)111.6
517.2 Q(ils -r /attic/forensics/honeypot.${f}.dd | \\)111.6 529.2 Q
(awk -F '|' '\(NF == 13 && $2 == "f" && $11 > 0\) { print $1 }' | \\)
121.2 541.2 Q(while read inode ; do \\)121.2 553.2 Q
(icat /attic/forensics/honeypot.${f}.dd $inode > $f/$inode ; \\)130.8
565.2 Q(done ; \\)116.4 577.2 Q(done)102 589.2 Q F0 1.6 -.8(We \214)87
610.8 T(rst note that no free inodes were reconstructed on).8 E F3(hda1)
2.5 E F0(and)2.5 E F3(hda6)2.5 E F0(.)A F3 2.5(6.1. hda8:)72 634.8 R
(The Root P)2.5 E(artition.)-.1 E F0(Using)87 650.4 Q F3(\214le)3.395 E
F0 .895(\(1\) to inspect the \214les we just g)B .895
(athered, we \214nd se)-.05 F -.15(ve)-.25 G .895
(ral shell scripts, lots of C source code,).15 F 1.579
(and \214nally a GNU tar archi)87 662.4 R 1.879 -.15(ve i)-.25 H 4.079
(ni).15 G 1.579(node no. 8133.)-4.079 F 1.579(Inspecting this archi)
6.579 F -.15(ve)-.25 G 4.079(,w).15 G 4.079(es)-4.079 G 1.579
(ee that it contains a)-4.079 F .03
(directory whose name is a single space character)87 674.4 R 2.53(,a)-.4
G .03(nd that this directory apparently contains an)-2.53 F F3(eggdr)
2.53 E(op)-.18 E F0 .173(IRC bot. Bro)87 686.4 R .173
(wsing some of the \214les, we see references to)-.25 F F1(tPACK)2.672 E
F0 2.672(,a)C .172(nd a script named)-2.672 F F1(install)2.672 E F0
5.172(.W)C(ith)-5.572 E 3.85(this archi)87 698.4 R -.15(ve)-.25 G 6.35
(,w).15 G 6.35(ec)-6.35 G 3.85(an interpret the)-6.35 F F3
(.bash_history)6.35 E F0 3.85(\214le we found in)6.35 F F1(drosen)6.35 E
F0 4.95 -.55('s h)D 3.85(ome directory:).55 F(Apparently)87 710.4 Q 2.5
(,t)-.65 G(he)-2.5 E F1(drosen)2.5 E F0(account w)2.5 E
(as used to compile and "install" an e)-.1 E(ggdrop bot.)-.15 E
(27 January 2001)254.95 768 Q EP
%%Page: 9 9
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-9-)282.17 48 Q -.8(Ta)87 84 S 1.627
(king md5sums of the free inodes and the e).8 F 1.626
(xtracted contents of the)-.15 F/F1 10/Times-Bold@0 SF(eggdr)4.126 E(op)
-.18 E F0 1.626(tar ball, we can use)4.126 F .67(standard shell tools t\
o create a list of the free inodes which did not belong to the e)87 96 R
.671(ggdrop source.)-.15 F -.8(We)5.671 G(\214nd:)87 108 Q F1(60502)87
123.6 Q F0 2.5(Ac)112 135.6 S(ompiled v)-2.5 E(ersion of)-.15 E F1
(encrypt.c)2.5 E F0(from the)2.5 E F1(eggdr)2.5 E(op)-.18 E F0(distrib)
2.5 E(ution.)-.2 E F1(60531)87 151.2 Q F0 2.5(At)112 163.2 S
(ime stamp \214le, most lik)-2.5 E(ely from b)-.1 E(uilding)-.2 E F1
(eggdr)2.5 E(op.)-.18 E F0(The string contained is:)5 E/F2 8/Courier@0
SF(Wed Nov)137 181.2 Q 4.8(80)9.6 G(8:58:56 CST 2000)-4.8 E F0 .253(Mos\
t of the other inodes seem to contain directories or intermediate data \
from b)87 202.8 R .252(uilding e)-.2 F 2.752(ggdrop. Some)-.15 F 2.215
(inodes contain arbitrary data g)87 214.8 R 2.215
(arbage \(22200, 22193, 22194\).)-.05 F 2.215
(The contents of these \214les may be)7.215 F
(encrypted data, which may merit further inspection, b)87 226.8 Q
(ut is not co)-.2 E -.15(ve)-.15 G(red in this report.).15 E F1 2.5
(6.2. hda7:)72 250.8 R(The /v)2.5 E(ar P)-.1 E(artition.)-.1 E F0 1.854
-.8(We h)87 266.4 T -2.25 -.2(av e).8 H .254(only tw)2.954 F 2.754(of)
-.1 G .254(ree, b)-2.754 F .254
(ut nonempty inodes on this partition, 22184 and 4040.)-.2 F .253
(22184 contains 75 null)5.253 F 1.397(bytes. By inspecting)87 278.4 R F1
(ils)3.897 E F0 1.397(\(1\) output, we see that 4040 is o)B 1.398
(wned by user)-.25 F/F3 10/Courier@0 SF(root)3.898 E F0 3.898(,g)C(roup)
-3.898 E F3(slocate)3.898 E F0 6.398(.W)C(e)-7.198 E 1.052
(further note that 4040 contains what looks lik)87 290.4 R 3.552<658c>
-.1 G 1.052(le name information.)-3.552 F 2.652 -.8(We c)6.052 H 1.052
(onclude that this \214le has).8 F 1.423(been left o)87 302.4 R -.15(ve)
-.15 G 3.923(rb).15 G 3.923(ys)-3.923 G 1.424
(ome update process for the)-3.923 F F1(slocate)3.924 E F0 3.924
(package. W)3.924 F(e')-.8 E 1.424(ll in)-.1 F -.15(ve)-.4 G(stig).15 E
1.424(ate this further in the)-.05 F(timeline section.)87 314.4 Q F1 2.5
(6.3. hda5:)72 338.4 R(The /usr P)2.5 E(artition.)-.1 E F0 3.147 -.8
(We \214)87 354 T 1.547(nally turn to the).8 F F1(/usr)4.046 E F0 1.546
(partition which contains ther attack)4.046 F(er')-.1 E 4.046(st)-.55 G
1.546(ool chest, and may re)-4.046 F -.15(ve)-.25 G 1.546(al some).15 F
1.054(interesting details.)87 366 R 1.054(Once ag)6.054 F 1.054
(ain, we \214rst inspect the e)-.05 F 1.054(xtracted inodes with)-.15 F
F1(\214le)3.555 E F0 3.555(\(1\). Inodes)B 1.055(109791 and)3.555 F
(109861 contain GNU tar archi)87 378 Q -.15(ve)-.25 G(s.).15 E(In)87
393.6 Q -.15(ve)-.4 G(stig).15 E 1.598(ating 109861, we \214nd a pre-b)
-.05 F(uilt)-.2 E F1(bind)4.098 E F0(distrib)4.098 E 1.597
(ution, and an installation script named)-.2 F F1(install)4.097 E F0(,)A
1.153(which installs the rele)87 405.6 R -.25(va)-.25 G 1.153
(nt binaries in).25 F F1(/usr/local)3.653 E F0 3.653(,a)C 1.153
(nd \214nally replaces)-3.653 F F1(/usr/sbin/named)3.653 E F0 1.153
(by the ne)3.653 F(wly-)-.25 E(installed v)87 417.6 Q 2.5(ersion. W)-.15
F 2.5(en)-.8 G(ote that this script nicely e)-2.5 E(xplains the)-.15 E
F1(bind)2.5 E F0(-related \214les installed on apollo.)A 1.406
(109791 contains the complete source archi)87 433.2 R 1.705 -.15(ve f)
-.25 H 1.405(or ssh-1.2.27, including object \214les.).15 F 3.005 -.8
(We c)6.405 H 1.405(ompare the).8 F 1.916(contents of this archi)87
445.2 R 2.216 -.15(ve t)-.25 H 4.417(oak).15 G(no)-4.417 E 1.917
(wn-good distrib)-.25 F 1.917(ution tar ball fetched from)-.2 F F3
(ftp.fu-berlin.de)4.417 E F0(using)87 457.2 Q F1(diff)2.759 E F0 2.759
(\(1\). W)B 2.759<658c>-.8 G .259
(nd that the source code found on apollo contains pro)-2.759 F .258
(visions for a back-door using a)-.15 F(uni)87 469.2 Q -.15(ve)-.25 G
2.115(rsal passw).15 F 2.115
(ord \(whose MD5 checksum is stored\), and for a passw)-.1 F 2.115
(ord logger)-.1 F 7.115(.L)-.55 G 2.115(ooking at the)-7.115 F F1
(con\214g)87 481.2 Q(.status)-.15 E F0 1.203
(\214le contained in the tar ball, we suppose that the attack)3.703 F
1.203(er has most lik)-.1 F 1.203(ely made use of)-.1 F .72
(these features.)87 493.2 R .72(The pre-b)5.72 F .72(uilt v)-.2 F .72
(ersion of)-.15 F F1(ssh)3.22 E F0 .72(installed on the system w)3.22 F
.72(as con\214gured with the follo)-.1 F(wing)-.25 E(parameters:)87
505.2 Q F2 4.8
(./configure --enable-global=d33e8f1a6397c6d2efd9a2aae748eb02)102 523.2
R(\\)7.2 E(--enable-sshd-log=/usr/tmp/nap)127 535.2 Q F0 2.338 -.8(To v)
87 553.2 T .738(erify that these parameters were indeed used for the).65
F F1(sshd1)3.237 E F0 .737(installed on)3.237 F F3(apolllo)3.237 E F0
3.237(,w)C 3.237(ei)-3.237 G -1.85 -.4(nv e)-3.237 H(stig).4 E(ate)-.05
E .551(that binary with)87 565.2 R F1(strings)3.051 E F0 3.051
(\(1\). The)B .552(md5 checksum of the global passw)3.051 F .552
(ord and the path to the log \214le are)-.1 F(both found.)87 577.2 Q
(Further)87 592.8 Q 3.26(,w)-.4 G 3.26(en)-3.26 G .76
(ote that the tar ball found on apollo actually contains tw)-3.26 F
3.259(oc)-.1 G .759(opies of the)-3.259 F F1(ssh)3.259 E F0 .759
(source code.)3.259 F 1.9(The only dif)87 604.8 R 1.9
(ference between these tw)-.25 F 4.4(ov)-.1 G 1.901
(ersions of the code is in a comment.)-4.55 F(In)6.901 E F3(ssh.diff)
4.401 E F0 4.401(,w)C(e)-4.401 E(include a dif)87 616.8 Q 2.5(fb)-.25 G
(etween the kno)-2.5 E(wn-good v)-.25 E
(ersion of the source and the "top-le)-.15 E -.15(ve)-.25 G 2.5(lc).15 G
(op)-2.5 E(y" found on apollo.)-.1 E(Finally)87 632.4 Q 2.5(,w)-.65 G
2.5(eh)-2.5 G -2.25 -.2(av e)-2.5 H(another look at)2.7 E F1
(/usr/tmp/nap)2.5 E F0 2.5(,a)C(nd MD5-hash the passw)-2.5 E
(ord which w)-.1 E(as stored there:)-.1 E F2 4.8(#e)102 650.4 S
(cho -n "tw1Lightz0ne" | md5sum)-4.8 E(d33e8f1a6397c6d2efd9a2aae748eb02)
102 662.4 Q F0 1.6 -.8(We c)87 680.4 T(onclude that).8 E F3
(tw1Lightz0ne)2.5 E F0 -.1(wa)2.5 G 2.5(si).1 G(ndeed the passw)-2.5 E
(ord used for the back-doored)-.1 E F1(ssh)2.5 E F0(serv)2.5 E(er)-.15 E
(.)-.55 E 1.6 -.8(We f)87 696 T(urther \214nd tw).8 E 2.5(od)-.1 G
(eleted Red Hat packages:)-2.5 E F2
(109865: RPM v3 bin i386 nfs-utils-0.1.9.1-1)102 714 Q
(109866: RPM v3 bin i386 wu-ftpd-2.6.0-14.6x)102 726 Q F0
(27 January 2001)254.95 768 Q EP
%%Page: 10 10
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-10-)279.67 48 Q .671
(In 109801, we \214nd a shell script which unpacks, b)87 84 R .671
(uilds, and installs the)-.2 F/F1 10/Times-Bold@0 SF(ssh)3.171 E F0
(distrib)3.171 E .671(ution from 109791.)-.2 F .22
(It is, at this point, not lik)87 96 R .22(ely that this script w)-.1 F
.22(as actually used: It creates a cop)-.1 F 2.72(yo)-.1 G(f)-2.72 E F1
(/usr/local/sbin/sshd1)2.72 E F0(in)87 108 Q F1(/usr/sbin/sshd)3.791 E
F0 6.291(.T)C 1.291(his \214le does not e)-6.291 F 1.29
(xist on apollo, and an inspection of inode hda5/92360 \(which)-.15 F
(contains the)87 120 Q F1(/usr/sbin)2.5 E F0(directory\) with)2.5 E F1
(icat)2.5 E F0(does not re)2.5 E -.15(ve)-.25 G(al an).15 E 2.5(yt)-.15
G(races of)-2.5 E F1(sshd)2.5 E F0(.)A .764
(In 109802, we \214nd a slightly modi\214ed v)87 135.6 R .765
(ersion of this script, which is indeed consistent with what we)-.15 F
(see in the rest of the \214le system.)87 147.6 Q .519(109803 contains \
another small shell script which contains instructions for unpacking an\
d installing the)87 163.2 R F1(bind)87 175.2 Q F0(distrib)2.5 E
(ution from inode 109861.)-.2 E 1.418
(109864 contains a shell script which uses)87 190.8 R F1 -.1(rp)3.919 G
(m).1 E F0 1.419(to upgrade the system')3.919 F(s)-.55 E F1(nfs-utils)
3.919 E F0 1.419(installation to)3.919 F F1(nfs-)3.919 E
(utils-0.1.9.1-1.i386.r)87 202.8 Q(pm)-.1 E F0 5(.\()C
(See inode 109865.\) The script echoes the string)-5 E/F2 10/Courier@0
SF(statd patch)2.5 E F0(.)A 2.102
(109867 contains a script which echos the string)87 218.4 R F2 2.101
(patching wuftpd)4.601 F F0 4.601(,a)C 2.101
(nd installs an \(updated?\))-4.601 F F1(wuftpd.r)87 230.4 Q(pm)-.1 E F0
(\(see inode 109866\).)2.5 E -1.11(Ve)87 246 S 1.637
(rifying MD5 hashes, we notice that the reco)1.11 F -.15(ve)-.15 G 1.638
(red packages actually match the security upgrades).15 F .761(announced\
 in RHSA \(Red Hat Security Advisory\) 2000:039-02 and RHSA 2000:043-03\
, respecti)87 258 R -.15(ve)-.25 G(ly).15 E(.)-.65 E 2.596(The ne)87 270
R 2.596(wly installed)-.25 F F1(nfs-utils)5.096 E F0 2.596
(package actually \214x)5.096 F 2.596(es the hole which w)-.15 F 2.596
(as used by the intruder to)-.1 F(originally g)87 282 Q
(ain access to the system.)-.05 E .23(Most of the other \214les can be \
readily identi\214ed as either source \214les from the ssh-1.2.27 distr\
ib)87 297.6 R .23(ution, as)-.2 F .247(\214les created when)87 309.6 R
F1(ssh)2.747 E F0 -.1(wa)2.747 G 2.748(sb).1 G .248
(uilt, or as \214les from the)-2.948 F F1(bind)2.748 E F0 .248
(binary distrib)2.748 F .248(ution found on the system.)-.2 F(One)5.248
E 2.386(detail is particularly w)87 321.6 R 2.386
(orth noting: In 109958 \(and other \214les from the)-.1 F F1(ssh)4.885
E F0(tar)4.885 E 2.385(-ball\), we \214nd the)-.2 F(follo)87 333.6 Q
(wing string:)-.25 E/F3 8/Courier@0 SF
(/dev/.oz/.nap/rkit/terror/.oz/ssh-1.2.27/gmp-2.0.2-ssh-2/mpq/)102 351.6
Q F0 .276(This is an indication on where this v)87 369.6 R .276
(ersion of)-.15 F F1(ssh)2.776 E F0 -.1(wa)2.776 G 2.777(sb).1 G .277
(uilt, and hints at yet another root kit which may)-2.977 F(ha)87 381.6
Q .363 -.15(ve b)-.2 H .063(elonged to the attack).15 F(er')-.1 E 2.563
(st)-.55 G .063(ool chest.)-2.563 F .063
(It should be noted that neither lrk4, nor lrk5 contains a direc-)5.063
F(tory named)87 393.6 Q F2(terror)2.5 E F0(.)A F1 2.5(7. The)72 417.6 R
(attack')2.5 E 2.5(st)-.37 G(ime line.)-2.5 E F0 .643
(This section contains a possible time line for the attack.)87 433.2 R
(It')5.644 E 3.144(sb)-.55 G .644(ased on the information g)-3.144 F
.644(athered so f)-.05 F(ar)-.1 E(,)-.4 E 1.144(and on output from the)
87 445.2 R F1(mactime)3.644 E F0 1.144(\(1\) utility from)B/F4 10
/Times-Italic@0 SF 1.144(The Cor)3.644 F(oner')-.45 E 3.644(sT)-.4 G
(oolkit)-4.564 E F0 6.144(.I)C 3.644(no)-6.144 G 1.144(rder to use)
-3.644 F F1(mactime)3.644 E F0(\(1\),)A F1(gra)87 457.2 Q -.1(ve)-.25 G
(-r).1 E(ob)-.18 E(ber)-.1 E F0 .62(\(1\) w)B .62(as run ag)-.1 F .621
(ainst the mounted \214le system.)-.05 F F1(gra)5.621 E -.1(ve)-.25 G
(-r).1 E(ob)-.18 E(ber)-.1 E F0 -.55('s)C F2(body)3.671 E F0 .621
(\214le and output from)3.121 F .021(manual in)87 469.2 R -.2(vo)-.4 G
.021(cations of).2 F F1(ils)2.521 E F0 .021(and TCT')2.521 F(s)-.55 E F1
(ils2mac)2.521 E F0 .021(utility were then combind into the \214le)2.521
F F2(bigbody)2.52 E F0 2.52(,w)C .02(hich is)-2.52 F 1.108
(attached to this report.)87 481.2 R 1.108(The result w)6.108 F 1.108
(as then processed with)-.1 F F1(mactime)3.608 E F0 1.108
(\(1\), and slightly changed with a)B(simple)87 493.2 Q F1(sed)2.972 E
F0 .471
(script, so information about free inodes could more easily be read.)
2.972 F(The)5.471 E F1(mactime)2.971 E F0 .471(\(1\) output)B
(can be found in its entirety in the \214le)87 505.2 Q F2(timeline.txt)
2.5 E F0(.)A .826(All time stamps in what follo)87 520.8 R .826
(ws are \212 unless e)-.25 F .827
(xplicitly noted otherwise \212 in the system')-.15 F 3.327(so)-.55 G
.827(wn time)-3.577 F(zone, i.e., 57:09 minutes ahead of actual CST)87
532.8 Q(.)-.74 E F1 2.5(7.1. Pr)72 556.8 R
(eliminaries: Explaining hda7/4040)-.18 E F0 1.164
(The part of the timeline we consider be)87 572.4 R 1.163(gins on No)
-.15 F 3.663(v0)-.15 G 3.663(70)-3.663 G 3.663(4:02. At)-3.663 F 1.163
(this point of time, hda7/4040 and)3.663 F .693
(hda7/26218 are accessed, and their contents modi\214ed.)87 584.4 R .693
(The follo)5.693 F .693(wing entries, which are dated No)-.25 F 3.193
(v0)-.15 G(8)-3.193 E 1.064(04:02, re)87 596.4 R -.15(ve)-.25 G 1.064
(al the cause for this beha).15 F 1.064(viour: W)-.2 F 3.564(ea)-.8 G
1.064(re seeing side-ef)-3.564 F 1.064(fects from the system')-.25 F
3.564(sd)-.55 G 1.064(aily routine)-3.564 F 2.5(clean-up. This)87 608.4
R(part of the timeline e)2.5 E(xplains the free inodes we observ)-.15 E
(ed on hda7.)-.15 E F1 2.5(7.2. The)72 632.4 R(attack.)2.5 E
(00:09 \(23:11 CST\))87 648 Q F0 .346
(From the IDS logs and log \214le snippets reco)112 660 R -.15(ve)-.15 G
.346(red from).15 F F1(hda7)2.846 E F0 2.846(,t)C .347
(he initial attack happened on No)-2.846 F(v)-.15 E 1.429
(07 23:11:50 CST)112 672 R 3.929(,o)-.74 G 3.929(rN)-3.929 G 1.729 -.15
(ov 0)-3.929 H 3.929(80).15 G 1.428(0:09:00 system time.)-3.929 F 1.428
(The intruder)6.428 F 3.928(,c)-.4 G 1.428(oming from 216.216.74.2,)
-3.928 F -.15(ex)112 684 S .41(ploited the).15 F F1 -.1(rp)2.91 G
(c.statd).1 E F0 .41(format b)2.91 F .411
(ug described in section 4.2, and installed a "shell serv)-.2 F .411
(er" on port)-.15 F(4545 using a simple modi\214cation to)112 696 Q F1
(/etc/inetd.conf)2.5 E F0(.)A F1(08:25 \(07:28 CST\))87 711.6 Q F0
(Inspecting)112 723.6 Q F2(timeline.txt)2.779 E F0 2.779(,w)C 2.779
<658c>-2.779 G .279(nd the ne)-2.779 F .279(xt interesting acti)-.15 F
.278(vities at No)-.25 F 2.778(v0)-.15 G 2.778(80)-2.778 G .278
(8:25 system time.)-2.778 F(27 January 2001)254.95 768 Q EP
%%Page: 11 11
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-11-)279.67 48 Q/F1 8/Courier@0 SF
(Nov 08 00 08:25:53)137 84 Q(2836 .a. -r-xr-xr-x root)24 E 19.2
(root mnt/usr/bin/uptime)24 F(Nov 08 00 08:26:15)137 96 Q 4.8(0m)38.4 G
(.c -rw-r--r-- root)-4.8 E 19.2(root mnt/etc/hosts.deny)24 F
(Nov 08 00 08:26:51)137 108 Q(1024 .a. drwxr-xr-x root)24 E 19.2
(root mnt/etc/rc.d/init.d)24 F(Nov 08 00 08:29:27)137 120 Q
(63728 .a. -rwxr-xr-x root)19.2 E 19.2(root mnt/usr/bin/ftp)24 F
(Nov 08 00 08:33:42)137 132 Q(1024 .a. drwx------ daemon)24 E 9.6
(daemon mnt/var/spool/at)14.4 F(Nov 08 00 08:45:18)137 144 Q
(31376 .a. -rwxr-xr-x root)19.2 E 19.2(root <hda5/93839>)24 F
(161 .a. -rw-r--r-- root)252.2 156 Q 19.2(root mnt/etc/hosts.allow)24 F
4.8(0.)261.8 168 S(a. -rw-r--r-- root)-4.8 E 19.2
(root mnt/etc/hosts.deny)24 F(Nov 08 00 08:45:19)137 180 Q
(63 .a. -rw-r--r-- root)33.6 E 19.2(root mnt/etc/issue.net)24 F
(Nov 08 00 08:45:24)137 192 Q(1504 .a. -rw-r--r-- root)24 E 19.2
(root mnt/etc/security/console.perms)24 F(Nov 08 00 08:51:37)137 204 Q
(2129920 m.. -rw-r--r-- drosen)9.6 E 9.6(drosen <hda8/8133>)14.4 F
(Nov 08 00 08:51:53)137 216 Q(1153 .a. -rwxr-xr-x 1010)24 E 14.4
(users <hda5/109801>)24 F F0(First,)112 237.6 Q/F2 10/Times-Bold@0 SF
(/usr/bin/uptime)5.842 E F0 3.343(is read \(i.e., e)5.842 F -.15(xe)-.15
G 5.843(cuted\). Contents).15 F 3.343(and inode of)5.843 F F2
(/etc/hosts.deny)5.843 E F0(are)5.843 E .807
(modi\214ed, and something is changed in)112 249.6 R F2(/etc/r)3.307 E
(c.d/init.d)-.18 E F0 5.807(.T)C(he)-5.807 E F2(.bash_history)3.307 E F0
.807(fragments reco)3.307 F -.15(ve)-.15 G(red).15 E .296
(in section 5.2 are consistent with these time stamps.)112 261.6 R 1.896
-.8(We n)5.296 H .296(ote that the time stamps we can link to).8 F .29
(the indi)112 273.6 R .29(vidual e)-.25 F -.15(ve)-.25 G .29
(nts from that).15 F F2(.bash_history)2.79 E F0 .29
(\214le are at distances of 10 and more seconds.)2.79 F(From)5.29 E
1.137(this, we conclude that the attack)112 285.6 R 1.137(er most lik)
-.1 F 1.137(ely typed in the commands manually)-.1 F 3.638(,o)-.65 G
3.638(rc)-3.638 G 1.138(utted and)-3.638 F(pasted them from some)112
297.6 Q 2.5(where. It')-.25 F 2.5(su)-.55 G(nlik)-2.5 E
(ely that we are seeing script acti)-.1 E(vities at this point.)-.25 E
-.15(Fo)112 313.2 S 2.5(rc).15 G(on)-2.5 E -.15(ve)-.4 G
(nience, we reproduce the rele).15 E -.25(va)-.25 G
(nt sections from the reco).25 E -.15(ve)-.15 G(red).15 E F2
(.bash_history)2.5 E F0(:)A F1(uptime)137 331.2 Q
(rm -rf /etc/hosts.deny)137 343.2 Q(touch /etc/hosts.deny)137 355.2 Q
(rm -rf /var/log/wtmp)137 367.2 Q(touch /var/log/wtmp)137 379.2 Q
(killall -9 klogd)137 391.2 Q(killall -9 syslogd)137 403.2 Q
(rm -rf /etc/rc.d/init.d/*log*)137 415.2 Q
(echo own:x:0:0::/root:/bin/bash >> /etc/passwd)137 427.2 Q
(echo adm1:x:5000:5000:Tech Admin:/tmp:/bin/bash >> /etc/passwd)137
439.2 Q(echo own::10865:0:99999:7:-1:-1:134538460 >> /etc/shadow)137
451.2 Q
(echo adm1:Yi2yCGHo0wOwg:10884:0:99999:7:-1:-1:134538412 >> /etc/shadow)
137 463.2 Q(cat /etc/inetd.conf | grep tel)137 475.2 Q(exit)137 487.2 Q
F0 4.465 -.8(We c)112 508.8 T 2.865(an speculate that this w).8 F 2.864
(as the \214rst and only time the attack)-.1 F 2.864
(er used his original and)-.1 F(uncomfortable back-door)112 520.8 Q(.)
-.55 E 2.005 -.8(We a)112 536.4 T .405(lso note that the reco).8 F -.15
(ve)-.15 G(red).15 E F2(.bash_history)2.905 E F0 .405
(ends at this point with an)2.905 F/F3 10/Courier@0 SF(exit)2.906 E F0
.406(command, which)2.906 F
(implies that the intruder left the system at this point.)112 548.4 Q F2
(08:28 \(07:31 CST\))87 564 Q F0 2.179
(According to one of the log \214le snippets found in the system')112
576 R 4.678(ss)-.55 G -.1(wa)-4.678 G 4.678(pp).1 G 2.178
(artition, the intruder)-4.678 F 2.975
(returned at 08:28:41 using telnet from 24.12.200.186 \(c871553-b)112
588 R(.jf)-.4 E 2.975(fsn1.mo.home.com\), and)-.25 F(logging in as user)
112 600 Q F3(adm1)2.5 E F0(.)A F2(08:29 \(07:32 CST\))87 615.6 Q F0
(He then in)112 627.6 Q -.2(vo)-.4 G -.1(ke).2 G(d).1 E F2(/usr/bin/ftp)
2.5 E F0(at 08:29:27 \(see the timeline e)2.5 E(xcerpts reproduced abo)
-.15 E -.15(ve)-.15 G(\).).15 E F2(08:45 \(07:48 CST\))87 643.2 Q F0
(The)112 655.2 Q F2(mactime)3.995 E F0 1.495
(-generated time line then re)B -.15(ve)-.25 G 1.494
(als a read access to hda5/93839 at 08:45:18.).15 F(This)6.494 E .92
(inode contains a cop)112 667.2 R 3.42(yo)-.1 G 3.42(ft)-3.42 G .92
(he telnet daemon, which implies that the intruder')-3.42 F 3.42(sl)-.55
G .92(ast telnet session)-3.42 F 2.225(before installing the ne)112
679.2 R 4.725(wd)-.25 G 2.225(aemon be)-4.725 F -.05(ga)-.15 G 4.725(na)
.05 G 4.725(t0)-4.725 G 4.725(8:45. In)-4.725 F -.15(ve)-.4 G(stig).15 E
2.224(ating time stamps on the)-.05 F F2(telnetd)4.724 E F0 .777
(installed later on, we conclude that the attack)112 691.2 R .778
(er indeed did not telnet into the machine after this)-.1 F 1.074
(point of time. This is further supported by the f)112 703.2 R 1.074
(acts that)-.1 F F2(hosts.allo)3.574 E(w)-.1 E F0(and)3.574 E F2
(hosts.deny)3.574 E F0 1.074(\214les were)3.574 F .358
(last read at this point of time.)112 715.2 R .358
(In order to further con\214rm this, we dump apollo')5.358 F(s)-.55 E F2
(/v)2.859 E(ar/log/lastlog)-.1 E F0 .074(\214le using a small)112 727.2
R F2(lastlog)2.574 E F0(\(8\)-lik)A 2.574(et)-.1 G .074
(ool which dumps all records from lastlog which ha)-2.574 F .374 -.15
(ve a n)-.2 H(on-zero).15 E(27 January 2001)254.95 768 Q EP
%%Page: 12 12
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-12-)279.67 48 Q/F1 10/Times-Bold@0 SF(ll_time)
112 84 Q F0(\214eld \(see \214le)2.5 E/F2 10/Courier@0 SF(lastlog.c)2.5
E F0 2.5(\). W)B 2.5(eo)-.8 G(btain the follo)-2.5 E(wing output:)-.25 E
/F3 8/Courier@0 SF 14.4(0t)156.2 102 S 52.8(ty1 Wed)-14.4 F 4.8(Nov 8)
4.8 F(20:37:37 2000)4.8 E 9.6(5000 1)141.8 114 R(Wed Nov)72 E 4.8(80)9.6
G(8:45:24 2000)-4.8 E(\(from c871553-b.jffsn1.mo.home.com\))212 126 Q F0
.363(This con\214rms se)112 144 R -.15(ve)-.25 G .363(ral f).15 F .364(\
acts: First, the intruder indeed used user id 5000 \(adm1\) to log in o)
-.1 F -.15(ve)-.15 G 2.864(rt).15 G(he)-2.864 E(netw)112 156 Q 3.487
(ork. Second,)-.1 F .987(he came from c871533-b)3.487 F(.jf)-.4 E 3.486
(fsn1.mo.home.com. Third,)-.25 F .986(his last login as adm1)3.486 F -.1
(wa)112 168 S 2.828(si).1 G .328(ndeed at 08:45 system time.)-2.828 F
.329(Also note that the time stamp recorded in)5.329 F F1(/v)2.829 E
(ar/log/lastlog)-.1 E F0(cor)2.829 E(-)-.2 E 1.374
(responds to the atime of the \214le)112 180 R F1
(/etc/security/console.perms)3.873 E F0 3.873(,w)C 1.373
(hich is inspected by)-3.873 F F1(/lib/secu-)3.873 E
(rity/pam_console.so)112 192 Q F0 2.5(,w)C(hich is in turn used by)-2.5
E F1(login)2.5 E F0(.)A F1(08:51 \(07:54 CST\))87 207.6 Q F0 .166
(The ne)112 219.6 R .167
(xt time stamp we \214nd refers to hda8/8133, the e)-.15 F .167
(ggdrop bot')-.15 F 2.667(ss)-.55 G .167(ource we in)-2.667 F -.15(ve)
-.4 G(stig).15 E .167(ated in 6.8.)-.05 F 1.79(This \214le')112 231.6 R
4.29(sc)-.55 G 1.79(ontents w)-4.29 F 1.79
(as last modi\214ed at 08:51:37.)-.1 F 3.39 -.8(We c)6.79 H 1.79
(an read this as a sign for a \214nished).8 F(do)112 243.6 Q(wnload.)
-.25 E 2.005(The ne)112 259.2 R 2.005(xt e)-.15 F -.15(ve)-.25 G 2.005
(nts we observ).15 F 4.505(ea)-.15 G 2.005(re at 08:51:53-08:51:56: V)
-4.505 F 2.006(arious \214les in)-1.11 F F1(/usr/man/.Ci)4.506 E F0
2.006(are \214rst)4.506 F 1.864
(accessed, and then their inode data are changed.)112 271.2 R 1.864
(In order to understand this beha)6.864 F(viour)-.2 E 4.364(,i)-.4 G
4.364(ti)-4.364 G(s)-4.364 E(instructi)112 283.2 Q 2.838 -.15(ve t)-.25
H 5.038(ou).15 G 2.539
(npack, as root, an arbitrary tar ball, and then in)-5.038 F -.15(ve)-.4
G(stig).15 E 2.539(ate time stamps using)-.05 F F1(mactime)112 295.2 Q
F0 3.555(\(1\). The)B 1.055(basic pattern \212 access \214rst, then a c\
hange to the inode data --- is the same.)3.555 F(Additionally)112 307.2
Q 2.762(,t)-.65 G .262(he f)-2.762 F .262(act that these \214les belong\
 to user 1010 which left no other traces on the system)-.1 F .437
(may indicate that we ha)112 319.2 R .737 -.15(ve t)-.2 H .437
(he results of an instance of).15 F F1(tar)2.937 E F0 .437
(running as root here, unpacking some)2.937 F(archi)112 331.2 Q .3 -.15
(ve w)-.25 H(hich contained the entire).15 E F1(.Ci)2.5 E F0(directory)
2.5 E(.)-.65 E F1(08:52 \(07:55 CST\) \212 sub)87 346.8 Q -.1(ve)-.15 G
(rting the system).1 E F0 .665(At 08:52:09 system time, the attack)112
358.8 R .665(er be)-.1 F .665(gins to quickly replace)-.15 F F1
(.bash_history)3.166 E F0 .666(\214les by symbolic)3.166 F 3.705
(links. His)112 370.8 R 1.204(speed at this point mak)3.705 F 1.204
(es it lik)-.1 F 1.204(ely that a script w)-.1 F 1.204
(as used which, apparently)-.1 F 3.704(,d)-.65 G 1.204(id not)-3.704 F
(survi)112 382.8 Q 1.046 -.15(ve t)-.25 H .746(he acti).15 F .746
(vities to follo)-.25 F 4.546 -.65(w. I)-.25 H 3.246(no).65 G .746
(rder to \214nd out more details, we eng)-3.246 F .747
(age in dumpster di)-.05 F(ving)-.25 E(another time, and run)112 394.8 Q
F3 4.8(#u)137 412.8 S(nrm /attic/forensics/honeypot.hda5.dd | strings)
-4.8 E F0(Bro)112 430.8 Q .409
(wsing through the output data and searching for)-.25 F F1
(.bash_history)2.909 E F0 2.908(,w)C 2.908<658c>-2.908 G .408
(nd what looks lik)-2.908 F 2.908(ef)-.1 G(rag-)-2.908 E .146
(ments of a tar archi)112 442.8 R -.15(ve)-.25 G 5.147(.I).15 G 2.647
(nf)-5.147 G .147(act, we can reconstruct the script the attack)-2.747 F
.147(er has most lik)-.1 F .147(ely run.)-.1 F .147(It is)5.147 F .392
(contained in the \214le)112 454.8 R F2(trojan.sh)2.891 E F0 5.391(.\()C
.391(The entire output of the command run is 31 MB of data; we)-5.391 F
(don')112 466.8 Q 2.5(ti)-.18 G(nclude this for space reasons.\))-2.5 E
2.211 -.8(We n)112 482.4 T .611(ote that the script e).8 F .611
(xpects to be run in the)-.15 F F1(.Ci)3.112 E F0 .612
(directory; we can assume that, at some point)3.112 F
(between 08:51:56 and 08:52:09 system time, the attack)112 494.4 Q
(er changed directories to)-.1 E F1(.Ci)2.5 E F0(.)A 1.719
(The script be)112 510 R 1.719(gins by remo)-.15 F 1.718(ving v)-.15 F
(arious)-.25 E F1(.bash_history)4.218 E F0 1.718
(\214les and replacing them with symbolic)4.218 F(links to)112 522 Q F1
(/de)2.5 E(v/null)-.15 E F0(.)A 1.87(The sequence of e)112 537.6 R -.15
(ve)-.25 G 1.87(nts which follo).15 F 1.871
(ws at 08:52:10 system time can entirely be e)-.25 F 1.871(xplained by)
-.15 F .256(looking at this script, too: It creates a directory named)
112 549.6 R F1(backup)2.755 E F0 2.755(,a)C .255(nd tries to cop)-2.755
F 2.755(yt)-.1 G .255(he system')-2.755 F(s)-.55 E F1(ps)2.755 E F0(,)A
F1(top)112 561.6 Q F0(,)A F1(syslogd)2.5 E F0(,)A F1(netstat)2.5 E F0(,)
A F1(ifcon\214g)2.5 E F0 2.5(,a)C(nd)-2.5 E F1(tcpd)2.5 E F0
(binaries to that directory)2.5 E(.)-.65 E 1.423(The path used for)112
577.2 R F1(syslogd)3.923 E F0 1.423(is, ho)3.923 F(we)-.25 E -.15(ve)
-.25 G 2.223 -.4(r, w).15 H 1.424
(rong, so this \214le is neither copied \(and found in the).4 F
(backup directory later on\), nor is it replaced by a trojan horse v)112
589.2 Q(ersion.)-.15 E .531(The script then prints the message)112 604.8
R F2 .531(Trojaning in progress)3.031 F F0 .531(and uses)3.031 F F1
(./\214x)3.03 E F0 .53(to replace these)3.03 F .862
(programs by the trojan v)112 616.8 R .862
(ersions included in the root kit tar ball.)-.15 F F1(./\214x)5.862 E F0
.863(is a standard part of lrk4,)3.362 F .081
(which installs trojan horses, preserving \214le mode, o)112 628.8 R
.081(wnership, and time stamps.)-.25 F(Additionally)5.08 E(,)-.65 E F1
(./\214x)2.58 E F0 .348
(tries to \214x CRC checksums under certain conditions.)112 640.8 R
(Comparing)5.349 E F1(sum)2.849 E F0 .349
(\(1\) checksums of the \214les')B(backup v)112 652.8 Q
(ersions and the installed v)-.15 E(ersions re)-.15 E -.15(ve)-.25 G
(als that this did not happen.).15 E .365
(At this point, the script tries to restart)112 668.4 R F1(syslogd)2.865
E F0 .365(\(and f)2.865 F .365
(ails in this case, since the intruder has killed)-.1 F
(that daemon before\).)112 680.4 Q 1.378(It then calls \(and later remo)
112 696 R -.15(ve)-.15 G 1.378(s\) a script named).15 F F1(addbd)3.878 E
F0 6.378(.W)C 3.878(ec)-7.178 G 1.378
(an reconstruct this \214le from the)-3.878 F .309(dumpster di)112 708 R
.309(ving we performed abo)-.25 F .609 -.15(ve o)-.15 H(n).15 E F1(hda5)
2.809 E F0 5.309(.I)C(t')-5.309 E 2.809(si)-.55 G .308(ncluded as)-2.809
F F2(addbd.sh)2.808 E F0 2.808(,a)C .308(nd creates the \214les)-2.808 F
F1(/usr/man/p)112 720 Q F0(,)A F1(/usr/man/.p)3.937 E F0(,)A F1
(/usr/man/r)3.937 E F0 3.937(,a)C(nd)-3.937 E F1(/usr/man/.a)3.937 E F0
6.437(.W)C 3.937<658c>-7.237 G 1.437(nd this sequence of acti)-3.937 F
1.438(vities in)-.25 F(27 January 2001)254.95 768 Q EP
%%Page: 13 13
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-13-)279.67 48 Q/F1 10/Courier@0 SF
(timeline.txt)112 84 Q F0(at 08:52:12 system time.)2.5 E .284
(Note that only)112 99.6 R/F2 10/Times-Bold@0 SF(/usr/man/r)2.784 E F0
(and)2.784 E F2(/usr/man/.a)2.784 E F0 .283
(are used by the trojan horses actually installed on the)2.783 F 3.17
(system. The)112 111.6 R .67(other con\214guration \214les are unused, \
which further supports the impression that the)3.17 F(attack)112 123.6 Q
(er')-.1 E 2.675(st)-.55 G .175(ool chest came from a v)-2.675 F .174
(ariety of sources, and w)-.25 F .174
(as possibly not fully understood by the)-.1 F(indi)112 135.6 Q
(vidual using it.)-.25 E F2
(08:52:13 \(07:55 CST\) \212 Starting the sniffer)87 151.2 Q F0(Ne)112
163.2 Q 4.22(xt, the program)-.15 F F2(./snif)6.721 E F0 4.221
(is started by)6.721 F F1(trojan.sh)6.721 E F0 9.221(.W)C 6.721<658c>
-10.021 G 4.221(nd corresponding entries in)-6.721 F F1(timeline.txt)112
175.2 Q F0 .35(at 08:52:13.)2.85 F .35(In particular)5.35 F(,)-.4 E F2
(sniff)2.85 E(.pid)-.15 E F0(and)2.85 E F2(tcp.log)2.85 E F0 .35
(were created.)2.85 F .35(Both \214le names)5.35 F 1.125(occur in the)
112 187.2 R F2(snif)3.625 E F0(binary)3.625 E 6.125(.F)-.65 G 1.125
(urther inspecting the binary with)-6.125 F F2(strings)3.625 E F0 1.125
(\(1\), and comparing with an)B(independently-b)112 199.2 Q .398
(uilt instance of the)-.2 F F2(linsniffer)2.898 E F0 .398
(included with lrk4, we can safely state that)2.898 F F2(./snif)2.897 E
F0(is)2.897 E(indeed an instance of)112 211.2 Q F2(linsniffer)2.5 E F0
(.)A .113(Note that)112 226.8 R F2(tcpd.log)2.613 E F0 -.1(wa)2.613 G
2.613(sn).1 G .114(ot modi\214ed after this poit of time.)-2.613 F .114
(This implies that no TCP connections)5.114 F(logged by)112 238.8 Q F2
(linsniffer)2.5 E F0(came in after the snif)2.5 E(fer w)-.25 E
(as started.)-.1 E .68(In order to better understand this f)112 254.4 R
.679(act, we \214rst list the rele)-.1 F -.25(va)-.25 G .679
(nt lines in function).25 F F2(\214lter)3.179 E F0 .679(\(\) from the)B
(published C source code \(see \214le)112 266.4 Q F1(linsniffer.c)2.5 E
F0(\):)A/F3 8/Courier@0 SF 15.4(129 if\(ntohs\(tcp->dest\)==21\))141.8
284.4 R(p=1; /* ftp */)9.6 E 15.4(130 if\(ntohs\(tcp->dest\)==23\))141.8
296.4 R(p=1; /* telnet */)9.6 E 1(131 /*)141.8 308.4 R
(if\(ntohs\(tcp->dest\)==110\) p=1;)14.4 E(pop3 */)9.6 E 1(132 /*)141.8
320.4 R(if\(ntohs\(tcp->dest\)==109\) p=1;)14.4 E(pop2 */)9.6 E 15.4
(133 if\(ntohs\(tcp->dest\)==143\))141.8 332.4 R(p=1; /* imap2 */)4.8 E
15.4(134 if\(ntohs\(tcp->dest\)==513\))141.8 344.4 R(p=1; /* rlogin */)
4.8 E 1(135 /*)141.8 356.4 R(if\(ntohs\(tcp->dest\)==106\) p=1;)14.4 E
(poppasswd */)9.6 E 15.4(136 if\(victim.active)141.8 368.4 R(== 0\))4.8
E 29.8(137 if\(p)141.8 380.4 R(== 1\))4.8 E 44.2(138 if\(tcp->syn)141.8
392.4 R(== 1\))4.8 E 44.2(139 {)141.8 404.4 R F0(Evidently)112 422.4 Q
(,)-.65 E F2(linsniffer)2.727 E F0 .227(is acti)2.727 F -.25(va)-.25 G
.227(ted by TCP connection setup on certain ports. It').25 F 2.727(se)
-.55 G .228(asy to customize)-2.727 F .44(this section of the code. F)
112 434.4 R .439(or this reason, we disassemble the)-.15 F F2(snif)2.939
E F0 .439(binary found on apollo \(see \214le)2.939 F F1(snif.s)112
446.4 Q F0 .238(\), and try to e)B .239(xtract the list of ports w)-.15
F 2.739(atched. In)-.1 F(the)2.739 E F2(\214lter)2.739 E F0 .239
(\(\) function, we \214nd the follo)B(w-)-.25 E(ing assembly code:)112
458.4 Q F3 28.8(804892a: 86)141.8 476.4 R 86.4(c4 xchg)4.8 F(%al,%ah)
14.4 E 28.8(804892c: 0f)141.8 488.4 R(b7 d0)4.8 E(movzwl %ax,%edx)76.8 E
28.8(804892f: 89)141.8 500.4 R 86.4(d0 mov)4.8 F(%edx,%eax)19.2 E 28.8
(8048931: 66)141.8 512.4 R(83 f8 15)4.8 E 14.4(cmp $0x15,%ax)62.4 F 28.8
(8048935: 75)141.8 524.4 R 86.4(05 jne)4.8 F(804893c)19.2 E
(<filter+0x74>)287 536.4 Q 28.8(8048937: bb)141.8 548.4 R(01 00 00 00)
4.8 E 14.4(mov $0x1,%ebx)48 F 28.8(804893c: 89)141.8 560.4 R 86.4
(d0 mov)4.8 F(%edx,%eax)19.2 E 28.8(804893e: 66)141.8 572.4 R(83 f8 17)
4.8 E 14.4(cmp $0x17,%ax)62.4 F 28.8(8048942: 75)141.8 584.4 R 86.4
(05 jne)4.8 F(8048949)19.2 E(<filter+0x81>)287 596.4 Q 28.8(8048944: bb)
141.8 608.4 R(01 00 00 00)4.8 E 14.4(mov $0x1,%ebx)48 F 28.8
(8048949: 89)141.8 620.4 R 86.4(d0 mov)4.8 F(%edx,%eax)19.2 E 28.8
(804894b: 66)141.8 632.4 R(3d 8f 00)4.8 E 14.4(cmp $0x8f,%ax)62.4 F 28.8
(804894f: 75)141.8 644.4 R 86.4(05 jne)4.8 F(8048956)19.2 E
(<filter+0x8e>)287 656.4 Q 28.8(8048951: bb)141.8 668.4 R(01 00 00 00)
4.8 E 14.4(mov $0x1,%ebx)48 F 28.8(8048956: 89)141.8 680.4 R 86.4
(d0 mov)4.8 F(%edx,%eax)19.2 E 28.8(8048958: 66)141.8 692.4 R(3d 01 02)
4.8 E 14.4(cmp $0x201,%ax)62.4 F 28.8(804895c: 75)141.8 704.4 R 86.4
(05 jne)4.8 F(8048963)19.2 E(<filter+0x9b>)287 716.4 Q 28.8(804895e: bb)
141.8 728.4 R(01 00 00 00)4.8 E 14.4(mov $0x1,%ebx)48 F F0
(27 January 2001)254.95 768 Q EP
%%Page: 14 14
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-14-)279.67 48 Q/F1 8/Courier@0 SF 28.8
(8048963: 80)141.8 84 R(3d 08 a4 04 08 00)4.8 E 9.6(cmpb $0x0,0x804a408)
19.2 F 28.8(804896a: 75)141.8 96 R 86.4(59 jne)4.8 F(80489c5)19.2 E
(<filter+0xfd>)287 108 Q 28.8(804896c: 83)141.8 120 R(fb 01)4.8 E 14.4
(cmp $0x1,%ebx)76.8 F F0(Note that)112 138 Q F1(xchg %al, %ah)137 156 Q
F0 .15(is the equi)112 174 R -.25(va)-.25 G .15(lent of a).25 F/F2 10
/Times-Bold@0 SF(ntohs)2.65 E F0 .149
(\(3\) function call, applied to %ax.)B(The)5.149 E F2(cmp)2.649 E F0(,)
A F2(jne)2.649 E F0(,)A F2(mo)2.649 E(v)-.1 E F0 .149(sequence which)
2.649 F .258(is then found se)112 186 R -.15(ve)-.25 G .258
(ral times nicely \214ts the C code quoted.).15 F(The)5.258 E F2(cmp)
2.758 E F0 .259(instruction at 804896c can be)2.758 F
(identi\214ed with the statement)112 198 Q F1(if \(p == 1\))137 216 Q F0
.408(in line 137 of the C source code.)112 234 R .407
(Thus, we can \214nd the list of ports monitored by e)5.407 F .407
(xamining the)-.15 F F2(cmp)112 246 Q F0 2.549
(statements at 8048931, 804893e, 804894b, and 8048958.)5.049 F 4.149 -.8
(We c)7.549 H 2.55(on\214rm that the snif).8 F(fer)-.25 E .838
(installed on apollo matches the publicly kno)112 258 R .838
(wn source code in this aspect: The ports monitored)-.25 F(are 0x15 \(2\
1, ftp\), 0x17 \(23, telnet\), 0x8f \(143, imap\), and 0x201 \(513, rlo\
gin\).)112 270 Q .55
(This analysis in particular con\214rms the conclusions dra)112 285.6 R
.551(wn from the 08:45 time stamps:)-.15 F .551(No ne)5.551 F(w)-.25 E
F2(telnet)112 297.6 Q F0 1.099
(connections to apollo were opened after 08:52:13.)3.6 F 1.099
(Since the replacement telnet daemon)6.099 F -.1(wa)112 309.6 S(sn').1 E
3.738(ti)-.18 G 1.238(nstalled before 08:52:33 \(see belo)-3.738 F 1.239
(w\), we can conclude that the connection observ)-.25 F 1.239(ed at)-.15
F(08:45 w)112 321.6 Q(as indeed the last)-.1 E F2(telnet)2.5 E F0
(to apollo before the disk images were made.)2.5 E .697
(The starting of the snif)112 337.2 R .697(fer gi)-.25 F -.15(ve)-.25 G
3.197(su).15 G 3.197(sa)-3.197 G 3.197(ni)-3.197 G .696
(mportant hint to reconstruct the time stamp on the)-3.197 F F2(pwdb)
3.196 E F0 .419
(log message we could partially reproduce from the system')112 349.2 R
2.919(ss)-.55 G -.1(wa)-2.919 G .419(p: From).1 F F2(sniff)2.92 E(.pid)
-.15 E F0 2.92(,w)C 2.92(ek)-2.92 G(no)-2.92 E 2.92(wt)-.25 G(hat)-2.92
E .429(the snif)112 361.2 R .428(fer got the process id 2485 at 08:52:1\
3, which permits us to conclude that the log snippet)-.25 F
(describes an e)112 373.2 Q -.15(ve)-.25 G
(nt which happened not too long before this point of time.).15 E F2
(08:52:14 \(07:55 CST\) \212 Cleaning the log \214les)87 388.8 Q F0
1.485(Back to)112 400.8 R/F3 10/Courier@0 SF(trojan.sh)3.985 E F0(,)A F2
(./clean)3.985 E F0 1.486(is e)3.985 F -.15(xe)-.15 G 1.486
(cuted at 08:52:14 system time.).15 F 1.486(This script, which is still)
6.486 F .396(present on apollo, creates v)112 412.8 R .396(arious tempo\
rary \214les which are then used as input for another script,)-.25 F F2
(./snap)112 424.8 Q F0 5(.T)C(his script is used to remo)-5 E .3 -.15
(ve c)-.15 H(ertain lines from v).15 E(arious log \214les.)-.25 E .768
(On apollo, an)112 440.4 R 3.268(yl)-.15 G .768
(ines matching the strings)-3.268 F F3 .769(echoing ip's and shit)3.268
F F0(,)A F3(sshd)3.269 E F0(,)A F3(log)3.269 E F0(,)A F3(games)3.269 E
F0(,)A F3(209.86)112 452.4 Q F0(,)A F3(own)2.506 E F0(,)A F3(owned)2.506
E F0(,)A F3(Pro)2.506 E F0(,)A F3(snif)2.506 E F0(,)A F3(ident)2.506 E
F0(,)A F3(splitrock)2.506 E F0(,)A F3(209.255)2.506 E F0(,)A F3(echo)
2.506 E F0 2.506(,a)C(nd)-2.506 E F3(snap'ping)2.506 E F0 5.384
(were supposed to be remo)112 464.4 R -.15(ve)-.15 G 7.884(df).15 G
5.384(rom the \214les)-7.884 F F2(/v)7.884 E(ar/log/messages)-.1 E F0(,)
A F2(/v)7.884 E(ar/log/secur)-.1 E(e)-.18 E F0 7.884(,a)C(nd)-7.884 E F2
(/v)112 476.4 Q(ar/log/xferlog)-.1 E F0 .987(at this point.)3.487 F(It')
5.987 E 3.487(sw)-.55 G .987(orth noting that this w)-3.587 F .986
(as not the last manipulation of these)-.1 F
(\214les, since we do not see an)112 488.4 Q 2.5(y")-.15 G
(m" entries in)-2.5 E F3(timeline.txt)2.5 E F0(at this point of time.)
2.5 E F2(08:52:15 \(07:55 CST\) \212 Mor)87 504 Q 2.5(er)-.18 G
(oot kit con\214guration; hardening the system.)-2.68 E F0 2.786(The ne)
112 516 R 2.786(xt timeline entries nicely \214t with)-.15 F F3
(trojan.sh)5.287 E F0 5.287(:A)C 5.287(t0)-5.287 G 2.787
(8:52:15, inode information for)-5.287 F F2(/de)112 528 Q(v/ptyp)-.15 E
F0 1.265(is modi\214ed, and)3.765 F F2(a.sh)3.765 E F0 1.265
(is read. This script kills and remo)3.765 F -.15(ve)-.15 G 3.765(sv).15
G 1.265(arious system services,)-4.015 F 1.894(most of which ha)112 540
R 2.194 -.15(ve a r)-.2 H 1.894(ecent history of security holes.).15 F
1.895(In particular)6.894 F 4.395(,t)-.4 G 1.895(his includes)-4.395 F
F2 -.1(rp)4.395 G(c.statd).1 E F0(,)A(which w)112 552 Q
(as used for the original attack.)-.1 E 1.625(The ne)112 567.6 R 1.625
(xt \212 long \212 line in)-.15 F F3(trojan.sh)4.124 E F0 1.624
(uncompresses and unpacks a \214le named)4.124 F F2 -.1(rp)4.124 G
(ms.tgz).1 E F0(,)A(which apparently contained v)112 579.6 Q
(arious Red Hat packages.)-.25 E
(These packages are then installed using:)7.5 E F1
(rpm -Uvh --force *.rpm)137 597.6 Q F0(The \214les)112 615.6 Q F2 -.1
(rp)2.5 G(ms.tgz).1 E F0(,)A F2 -.1(rp)2.5 G(ms.tar).1 E F0 2.5(,a)C
(nd the)-2.5 E F2 -.1(rp)2.5 G(ms).1 E F0(directory are then remo)2.5 E
-.15(ve)-.15 G(d.).15 E 1.6 -.8(We d)112 631.2 T 2.5(on).8 G(ot ha)-2.5
E .3 -.15(ve a)-.2 H(ccess to).15 E F2 -.1(rp)2.5 G(ms.tgz).1 E F0(or)
2.5 E F2 -.1(rp)2.5 G(ms.tar).1 E F0 5(.H)C -.25(ow)-5 G -2.15 -.25
(ev e).25 H .8 -.4(r, r).25 H(unning).4 E F1 4.8(#r)137 649.2 S
(pm --root=`pwd`/mnt -q -i -a)-4.8 E F0(re)112 667.2 Q -.15(ve)-.25 G
.143(als a list of package installation dates.).15 F 1.743 -.8(We s)
5.143 H .144(ummarize the recent entries from this list, sorting).8 F
(by time stamps:)112 679.2 Q 12.5(am-utils W)137 697.2 R(ed No)-.8 E 5
(v8)-.15 G(08:52:26 2000)-2.5 E 34.17(lpr W)137 709.2 R(ed No)-.8 E 5
(v8)-.15 G(08:52:32 2000)-2.5 E(27 January 2001)254.95 768 Q EP
%%Page: 15 15
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-15-)279.67 48 Q(mak)137 84 Q 26.22(eW)-.1 G
(ed No)-27.02 E 5(v8)-.15 G(08:52:32 2000)-2.5 E 18.62(ypserv W)137 96 R
(ed No)-.8 E 5(v8)-.15 G(08:52:33 2000)-2.5 E 19.74(screen W)137 108 R
(ed No)-.8 E 5(v8)-.15 G(08:52:33 2000)-2.5 E 23.06(telnet W)137 120 R
(ed No)-.8 E 5(v8)-.15 G(08:52:33 2000)-2.5 E 13.62(wu-ftpd W)137 132 R
(ed No)-.8 E 5(v8)-.15 G(08:53:41 2000)-2.5 E 12.5(nfs-utils W)137 144 R
(ed No)-.8 E 5(v8)-.15 G(08:53:49 2000)-2.5 E .808
(This list is consistent with)112 162 R/F1 10/Courier@0 SF(timeline.txt)
3.308 E F0 3.308(,a)C .807(nd re)-3.308 F -.15(ve)-.25 G .807(als that)
.15 F/F2 10/Times-Bold@0 SF -.1(rp)3.307 G(ms.tgz).1 E F0 .807
(contained the)3.307 F F2(am-utils)3.307 E F0(,)A F2(lpr)112 174 Q F0(,)
A F2(mak)3.662 E(e)-.1 E F0(,)A F2(ypser)3.662 E(v)-.1 E F0(,)A F2(scr)
3.662 E(een)-.18 E F0 3.662(,a)C(nd)-3.662 E F2(telnet)3.662 E F0 3.662
(packages. W)3.662 F 3.662(ec)-.8 G 1.162(ome back later to the)-3.662 F
F2(wu-ftpd)3.662 E F0(and)3.662 E F2(nfs-)3.662 E(utils)112 186 Q F0
(packages, for which we ha)2.5 E .3 -.15(ve f)-.2 H
(ound speci\214c installation scripts in section 6.3.).15 E 1.812
(Comparing package v)112 201.6 R 1.812(ersions on apollo with the v)-.15
F 1.811(ersions supplied with a def)-.15 F 1.811(ault RedHat 6.2)-.1 F
.607(installation, we see that only the)112 213.6 R F2(wu-ftpd)3.107 E
F0(and)3.107 E F2(nfs-utils)3.107 E F0 .607
(packages installed were actual upgrades.)3.107 F 1.878
(All other packages were do)112 225.6 R 1.878(wngrades from the def)-.25
F 1.878(ault installs of RedHat 6.2.)-.1 F 1.877(Still, with the)6.878 F
-.15(ex)112 237.6 S 2.323(ception of the).15 F F2(mak)4.823 E(e)-.1 E F0
2.323(package, the ne)4.823 F 2.324
(wly-installed packages had been released as security)-.25 F 2.025
(upgrades in the past, so this step w)112 249.6 R 2.024(ould ha)-.1 F
2.324 -.15(ve c)-.2 H 2.024(ounted as "securing the system" on an older)
.15 F(RedHat installation.)112 261.6 Q(Additionally)112 277.2 Q 3.403
(,t)-.65 G .903(he v)-3.403 F .904(ersion of the)-.15 F F2(telnet)3.404
E F0 .904(package installed by the intruder actually contains)3.404 F F2
(telnet)3.404 E F0 .32(clients and serv)112 289.2 R .32
(ers, and con\215icts with the)-.15 F F2(telnet-ser)2.82 E -.1(ve)-.1 G
(r).1 E F0 .32(package installed by def)2.82 F .32(ault on a RedHat)-.1
F 2.519(6.2 system.)112 301.2 R 2.519(This resolv)7.519 F 2.519
(es the md5 checksum mismatch for)-.15 F(the)7.519 E F2
(/usr/sbin/in.telnetd)5.019 E F0(binary)5.02 E(observ)112 313.2 Q 1.204
(ed earlier:)-.15 F 1.204
(The binary installed on the system is consistent with the)6.204 F F2
(telnet)3.703 E F0 1.203(package, b)3.703 F(ut)-.2 E
(inconsistent with the)112 325.2 Q F2(telnet-ser)2.5 E -.1(ve)-.1 G(r).1
E F0(package.)2.5 E 2.234 -.8(We s)112 340.8 T .634
(ummarize the security updates attempted by the intruder).8 F 5.634(.I)
-.55 G 3.134(nt)-5.634 G .634(he RHSA column, we list the)-3.134 F .655
(Red Hat security advisory in which the package v)112 352.8 R .654
(ersion used by the intruder w)-.15 F .654(as announced; in)-.1 F
(the release date column, you \214nd that advisory')112 364.8 Q 2.5(sd)
-.55 G(ate.)-2.5 E -.15(Pa)137 382.8 S 12.5(ckage RH').15 F 2.5(sv)-.55
G 12.5(ersion Intruder')-2.65 F 2.5(sv)-.55 G 12.5(ersion RHSA)-2.65 F
(release date)39.44 E .4 LW 451.22 387.3 137 387.3 DL 20.13
(screen 3.9.5-4)137 396.8 R 54.84(3.9.4-3 1999:042-01)39.02 F
(1999-10-20)15 E 12.89(am-utils 6.0.3-1)137 408.8 R 25.95
(6.0.1s11-1.6.0 1999:032)39.02 F(1999-08-30)28.33 E 34.56(lpr 0.50-4)137
420.8 R 57.34(0.48-1 2000:002-1)41.52 F(2000-01-08)20 E 19.01
(ypserv 1.3.9-3)137 432.8 R 54.84(1.3.9-1 1999:046-01)39.02 F
(1999-10-27)15 E 23.45(telnet 0.16-6)137 444.8 R 52.34
(0.10-29 1999:029-01)41.52 F(1999-08-19)15 E .966(Fetching the rele)112
466.4 R -.25(va)-.25 G .966(nt packages from RedHat').25 F 3.466(ss)-.55
G(erv)-3.466 E(er)-.15 E 3.466(,w)-.4 G 3.466(ec)-3.466 G .966(an use)
-3.466 F F2 -.1(rp)3.466 G(m).1 E F0 .966(to \214nally v)3.466 F .966
(erify that the)-.15 F(intruder did not install trojan horse v)112 478.4
Q(ersions of these packages:)-.15 E/F3 8/Courier@0 SF 4.8(#l)137 496.4 S
4.8(s*)-4.8 G(.rpm)-4.8 E 4.8
(am-utils-6.0.1s11-1.6.0.i386.rpm telnet-0.10-29.i386.rpm)137 508.4 R
67.2(lpr-0.48-1.i386.rpm ypserv-1.3.9-1.i386.rpm)137 520.4 R
(screen-3.9.4-3.i386.rpm)137 532.4 Q 4.8(#f)137 544.4 S
(or f in *.rpm ; do rpm --root=`pwd`/mnt --verify -p $f ; done)-4.8 E
(..?..... c /etc/amd.conf)137 556.4 Q(..?..... c /etc/amd.net)137 568.4
Q 9.6(......G. /var/spool/lpd)137 580.4 R(#)137 592.4 Q F0 2.509 -.8
(We r)112 614 T .909(eturn to).8 F F2(tr)3.409 E(ojan.sh)-.18 E F0 5.909
(.T)C .909(he script ne)-5.909 F .909(xt restarts)-.15 F F2(inetd)3.409
E F0(and)3.408 E F2(lpd)3.408 E F0 3.408(,a)C .908(nd cleans)-3.408 F F2
(/v)3.408 E(ar/log/wtmp)-.1 E F0 5.908(.T)C(he)-5.908 E .278
(only trace we see of these acti)112 626 R .278
(vities is the atime \(08:52:33\) on)-.25 F F2(/v)2.778 E(ar/log/wtmp)
-.1 E F0 2.778(,w)C .278(hich w)-2.778 F .278(as written)-.1 F
(to at later times.)112 638 Q 1.072
(At 08:52:34, we see write and inode access to)112 653.6 R F2(/bin/bx)
3.572 E F0 6.072(.T)C 1.072(his implies that the cop)-6.072 F 1.071
(ying of)-.1 F F2(bx)3.571 E F0(to)3.571 E F2(/bin)112 665.6 Q F0 2.969
(,a)C .469(nd the chmod we \214nd in)-2.969 F F1(trojan.sh)2.969 E F0
2.969(,w)C .47(ere running or \214nished at this point of time.)-2.969 F
-.8(We)5.47 G .857(note, ho)112 677.6 R(we)-.25 E -.15(ve)-.25 G 1.657
-.4(r, t).15 H .857(hat there is no corresponding read access for).4 F
F2(/usr/man/.Ci/bx)3.356 E F0 3.356(,a)C .856(nd that this \214le)-3.356
F -.1(wa)112 689.6 S 2.5(sr).1 G(ead at a later point of time.)-2.5 E
.087(The ne)112 705.2 R .087(xt lines in)-.15 F F1(trojan.sh)2.587 E F0
.087(are supposed to replace)2.587 F F2(/usr/sbin/in.ftpd)2.587 E F0
5.087(.W)C .087(hile we do \214nd some)-5.087 F 1.136(traces of an)112
717.2 R F2(in.ftpd)3.636 E F0 1.136(when inspecting)3.636 F F2
(/usr/man/.Ci)3.635 E F0(with)3.635 E F2(icat)3.635 E F0 1.135
(\(1\), it is not clear whether this \214le)B -.1(wa)112 729.2 S 3.114
(sa).1 G .614(ctually installed at this point of time.)-3.114 F .614
(In an)5.614 F 3.114(ye)-.15 G -.15(ve)-3.364 G .615(nt, it w).15 F .615
(ould ha)-.1 F .915 -.15(ve b)-.2 H .615(een o).15 F -.15(ve)-.15 G .615
(rwritten shortly).15 F(27 January 2001)254.95 768 Q EP
%%Page: 16 16
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-16-)279.67 48 Q(thereafter)112 84 Q(.)-.55 E
(At this point,)112 99.6 Q/F1 10/Courier@0 SF(trojan.sh)2.5 E F0
(just spits out some more messages, and then terminates.)2.5 E 3.359(\(\
Note that these messages permit us to assign names to the scripts in hd\
a5/109801 and)112 115.2 R(hda5/109802: 109801 w)112 127.2 Q(as)-.1 E/F2
10/Times-Bold@0 SF(install-sshd1)2.5 E F0 2.5(,a)C(nd 109802 w)-2.5 E
(as)-.1 E F2(install-sshd)2.5 E F0(.\))A F2
(08:52-08:53 \(07:55-07:56 CST\))87 142.8 Q F0 .114(The ne)112 154.8 R
.114(xt e)-.15 F -.15(ve)-.25 G .114(nts we observ).15 F 2.614(ec)-.15 G
.115(an be found in)-2.614 F F1(timeline.txt)2.615 E F0 2.615(,a)C .115
(nd start at 08:52:53.)-2.615 F 1.715 -.8(We o)5.115 H(bserv).8 E(e)-.15
E(acti)112 166.8 Q .299(vities which we suspect to be related to the un\
packing of another tar ball in the)-.25 F F2(/usr)2.798 E F0(partition.)
2.798 E .884(These acti)112 178.8 R .884
(vities end for a short moment at 08:52:59, when hda5/109791 w)-.25 F
.885(as last accessed.)-.1 F -.8(We)5.885 G(ha)112 190.8 Q -.15(ve)-.2 G
4.672(,i).15 G 4.672(ns)-4.672 G 2.172
(ection 6.3, identi\214ed this \214le as the tar archi)-4.672 F 2.472
-.15(ve c)-.25 H 2.172(ontaining the source code of the).15 F 1.329
(trojaned v)112 202.8 R 1.329(ersion of)-.15 F F2(ssh)3.829 E F0 1.329
(which w)3.829 F 1.329(as installed on apollo.)-.1 F 2.929 -.8(We s)
6.329 H 1.33(uppose that this is the tar archi).8 F -.15(ve)-.25 G
(unpack)112 214.8 Q .011(ed at this point of time.)-.1 F .011
(In order to further con\214rm our assumption, we look at some of the)
5.011 F .728(\214les which were e)112 226.8 R .728(xtracted and reco)
-.15 F -.15(ve)-.15 G .729(red later on.).15 F 2.329 -.8(We c)5.729 H
.729(on\214rm that these \214les belong to the).8 F F2(ssh)3.229 E F0
(distrib)112 238.8 Q(ution.)-.2 E 4.389 -.8(We s)112 254.4 T 2.789
(uspect that).8 F F2(install-sshd)5.289 E F0 2.789(\(hda5/109802\) w)
5.289 F 2.788(as running at this point of time, and indeed)-.1 F
(hda5/109802 w)112 266.4 Q
(as last read at 08:53:13, which is consistent with this assumption.)-.1
E(After untarring the source, that script w)112 282 Q
(ould issue the command)-.1 E/F3 8/Courier@0 SF(make install)137 300 Q
F0 1.206(in the source directory)112 318 R 6.206(.L)-.65 G 1.206
(ooking at)-6.206 F F1(timeline.txt)3.706 E F0 3.706(,w)C 3.706(en)
-3.706 G 1.206(otice that this is indeed consistent:)-3.706 F 1.809 -.8
(We a)112 330 T(pply).8 E F2(\214le)2.709 E F0 .209(\(1\) to a random s\
ample of the \214les read at 08:53:03-08:53:05, and notice that appar)B
(-)-.2 E .449
(ently most \214les read during these seconds were object \214les.)112
342 R(Additionally)5.449 E 2.95(,a)-.65 G .45(ll \214les written during)
-2.95 F .605(this interv)112 354 R .605(al of time were e)-.25 F -.15
(xe)-.15 G .604(cutable, which further supports the h).15 F .604
(ypothesis that what we')-.05 F .604(re see-)-.5 F
(ing here is actually the process of linking together the trojan ssh v)
112 366 Q(ersion.)-.15 E 1.688(The access patterns we observ)112 381.6 R
4.188(eb)-.15 G 1.689
(etween 08:53:06 and 08:53:13 are consistent with an actual)-4.188 F
(installation of the trojaned)112 393.6 Q F2(ssh)2.5 E F0 2.5(,w)C
(hich is what we e)-2.5 E(xpect to happen at this point of time.)-.15 E
3.213(At 08:53:13, we observ)112 409.2 R 5.713(ew)-.15 G 3.213
(rite access to)-5.713 F F2(/etc/sshd_con\214g)5.713 E F0(and)5.713 E F2
(/etc/r)5.712 E(c.d/r)-.18 E(c.local)-.18 E F0 3.212(\(which is)5.712 F
.225(consistent with an e)112 421.2 R -.15(xe)-.15 G .225(cution of).15
F F2(install-sshd)2.726 E F0 .226(\), and read access for)B F2
(/usr/bin/awk)2.726 E F0 .226(\(which is used by)2.726 F F2
(install-sshd)112 433.2 Q F0(in order to parse)2.5 E F2(ps)2.5 E F0
(\(1\) output\).)A .785(At 08:53:28, we observ)112 448.8 R 3.285(ew)-.15
G .785(hat looks lik)-3.285 F 3.285(ea)-.1 G 3.285(ni)-3.285 G -1.9 -.4
(nv o)-3.285 H .785(cation of the).4 F F2(wher)3.284 E(eis)-.18 E F0
.784(command, most lik)3.284 F .784(ely in)-.1 F 1.292
(an attempt to \214nd the just-installed instance of ssh.)112 460.8 R
1.292(Then, at 08:53:33, netstat is in)6.292 F -.2(vo)-.4 G -.1(ke).2 G
1.292(d, and).1 F F2(/usr/local/sbin/sshd)112 472.8 Q F0(started:)2.5 E
F3(Nov 08 00 08:53:33)137 490.8 Q(32816 .a. -rwxr-xr-x root)19.2 E 19.2
(root mnt/bin/netstat)24 F(202709 .a. -rw-r--r-- root)237.8 502.8 Q 19.2
(root mnt/boot/System.map-2.2.14-5.0)24 F(537 .a. -rw------- root)252.2
514.8 Q 19.2(root mnt/etc/ssh_host_key)24 F(512 .a. -rw------- root)
252.2 526.8 Q 19.2(root mnt/etc/ssh_random_seed)24 F
(684 .a. -rw-r--r-- root)252.2 538.8 Q 19.2(root mnt/etc/sshd_config)24
F(47008 .a. -rwxr-xr-x root)242.6 550.8 Q 19.2
(root mnt/lib/libutil-2.1.3.so)24 F(16 .a. lrwxrwxrwx root)257 562.8 Q
19.2(root mnt/lib/libutil.so.1)24 F(-> libutil-2.1.3.so)4.8 E 4.8(5.)
261.8 574.8 S(a. lrwxrwxrwx root)-4.8 E 19.2
(root mnt/usr/local/sbin/sshd)24 F(-> sshd1)4.8 E
(643674 .a. -rwxr-xr-x root)237.8 586.8 Q 19.2
(root mnt/usr/local/sbin/sshd1)24 F 4.8(5m)261.8 598.8 S
(ac -rw-r--r-- root)-4.8 E 19.2(root mnt/var/run/sshd.pid)24 F F0 .33
(The ne)112 620.4 R .33(xt block of acti)-.15 F .329
(vities lasts from 08:53:40 until 08:53:43, and co)-.25 F -.15(ve)-.15 G
.329(rs the installation of).15 F F2(wu-)2.829 E(ftpd.r)112 632.4 Q(pm)
-.1 E F0 5.44(.N)C .44
(ote that this is consistent with the rpm time table generated abo)-5.44
F -.15(ve)-.15 G 2.94(,w).15 G .44(hich dated this)-2.94 F .483
(installation at 08:53:41.)112 644.4 R .483(Indeed, at 08:53:41, we \
\214nd the last read access to hda5/109866, which)5.483 F(contains)112
656.4 Q F2(wu-ftpd-2.6.0-14.6x.r)2.932 E(pm)-.1 E F0 5.432(.\()C(Named)
-5.432 E F2(wu-ftpd.r)2.932 E(pm)-.1 E F0 .432(by the attack)2.932 F(er)
-.1 E 2.932(.\) The)-.55 F .432(last read access)2.932 F 1.415
(to hda5/109867, the script responsible for installing the ne)112 668.4
R(w)-.25 E F2(wu-ftpd)3.914 E F0 1.414(package, is at 08:53:43,)3.914 F
(which is consistent with our h)112 680.4 Q(ypthesis.)-.05 E F2
(08:53-08:54 \(07:56-07:57 CST\))87 696 Q F0(Ne)112 708 Q .304
(xt, we observ)-.15 F 2.804(et)-.15 G .304
(he installation of the updated)-2.804 F F2(nfs-utils)2.804 E F0 2.804
(package. The)2.804 F(rele)2.805 E -.25(va)-.25 G .305
(nt entries last from).25 F .378(08:53:47, when)112 720 R F2 -.1(rp)
2.878 G(m).1 E F0 -.1(wa)2.878 G 2.878(sl).1 G .378
(ast read on apollo, until 08:54:05, when hda5/109864 w)-2.878 F .378
(as last read \212)-.1 F(27 January 2001)254.95 768 Q EP
%%Page: 17 17
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-17-)279.67 48 Q .042
(the script responsible for the installation of this package.)112 84 R
.042(Note that, at 08:54:05, we also see read)7.542 F .159(access to)112
96 R/F1 10/Times-Bold@0 SF(/etc/r)2.659 E(c.d/init.d/nfslock)-.18 E F0
.159(and related \214les.)2.659 F .158
(These patterns are consistent with the f)5.159 F .158(act that)-.1 F
(hda5/109864 calls)112 108 Q/F2 8/Courier@0 SF
(/etc/rc.d/init.d/nfslock restart)137 126 Q F0(in the end.)112 144 Q
2.353(According to the table generated from)112 159.6 R F1 -.1(rp)4.853
G(m).1 E F0 3.453 -.55('s o)D 2.353(utput, the).55 F F1(nfs-utils)4.853
E F0 2.353(package w)4.853 F 2.353(as installed at)-.1 F 2.5
(08:53:49. This)112 171.6 R(is consistent with our observ)2.5 E(ations.)
-.25 E .435(From 08:54:18 until 08:54:43, we can observ)112 187.2 R
2.934(et)-.15 G .434(he access patterns generated while the ne)-2.934 F
2.934(wn)-.25 G(ame)-2.934 E(serv)112 199.2 Q .839(er package w)-.15 F
.839(as installed using hda5/109803.)-.1 F .839(The name serv)5.839 F
.839(er w)-.15 F .84(as started at 08:54:25, and)-.1 F 1.004
(the installation proper w)112 211.2 R 1.003(as o)-.1 F -.15(ve)-.15 G
3.503(ra).15 G 3.503(t0)-3.503 G 1.003
(8:54:28, when the script issued a)-3.503 F F1(dig)3.503 E F0 1.003
(command in order to)3.503 F -.15(ve)112 223.2 S .234
(rify the installation.).15 F .234(The last access to this script w)
5.234 F .234(as at 08:54:43, when the unpack)-.1 F .234(ed contents)-.1
F .508(of the tar archi)112 235.2 R -.15(ve)-.25 G 3.008(,a).15 G .508
(nd the archi)-3.008 F .808 -.15(ve i)-.25 H .508(tself were remo).15 F
-.15(ve)-.15 G 3.008(d. Note).15 F .508
(that this interpretation is consistent)3.008 F 2.58(with the name serv)
112 247.2 R(er')-.15 E 5.081(ss)-.55 G 2.581
(tartup messages which were reco)-5.081 F -.15(ve)-.15 G 2.581
(red from apollo').15 F 5.081(ss)-.55 G -.1(wa)-5.081 G 5.081(p. These)
.1 F(messages date the start of)112 259.2 Q F1(named)2.5 E F0
(at 08:54:25, too.)2.5 E F1(08:55 \(07:58 CST\))87 274.8 Q F0 .72
(From 08:55:30 until 08:55:51 system time, the intruder used the)112
286.8 R F1(/usr/man/.Ci/addn)3.22 E F0 .72(program to)3.22 F 2.96
(add one or more /16 netw)112 298.8 R 2.96(orks to)-.1 F F1
(/usr/libexec/awk/addy)5.46 E(.awk)-.7 E F0 7.96(.T)C 2.96(he f)-7.96 F
2.96(act that the ctime of)-.1 F F1(/usr/libexec/awk)112 310.8 Q F0 -.1
(wa)2.795 G 2.795(sm).1 G .295(odi\214ed at 08:55:30 mak)-2.795 F .295
(es it highly lik)-.1 F .295(ely that)-.1 F F1(addy)2.795 E(.awk)-.7 E
F0 -.1(wa)2.795 G(sn').1 E 2.795(ti)-.18 G(nstalled)-2.795 E
(before this moment.)112 322.8 Q(\(Which is what we e)5 E
(xpect from the observ)-.15 E(ations made so f)-.25 E(ar)-.1 E(.\))-.55
E .872(At 08:55:58, the intruder used the)112 338.4 R F1(do)3.372 E F0
.872(script to remo)3.372 F 1.173 -.15(ve h)-.15 H .873(is traces \(the)
.15 F/F3 10/Courier@0 SF(adm1)3.373 E F0(and)3.373 E F3(own)3.373 E F0
(accounts\))3.373 E(from)112 350.4 Q F1(/etc/passwd)3.035 E F0(and)3.035
E F1(/etc/shado)3.035 E(w)-.1 E F0 5.535(.I)C(t')-5.535 E 3.035(si)-.55
G .535(nteresting to note that this script actually lea)-3.035 F .835
-.15(ve a r)-.2 H(ather).15 E 1.916(visible trace themselv)112 362.4 R
1.916(es: While remo)-.15 F(ving)-.15 E F3(own)4.416 E F0 4.416(,t)C
1.916(he system')-4.416 F(s)-.55 E F3(shutdown)4.417 E F0 1.917
(account is remo)4.417 F -.15(ve)-.15 G(d).15 E(from the user database.)
112 374.4 Q F1(08:56 \(07:59 CST\))87 390 Q F0 2.254
(At 08:56:02-08:56:04, the intruder used \212 ag)112 402 R 2.254
(ain \212 the)-.05 F F1(snap)4.753 E F0 2.253(script to remo)4.753 F
2.553 -.15(ve t)-.15 H 2.253(races from).15 F -.25(va)112 414 S
(rious log \214les.).25 E(It is not kno)5 E(wn for what traces he w)-.25
E(as looking here.)-.1 E 1.1(The \214le system acti)112 429.6 R 1.1
(vities from 08:56:05 until 08:56:10 sho)-.25 F 3.6(wt)-.25 G 1.1
(he intruder remo)-3.6 F 1.1(ving the v)-.15 F(arious)-.25 E 1.947
(source distrib)112 441.6 R 1.946(utions he had \212 most lik)-.2 F
1.946(ely \212 unpack)-.1 F 1.946(ed in)-.1 F F1(/usr/man/.Ci)4.446 E F0
6.946(.T)C 1.946(his clean-up w)-6.946 F(as)-.1 E
(performed by the script)112 453.6 Q F1(rmS)2.5 E F0 2.5(,w)C(hich w)
-2.5 E(as last read at 08:56:11.)-.1 E .533(At 08:56:25, we observ)112
469.2 R 3.033(eh)-.15 G 1.034 -.25(ow t)-3.033 H .534
(he intruder starts the instance of).25 F F1(bx)3.034 E F0 .534
(he left in)3.034 F F1(/usr/man/.Ci)3.034 E F0 5.534(.T)C(his)-5.534 E
-.15(ex)112 481.2 S .316(plains the atime discrepanc).15 F 2.816(yo)-.15
G(bserv)-2.816 E .316(ed abo)-.15 F .616 -.15(ve w)-.15 H .316
(hen he installed the program to).15 F F1(/bin)2.816 E F0(.)A F1(bx)
5.316 E F0 .316(in turn)2.816 F(uses)112 493.2 Q F1(/usr/bin/uncompr)2.5
E(ess)-.18 E F0 2.5(,w)C(hich can be con\214rmed by running)-2.5 E F1
(strings)2.5 E F0(\(1\) on the)A F1(bx)2.5 E F0(binary)2.5 E(.)-.65 E F1
(08:56-08:58 \(07:59-08:01 CST\))87 508.8 Q F0 3.641
(At 08:56:59, we observ)112 520.8 R 6.141(et)-.15 G 3.641
(he traces of the)-6.141 F F1(chmod-it)6.142 E F0 3.642
(script, which sets rather restricti)6.142 F -.15(ve)-.25 G
(permissions on v)112 532.8 Q
(arious binaries on the system which normally run with special pri)-.25
E(vile)-.25 E(ges.)-.15 E(At 08:57:06, the intruder runs)112 548.4 Q F1
(mkdir)2.5 E F0 2.5(,f)C(ollo)-2.5 E(wed by)-.25 E F1(cho)2.5 E(wn)-.1 E
F0(at 08:58:19.)2.5 E(The f)112 564 Q(act that)-.1 E F1(/tmp)2.5 E F0
-.1(wa)2.5 G 2.5(sa).1 G(ccessed at 08:58:08 may be a trace of a)-2.5 E
F2(cd /tmp)137 582 Q F0(at this point of time.)112 600 Q(This is, ho)5 E
(we)-.25 E -.15(ve)-.25 G .8 -.4(r, n).15 H(ot certain.).4 E
(At 08:58:26, the traces hint that the intruder typed:)112 615.6 Q F2
(su drosen)137 633.6 Q F0 1.82 -.8(We n)112 651.6 T .22(ote that).8 F F3
(drosen)2.72 E F0 -.55('s)C F1(.bashr)3.27 E(c)-.18 E F0 .219
(is the only startup \214le in his home directory which w)2.72 F .219
(as accessed)-.1 F .254(at this point of time.)112 663.6 R .254
(All other "dot-\214les" were last accessed on No)5.254 F 2.755(v5)-.15
G 5.255(.T)-2.755 G .255(his means that the shell)-5.255 F .897
(started w)112 675.6 R .897(as interacti)-.1 F -.15(ve)-.25 G 3.397(,b)
.15 G .897(ut not a login shell \(which w)-3.597 F .897(ould ha)-.1 F
1.197 -.15(ve b)-.2 H .897(een spa).15 F .897(wned by typing)-.15 F F3
.896(su \212)3.396 F(drosen)112 687.6 Q F0 2.67(\). Note)B .17
(that the access to)2.67 F F1(/lib/security/pam_xauth.so)2.67 E F0 .17
(at this point of time is justi\214ed by)2.67 F 2.5(al)112 699.6 S
(ook at)-2.5 E F1(/etc/pam.d/su)2.5 E F0(.)A -.15(Fo)112 715.2 S 6.031
(rt).15 G 3.531(he acti)-6.031 F 3.531(vities which follo)-.25 F 6.031
(w\()-.25 G 3.531(08:58:26-08:59:07\), we ha)-6.031 F 3.831 -.15(ve o)
-.2 H 3.531(nce ag).15 F 3.531(ain tw)-.05 F 6.03(os)-.1 G 3.53
(ources of)-6.03 F .448
(information: In addition to the \214le time stamps, we can use)112
727.2 R F3(drosen)2.949 E F0 -.55('s)C F1(.bash_history)3.499 E F0 .449
(\214le, which)2.949 F(27 January 2001)254.95 768 Q EP
%%Page: 18 18
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-18-)279.67 48 Q(we quote in its entirety)112 84
Q(.)-.65 E/F1 8/Courier@0 SF(gunzip *)137 102 Q(tar -xvf *)137 114 Q
(rm tpack*)137 126 Q(cd " ")137 138 Q(./install)137 150 Q(exit)137 162 Q
F0(Note that there is no indication that the bot is actually run.)112
180 Q/F2 10/Times-Bold@0 SF(08:59 \(08:02 CST\))87 195.6 Q F0 .086
(At 08:59:14, the intruder is)112 207.6 R/F3 10/Courier@0 SF(root)2.586
E F0(ag)2.585 E .085(ain, and remo)-.05 F -.15(ve)-.15 G 2.585(st).15 G
.085(he \214les he left back.)-2.585 F .085(The mtime and ctime)5.085 F
(on)112 219.6 Q F2(/de)3.32 E(v)-.15 E F0 3.32(,a)C .82(nd the atime on)
-3.32 F F2(/bin/rm)3.32 E F0 3.32(,a)C .821
(re hints that the intruder may ha)-3.32 F 1.121 -.15(ve h)-.2 H .821
(ad his \214les reside in a).15 F 1.423(subdirectory of)112 231.6 R F2
(/de)3.923 E(v)-.15 E F0 6.422(.I)C(nspecting)-6.422 E F2(/de)3.922 E(v)
-.15 E F0 2.522 -.55('s i)D 1.422(node with).55 F F2(icat)3.922 E F0
3.922(,w)C 3.922<658c>-3.922 G 1.422(nd the string)-3.922 F F3(tpacker)
3.922 E F0(in)3.922 E F2(/de)3.922 E(v)-.15 E F0(,)A
(which further supports this h)112 243.6 Q(ypothesis.)-.05 E F2
(09:02 \(08:05 CST\))87 259.2 Q F0 3.628(As one)112 271.2 R 1.128
(of his)3.628 F 1.129(last acti)6.129 F 1.129
(vities, the intruder tested his)-.25 F F2(ssh)3.629 E F0 1.129
(backdoor at 09:02:22.)3.629 F 2.729 -.8(We l)6.129 H 1.129(ook at the)
.8 F(time stamps in a bit more detail:)112 283.2 Q F1
(Nov 08 00 09:02:22)137 301.2 Q(26 .a. -rw-r--r-- root)33.6 E 19.2
(root mnt/etc/host.conf)24 F(67580 .a. -rwxr-xr-x root)242.6 313.2 Q
19.2(root mnt/lib/libnss_dns-2.1.3.so)24 F(19 .a. lrwxrwxrwx root)257
325.2 Q 19.2(root mnt/lib/libnss_dns.so.2)24 F(-> libnss_dns-2.1.3.so)
4.8 E(169720 .a. -rwxr-xr-x root)237.8 337.2 Q 19.2
(root mnt/lib/libresolv-2.1.3.so)24 F(18 .a. lrwxrwxrwx root)257 349.2 Q
19.2(root mnt/lib/libresolv.so.2)24 F(-> libresolv-2.1.3.so)4.8 E
(Nov 08 00 09:02:23)137 361.2 Q(68 .a. -rw-r--r-- root)33.6 E 19.2
(root mnt/etc/hosts)24 F(1567 .a. -rw-r--r-- root)247.4 373.2 Q 19.2
(root mnt/etc/protocols)24 F(Nov 08 00 09:02:28)137 385.2 Q
(10 .a. lrwxrwxrwx root)33.6 E 19.2(root mnt/usr/tmp)24 F(-> ../var/tmp)
4.8 E(1024 m.c drwxrwxrwx root)247.4 397.2 Q 19.2(root mnt/var/tmp)24 F
(184 mac -rw-r--r-- root)252.2 409.2 Q 19.2(root mnt/var/tmp/nap)24 F F0
1.826 -.8(We o)112 427.2 T(bserv).8 E 2.726(et)-.15 G .225
(hat, at 09:02:22, the dynamic library responsible for DNS lookups w)
-2.726 F .225(as read.)-.1 F .225(This is)5.225 F 3.489(as)112 439.2 S
.989(trong sign for an incoming connection which has triggered a \(re)
-3.489 F -.15(ve)-.25 G .99(rse\) lookup.).15 F .99(At 09:02:23,)5.99 F
F2(/etc/hosts)112 451.2 Q F0(and)2.5 E F2(/etc/pr)2.5 E(otocols)-.18 E
F0(are read, what supports our h)2.5 E(ypotehsis.)-.05 E 1.147
(At 09:02:28 \(after the user entered his passw)112 466.8 R(ord\),)-.1 E
F2(/usr/tmp/nap)3.647 E F0 1.147(is written.)3.647 F 1.147(The \214le')
6.147 F 3.646(sc)-.55 G(ontents)-3.646 E(fully con\214rm our h)112 478.8
Q(ypothesis:)-.05 E F1(+-[ User Login ]-------------------- --- --- - -)
137 496.8 Q 4.8(|u)137 508.8 S(sername: root password: tw1Lightz0ne hos\
tname: c871553-b.jffsn1.mo.home.com)-4.8 E
(+----------------------------------- ----- --- -- -- -)137 520.8 Q F0
.502(At 09:02:30, the intruder looks who')112 542.4 R 3.002(sl)-.55 G
.502(ogged in using)-3.002 F F2(w)3.002 E F0 3.002(\(1\). At)B .502
(09:02:31, he most lik)3.002 F .502(ely v)-.1 F(eri\214es)-.15 E
(the proper functioning of his root-kitted)112 554.4 Q F2(ps)2.5 E F0
(replacement.)2.5 E F2(09:02-09:03 \(08:05-08:06 CST\))87 570 Q F0 1.243
(Then \212 from 09:02:42 until 09:03:12 \212, he edits)112 582 R F2
(/etc/inetd.conf)3.743 E F0 3.743(using the)3.743 F F2(pico)3.743 E F0
(editor)3.742 E 3.742(,m)-.4 G(ost)-3.742 E(lik)112 594 Q(ely remo)-.1 E
(ving his original back door)-.15 E(.)-.55 E(At 09:03:12,)112 609.6 Q F2
(killall)2.5 E F0 -.1(wa)2.5 G 2.5(sm).1 G(ost lik)-2.5 E(ely e)-.1 E
-.15(xe)-.15 G 2.5(cuted. The).15 F(reason for this is unclear)2.5 E(.)
-.55 E(Finally)112 625.2 Q 2.5(,a)-.65 G 2.5(t0)-2.5 G
(9:03:15, we observ)-2.5 E 2.5(et)-.15 G(he last read access to)-2.5 E
F3(root)2.5 E F0 -.55('s)C F2(.bash_logout)3.05 E F0(\214le:)2.5 E F1
(Nov 08 00 09:03:15)137 643.2 Q(24 .a. -rw-r--r-- root)33.6 E 19.2
(root mnt/root/.bash_logout)24 F(3124 .a. -rwxr-xr-x root)247.4 655.2 Q
19.2(root mnt/usr/bin/clear)24 F(1143 .a. -rw-r--r-- root)247.4 667.2 Q
19.2(root mnt/usr/share/terminfo/v/vt100)24 F(1143 .a. -rw-r--r-- root)
247.4 679.2 Q 19.2(root mnt/usr/share/terminfo/v/vt100-am)24 F F2
(/usr/bin/clear)112 697.2 Q F0 .512(is e)3.012 F -.15(xe)-.15 G .513
(cuted from).15 F F2(.bash_logout)3.013 E F0 3.013(,a)C .513
(nd the access to the terminfo \214le re)-3.013 F -.15(ve)-.25 G .513
(als that the).15 F(user')112 709.2 Q(s)-.55 E F3(TERM)2.5 E F0(en)2.5 E
(vironment v)-.4 E(ariable w)-.25 E(as set to)-.1 E F3(vt100)2.5 E F0
(in this session, too.)2.5 E(\(See also 5.1.\))5 E(27 January 2001)
254.95 768 Q EP
%%Page: 19 19
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-19-)279.67 48 Q/F1 10/Times-Bold@0 SF 2.5
(7.3. Securing)72 84 R(the e)2.5 E(vidence)-.15 E F0 1.021
(The remainder of)112 99.6 R/F2 10/Courier@0 SF(timeline.txt)3.521 E F0
(sho)3.521 E 1.021(ws ho)-.25 F 3.521(wt)-.25 G 1.021(he e)-3.521 F
1.021(vidence w)-.25 F 1.021(as secured.)-.1 F 2.62 -.8(We d)6.021 H
3.52(on).8 G 1.02(ot e)-3.52 F(xamine)-.15 E(this in detail.)112 111.6 Q
F1 2.5(8. Mor)72 135.6 R 2.5(et)-.18 G(ools fr)-2.5 E(om the attack)-.18
E(er')-.1 E 2.5(sc)-.37 G(hest.)-2.5 E F0(In this section, we e)87 151.2
Q(xamine the unused tools the attack)-.15 E
(er left back in his chest in)-.1 E F1(/usr/man/.Ci)2.5 E F0(.)A F1
(addps)87 166.8 Q F0 .117(This simple shell script adds entries to)112
178.8 R F1(/de)2.617 E(v/ptyp)-.15 E F0 2.617(,t)C .118
(he con\214guration \214le of the trojaned)-2.617 F F1(top)2.618 E F0
(and)2.618 E F1(ps)2.618 E F0(utilities.)112 190.8 Q F1(\214nd)87 206.4
Q F0(Inspecting the binary with)8.32 E F1(strings)2.5 E F0
(\(1\), we \214nd more references to lrk4:)A/F3 8/Courier@0 SF 4.8(#s)
137 224.4 S(trings -a find | fgrep lrk)-4.8 E
(/home/aarons2/. /.d/lrk4/findutils/find/)137 236.4 Q
(/home/aarons2/. /.d/lrk4/findutils/lib/)137 248.4 Q F0
(Thus, we claim that this binary is the well-kno)112 266.4 Q
(wn trojaned)-.25 E F1(\214nd)2.5 E F0(implementation from lrk4.)2.5 E
F1(inetd)87 282 Q F0 .604(This \214le is statically link)112 294 R .604
(ed and stripped.)-.1 F .604(Our h)5.604 F .604
(ypothesis is that this is another trojan from lrk4.)-.05 F(In)112 306 Q
-.15(ve)-.4 G(stig).15 E 2.83(ating this binary with)-.05 F F1(strings)
5.33 E F0 2.83(\(1\), we \214nd a reference to)B F1(/bin/sh)5.33 E F0
5.33(,i)C 5.33(nt)-5.33 G 2.83(he immediate)-5.33 F 1.715
(neighborhood of the string)112 318 R F2(lpd)4.215 E F0 4.215(,a)C 1.714
(nd \214nally \212 and nearby \212 the string)-4.215 F F2(rfe)4.214 E F0
6.714(.A)C 1.714(ll these are)-6.714 F(typical for lrk4')112 330 Q 2.5
(s\()-.55 G(or lrk5')-2.5 E(s\) trojaned v)-.55 E(ersion of)-.15 E F1
(inetd)2.5 E F0(.)A F1(killall)87 345.6 Q F0 1.657
(This is another libc5 binary)112 357.6 R 6.657(.A)-.65 G(pplying)-6.657
E F1(strings)4.157 E F0 1.658(\(1\), we \214nd the follo)B 1.658
(wing interesting character)-.25 F(sequences:)112 369.6 Q F3(hackinit)
137 387.6 Q(hack_list)137 399.6 Q(hackcheck)137 411.6 Q(fp_hack)137
423.6 Q(/dev/.oz/p)137 435.6 Q F0 1.6 -.8(We c)112 453.6 T
(laim that this is an lrk v).8 E(ersion of)-.15 E F1(killall)2.5 E F0(.)
A F1(needz)87 469.2 Q F0(This simple shell script echoes the URLs of)112
481.2 Q F1(scr)2.5 E(een)-.18 E F0(and)2.5 E F1(pico)2.5 E F0(packages.)
2.5 E F1(pstr)87 496.8 Q(ee)-.18 E F0 .769(This is a binary which w)112
508.8 R .769(as link)-.1 F .769(ed ag)-.1 F .769(ainst glibc.)-.05 F
.769(It contains a reference to)5.769 F F1(/usr/man/.p)3.268 E F0 3.268
(,a)C .768(nd the)-3.268 F(follo)112 520.8 Q(wing strings:)-.25 E F3(h_\
st:T\(0,20\)=s136next:\(0,21\)=*\(0,20\),0,32;hack_type:\(0,1\),32,32;\
\\)137 538.8 Q(hack_cmd:\(0,22\)=ar\(0,1\);0;127;\(0,2\),64,1024;;)137
550.8 Q(hackinit:F\(0,19\))137 562.8 Q(hackcheck:F\(0,1\))137 574.8 Q
(hack_list:G\(0,21\))137 586.8 Q(fp_hack:G\(0,42\))137 598.8 Q(hackinit)
137 610.8 Q(hack_list)137 622.8 Q(hackcheck)137 634.8 Q(fp_hack)137
646.8 Q F0 1.6 -.8(We c)112 664.8 T
(laim that this is another lrk trojan.).8 E F1(q)87 680.4 Q(qs)87 696 Q
F0 .782(According to some strings found in the binaries, these are the \
client and serv)15.55 F .782(er for some secure)-.15 F .116
(connection system by)112 708 R/F4 10/Times-Italic@0 SF(Mixter)2.616 E
F0 5.116(.M)C .116(ore precisely)-5.116 F 2.616(,t)-.65 G .116
(his seem to be compiled v)-2.616 F .116(ersions of the client and)-.15
F(serv)112 720 Q(er from the)-.15 E F1(Q2)2.5 E F0(package which is a)
2.5 E -.25(va)-.2 G(ilable from http://mixter).25 E(.w)-.55 E
(arrior2k.com/progs.html.)-.1 E(27 January 2001)254.95 768 Q EP
%%Page: 20 20
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-20-)279.67 48 Q/F1 10/Times-Bold@0 SF(sp.pl)87
84 Q F0(This is a perl script which postprocesses)112 96 Q F1
(linsniffer)2.5 E F0(output.)2.5 E F1(syslogd)87 111.6 Q F0 .103
(This binary references)112 123.6 R F1(/usr/man/.l)2.603 E F0 5.103(.I)C
(t')-5.103 E 2.603(ss)-.55 G .103(tatically link)-2.603 F .103
(ed, and stripped.)-.1 F .103(Our h)5.103 F .103(ypothesis is that this)
-.05 F
(is another lrk trojan, and comes from the same source as the trojaned)
112 135.6 Q F1(inetd)2.5 E F0(.)A F1(<space>/Anap)87 151.2 Q F0
(This simple shell script pur)112 163.2 Q(ges)-.18 E F1(/usr/tmp/nap)2.5
E F0(.)A F1(paki/str)87 178.8 Q(eam.c)-.18 E F0 .557(This is the)112
190.8 R F1(str)3.057 E(eam.c)-.18 E F0 .557
(denial of service attack which w)3.057 F .557(as discussed on the)-.1 F
F1 -.2(bu)3.057 G(gtraq).2 E F0 .556(mailing list in)3.057 F
(January 2000.)112 202.8 Q F1(paki/slice2)87 218.4 Q F0 7.406
(It may seem lik)112 230.4 R 7.406
(ely that this program is related to the SYN-\215ooding tool at)-.1 F
(http://www)112 242.4 Q(.computec.ch/e)-.65 E 1.883
(xploits/dos/slice2.c. Ho)-.15 F(we)-.25 E -.15(ve)-.25 G 2.683 -.4
(r, a l).15 H 1.883(ook with).4 F F1(strings)4.383 E F0 1.883
(\(1\) quickly re)B -.15(ve)-.25 G(als).15 E 2.6(that the)112 254.4 R F1
(slice2)5.1 E F0 2.6(binary found on apollo w)5.1 F 2.601(as b)-.1 F
2.601(uilt from a dif)-.2 F 2.601(ferent source, b)-.25 F 2.601(ut tak)
-.2 F 2.601(es similar)-.1 F(parameters.)112 266.4 Q 3.468 -.8(We n)112
282 T 1.868(otice that this binary w).8 F 1.868(as dynamically link)-.1
F 1.868(ed ag)-.1 F 1.868(ainst libc5. The plan for analyzing this)-.05
F .646(program is, thus, to use the dynamic link)112 294 R .646
(er in order to create a laboratory en)-.1 F .647(vironment in which)-.4
F .273(we can easily observ)112 306 R 2.772(ea)-.15 G .572 -.15(ny p)
-2.772 H(ack).15 E .272(ets crafted, without actually sending an)-.1 F
.272(ything to the netw)-.15 F 2.772(ork. W)-.1 F(e)-.8 E 2.108
(then apply the same method to the kno)112 318 R(wn)-.25 E F1(slice2)
4.609 E F0 4.609(,a)C 2.109(nd analyze the dif)-4.609 F 2.109
(ferences between both)-.25 F(programs.)112 330 Q 1.658 -.8(We \214)112
345.6 T .058(rst use).8 F F1(nm)2.558 E F0 .058(\(1\) to get an o)B -.15
(ve)-.15 G(rvie).15 E 2.558(wo)-.25 G 2.558(ft)-2.558 G .058
(he functions used.)-2.558 F(Apparently)5.057 E 2.557(,t)-.65 G .057
(he k)-2.557 F .357 -.15(ey s)-.1 H .057(ystem calls and).15 F 1.129
(library functions used are)112 357.6 R F1(sendto)3.629 E F0(\(2\),)A F1
(rand)3.629 E F0(\(3\),)A F1(random)3.629 E F0 1.129(\(3\), and)B F1
(sock)3.629 E(et)-.1 E F0 3.629(\(2\). The)B(kno)3.629 E(wn)-.25 E F1
(slice2.c)3.63 E F0(,)A 1.595(additionally in)112 369.6 R -.2(vo)-.4 G
-.1(ke).2 G(s).1 E F1 -.25(fo)4.095 G(rk).25 E F0 1.594
(\(2\) in order to create man)B 4.094(yp)-.15 G 1.594
(rocesses which are run in parallel.)-4.094 F -.8(We)6.594 G 2.076
(prepare a simple shared library \(see)112 381.6 R/F2 10/Courier@0 SF
(libfake.tar)4.577 E F0 4.577(\)w)C 2.077(hich pro)-4.577 F 2.077
(vides f)-.15 F(ak)-.1 E 4.577(ev)-.1 G 2.077(ersions of these)-4.727 F
2.522(functions. In)112 393.6 R(particular)2.522 E(,)-.4 E F1(rand)2.522
E F0 .022(\(3\) and)B F1(random)2.522 E F0 .021
(\(3\) are changed to return reproducible data \(and can)B(no)112 405.6
Q 5.807(wb)-.25 G 5.807(eu)-5.807 G 3.307(sed interchangeably\),)-5.807
F F1(sock)5.807 E(et)-.1 E F0 3.307
(\(2\) just returns increasing positi)B 3.607 -.15(ve n)-.25 H(umbers,)
.15 E F1 -.25(fo)5.807 G(rk).25 E F0(\(2\))A .802
(simulates a single successful fork call from the child')112 417.6 R
3.301(sp)-.55 G(erspecti)-3.301 E -.15(ve)-.25 G 3.301(,a).15 G(nd)
-3.301 E F1(sendto)3.301 E F0 .801(\(2\) logs an)B 3.301(yd)-.15 G(ata)
-3.301 E .22(transmitted to a \214le gi)112 429.6 R -.15(ve)-.25 G 2.72
(ni).15 G 2.72(nt)-2.72 G .22(he en)-2.72 F .22(vironment v)-.4 F
(ariable)-.25 E F2(SENDTO_LOG)2.72 E F0 5.22(.T)C .22
(he format used is similar)-5.22 F(to the one produced by)112 441.6 Q/F3
8/Courier@0 SF(tcpdump -x)137 459.6 Q F0(and is, in particular)112 477.6
Q 2.5(,u)-.4 G(nderstood by W)-2.5 E(ietse V)-.4 E(enema')-1.11 E(s)-.55
E F1(tcpdumpx)2.5 E F0(utility)2.5 E(.)-.65 E(No)112 493.2 Q 2.353 -.65
(w, w)-.25 H 3.553(er).65 G 1.053(un the follo)-3.553 F 1.053
(wing commands \(with)-.25 F F1(slice2.apollo)3.553 E F0 1.053
(being a cop)3.553 F 3.552(yo)-.1 G 3.552(ft)-3.552 G 1.052
(he binary found on)-3.552 F(apollo\):)112 505.2 Q F3 4.8($L)137 523.2 S
(D_PRELOAD=./fake.so SENDTO_LOG=sendto.log \\)-4.8 E
(./slice2 127.0.0.1 127.0.0.1 1 200 1)162 535.2 Q 4.8($L)137 547.2 S
(D_PRELOAD=./fake.so SENDTO_LOG=sendto.log.apollo \\)-4.8 E
(./slice2.apollo 127.0.0.1 127.0.0.1 1 200 1)162 559.2 Q F0 1.502
(After a short time, we interrupt the programs by sending SIGINT)112
577.2 R 4.002(.T)-.74 G 1.502(he log \214les produced are)-4.002 F 1.909
(included \(the log \214le generated by the apollo)112 589.2 R F1
(slice2)4.409 E F0 -.1(wa)4.409 G 1.909(s, ho).1 F(we)-.25 E -.15(ve)
-.25 G 2.709 -.4(r, m).15 H 1.909(anually truncated after).4 F(-)-.2 E
-.1(wa)112 601.2 S 2.5(rds\). W).1 F 2.5(ep)-.8 G(rocess them with)-2.5
E F1(tcpdumpx)2.5 E F0 2.5(,e)C(xtracting pack)-2.65 E(et headers:)-.1 E
F3 4.8($t)137 619.2 S
(cpdumpx < sendto.log.apollo | fgrep -A3 HDR > headers.apollo)-4.8 E 4.8
($t)137 631.2 S(cpdumpx < sendto.log | fgrep -A3 HDR > headers)-4.8 E F0
1.833(\(The \214les produced are included.\))112 649.2 R 4.333(At)6.833
G 1.833(ypical pack)-4.333 F 1.833
(et header generated by the publicly kno)-.1 F(wn)-.25 E F1(slice2)112
661.2 Q F0(looks lik)2.5 E 2.5(et)-.1 G(his:)-2.5 E F3
(IP_HDR=20 IP_OPT=0 TCP_HDR=20 TCP_OPT=-20 DATA=20 FLAGS=SYN)156.2 679.2
Q 9.6(IP_HDR 45)156.2 703.2 R 4.8(00 00 28 00 00 00 00 ff 06)9.6 F
(vhl tos len len id)194.6 715.2 Q 4.8(id off)9.6 F(off ttl pro)4.8 E 9.6
(IP_HDR bd)156.2 727.2 R 4.8(cd 7f 00 00 01 7f 00 00 01)9.6 F F0
(27 January 2001)254.95 768 Q EP
%%Page: 21 21
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-21-)279.67 48 Q/F1 8/Courier@0 SF
(sum sum src src src src dst dst dst dst)194.6 84 Q 4.8
(TCP_HDR 01 00 00 01 02 00 00 00 03 00)156.2 96 R
(src src dst dst seq seq seq seq ack ack)194.6 108 Q 4.8
(TCP_HDR 00 00 00 02 ff ff f9 fc 00 00)156.2 120 R
(ack ack off flg win win sum sum urp urp)194.6 132 Q F0
(On the other hand, a pack)112 150 Q(et header generated by the v)-.1 E
(ersion found on apollo looks lik)-.15 E 2.5(et)-.1 G(his:)-2.5 E F1
(IP_HDR=20 IP_OPT=0 TCP_HDR=20 TCP_OPT=0 DATA=10200 FLAGS=SYN)156.2 168
Q 9.6(IP_HDR 45)156.2 192 R 4.8(00 28 00 00 01 00 00 1e 06)9.6 F
(vhl tos len len id)194.6 204 Q 4.8(id off)9.6 F(off ttl pro)4.8 E 9.6
(IP_HDR 75)156.2 216 R 4.8(12 7f 00 00 01 7f 00 00 01)9.6 F
(sum sum src src src src dst dst dst dst)194.6 228 Q 4.8
(TCP_HDR 00 02 00 01 00 00 00 03 00 00)156.2 240 R
(src src dst dst seq seq seq seq ack ack)194.6 252 Q 4.8
(TCP_HDR 00 00 50 02 ff ff b1 da 00 00)156.2 264 R
(ack ack off flg win win sum sum urp urp)194.6 276 Q F0 1.834 -.8(We i)
112 297.6 T .234(mmediately notice that both programs generate TCP pack)
.8 F .233(ets with the SYN \215ag set, and with)-.1 F -.25(va)112 309.6
S .301(rying source and destination ports.).25 F .301
(Thus, both programs are indeed being used to SYN \215ood a)5.301 F(tar)
112 321.6 Q(get.)-.18 E 1.56(Looking more closely at the indi)112 337.2
R 1.56(vidual entries in the header)-.25 F 4.06(,w)-.4 G 4.06(en)-4.06 G
1.56(ote that apollo')-4.06 F 4.06(sv)-.55 G 1.56(ersion of)-4.21 F/F2
10/Times-Bold@0 SF(slice2)112 349.2 Q F0 .295(writes out the pack)2.795
F .296(et length as 0x2800 \(10240\), while the publicly a)-.1 F -.25
(va)-.2 G .296(ilable v).25 F .296(ersion writes)-.15 F .812
(it out as 0x0028 \(40\).)112 361.2 R .812(The latter v)5.812 F .812
(alue correctly describes the pack)-.25 F .812(et sent.)-.1 F .811
(This may point to a)5.812 F(missing)112 373.2 Q F2(htons)2.573 E F0
.073(call in apollo')2.573 F 2.574(sv)-.55 G .074(ersion of)-2.724 F F2
(slice2)2.574 E F0 5.074(.O)C 2.574(nt)-5.074 G .074
(he other hand, the publicly kno)-2.574 F .074(wn v)-.25 F .074
(ersion of)-.15 F F2(slice2)112 385.2 Q F0 .339(produces pack)2.839 F
.339(ets with the TCP header length set to 0, while apollo')-.1 F 2.838
(sv)-.55 G .338(ersion correctly sets)-2.988 F .339(the header length n\
ibble to 5, corresponding to a header length of 20 bytes.)112 397.2 R
(Finally)5.339 E 2.839(,w)-.65 G 2.839(en)-2.839 G .339(ote that)-2.839
F(the TTL of the pack)112 409.2 Q(ets sent dif)-.1 E
(fers between the tw)-.25 E 2.5(ov)-.1 G(ersions of)-2.65 E F2(slice2)
2.5 E F0(.)A F2(scan/amd/a.sh)87 424.8 Q F0 4.992
(This script is used to probe the netw)112 436.8 R 4.992
(orks 206.110, 206.111, ... on port 111, using)-.1 F F2(scan/amd/pscan)
112 448.8 Q F0(.)A F2(scan/amd/pscan)87 464.4 Q(scna/amd/pscan.c)87 480
Q F0(The port scanner just mentioned, and its source code)112 492 Q F2
(scan/amd/amdx)87 507.6 Q F0 1.459
(From the strings found in this binary)112 519.6 R 3.959(,t)-.65 G 1.459
(his is a close relati)-3.959 F 1.76 -.15(ve o)-.25 H 3.96(ft).15 G 1.46
(he amd e)-3.96 F 1.46(xploit posted to the)-.15 F F2 -.2(bu)112 531.6 S
(gtraq).2 E F0 .75(mailing list by)3.25 F/F3 10/Times-Italic@0 SF(duk)
3.25 E 3.25(e<)-.1 G(duk)-3.25 E(e@VIPER.NET)-.1 E(.A)-.74 E(U>)-.5 E F0
.75(on Thu, 2 Sep 1999.)3.25 F .75(This vulnerability)5.75 F 1.83
(is also co)112 543.6 R -.15(ve)-.15 G 1.83(red by CER).15 F 4.33(TA)-.6
G 1.83(dvisory CA 99.12, and in RHSA 1999:032.)-4.33 F 1.83(It w)6.83 F
1.83(as \214x)-.1 F 1.83(ed in)-.15 F F2(am-)4.33 E(utils-6.0.1)112
555.6 Q F0 2.5(,w)C(hich is the v)-2.5 E(ersion of the package which w)
-.15 E(as installed by the intruder on apollo.)-.1 E F2(scan/amd/ben)87
571.2 Q(scan/amd/ben.c)87 586.8 Q F0 .142
(This program launches an RPC info query ag)112 598.8 R .142
(ainst a tar)-.05 F .141(get host, and is used to \214nd out whether or)
-.18 F 1.279(not a certain RPC service e)112 610.8 R 1.279
(xists on that host.)-.15 F 1.279(In this case, the)6.279 F/F4 10
/Courier@0 SF(RPCID)3.779 E F0 1.279(macro is de\214ned to be)3.779 F
(300019, which corresponds to the automounter)112 622.8 Q 5(.\()-.55 G
(See also)-5 E F2(/etc/r)2.5 E(pc)-.1 E F0(.\))A F2(scan/bind/ibind.sh)
87 638.4 Q F0 1.038(This script uses)112 650.4 R F2(scan/bind/pscan)
3.538 E F0 1.038(in order to look for name serv)3.538 F 3.537(ers. It)
-.15 F 1.037(then uses)3.537 F F2(dig)3.537 E F0 1.037(\(1\) to \214nd)B
.229(those name serv)112 662.4 R .229(ers' v)-.15 F .229(ersions, and c\
lassi\214es them as vulnerable or not vulnerable according to the)-.15 F
-.15(ve)112 674.4 S(rsion numbers.).15 E -1.11(Ve)5 G(rsions abo)1.11 E
.3 -.15(ve 8)-.15 H(.2.2 are not considered vulnerable.).15 E F2
(scan/daemon/lscan2.c)87 690 Q F0 1.664
(This is a port scanner which looks for hosts with running name serv)112
702 R 1.663(ers, POP)-.15 F 4.163(,I)-1.11 G 1.663(MAP or FTP)-4.163 F
(daemons, or)112 714 Q F2(mountd)2.5 E F0(.)A(27 January 2001)254.95 768
Q EP
%%Page: 22 22
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-22-)279.67 48 Q/F1 10/Times-Bold@0 SF
(scan/daemon/z0ne)87 84 Q F0 1.418
(This is a tool which performs an AXFR query for a domain gi)112 96 R
-.15(ve)-.25 G 3.918(no).15 G 3.919(nt)-3.918 G 1.419
(he command line, and)-3.919 F 1.289
(writes all IP addresses found in that zone to)112 108 R/F2 10/Courier@0
SF(stdout)3.788 E F0 6.288(.S)C 1.288(ource code for)-6.288 F F1(z0ne)
3.788 E F0 1.288(can be found in)3.788 F 1.843(current v)112 120 R 1.843
(ersions of)-.15 F F1(bind-contrib)4.343 E(.tar)-.4 E(.gz)-1 E F0 1.844
(as distrib)4.343 F 1.844(uted by the Internet Softw)-.2 F 1.844
(are Consortium at)-.1 F(ftp.isc.or)112 132 Q(g.)-.18 E F1(scan/port)87
147.6 Q F0(This directory contains the well-kno)112 159.6 Q
(wn port scanner)-.25 E F1(str)2.5 E(obe)-.18 E F0(.)A F1
(scan/statd/classb)87 175.2 Q F0 .635(From the strings contained, and a\
 short glance at a disassembler listing generated with)112 187.2 R F1
(gdb)3.135 E F0 3.135(,t)C(his)-3.135 E(program is most lik)112 199.2 Q
(ely used to quickly create a list of IP addresses to be scanned.)-.1 E
F1(scan/statd/r)87 214.8 Q F0 .189
(From the strings contained within this \214le, this program kno)112
226.8 R .189(ws itself as)-.25 F F2(rpcscan)2.69 E F0 2.69(,a)C .19
(nd is used to)-2.69 F .274
(scan for hosts on which a certain RPC service is running.)112 238.8 R
.273(It is lik)5.273 F .273(ely that another instance of this)-.1 F .482
(tool w)112 250.8 R .483(as responsible for the RPC Info Query observ)
-.1 F .483(ed by)-.15 F F1(snort)2.983 E F0 .483
(immediately before the break-in)2.983 F(occured.)112 262.8 Q .254
(It is lik)112 278.4 R .254
(ely that this program comes from source code v)-.1 F .253
(ery close to the one which can be found at)-.15 F(http://www)112 290.4
Q(.self-e)-.65 E 3.437(vident.com/security/scanners/rpcscan.c.gz. Ho)
-.25 F(we)-.25 E -.15(ve)-.25 G 1.737 -.4(r, w).15 H .938(hen applying)
.4 F F1(strings)3.438 E F0(\(1\))A(to the binary which w)112 302.4 Q
(as found on apollo, we notice the strings)-.1 E/F3 8/Courier@0 SF 4.8
(:%)137 320.4 S 4.8(iP)-4.8 G(ORT:%d)-4.8 E 4.8(,%)137 332.4 S 4.8(iP)
-4.8 G(ORT:%d)-4.8 E F0(which are not present in the publicly a)112
350.4 Q -.25(va)-.2 G(ilable source code.).25 E F1(scan/statd/statdx)87
366 Q F0(In)112 378 Q -.15(ve)-.4 G(stig).15 E .047
(ating this binary with)-.05 F F1(strings)2.547 E F0 .047
(\(1\), this seems to be a compiled v)B .046(ersion of the)-.15 F F1
(statdx)2.546 E F0 -.15(ex)2.546 G(ploit).15 E .68(posted to)112 390 R
F1 -.2(bu)3.18 G(gtraq).2 E F0(by)3.18 E/F4 10/Times-Italic@0 SF -.45
(ro)3.18 G .681(n1n - <shellcode@HO).45 F(TMAIL.COM>)-.4 E F0 .681
(on Aug 5 2000.)3.181 F .681(This is the same)5.681 F .872
(program which w)112 402 R .872(as most lik)-.1 F .872
(ely used to attack apollo.)-.1 F -.15(Fo)5.872 G 3.372(rR).15 G .872
(edHat linux, the problem)-3.372 F<8c78>8.372 E .872(ed in)-.15 F F1
(nfs-utils-0.1.9.1-1)112 414 Q F0 4.211(,w)C 1.711(hich is the v)-4.211
F 1.711(ersion of the package which w)-.15 F 1.712
(as installed on apollo by the)-.1 F(intruder)112 426 Q 5(.T)-.55 G
(his package w)-5 E(as announced in RHSA 2000:043-03.)-.1 E F1
(scan/wu/wu)87 441.6 Q F0 1.048(From the strings in this binary)112
453.6 R 3.548(,t)-.65 G 1.048(his is a compiled v)-3.548 F 1.047
(ersion of the attack originally posted to the)-.15 F F1 -.2(bu)112
465.6 S(gtraq).2 E F0 .547(maling list by)3.046 F F4 .547
(tf8 <tf8@zolo.fr)3.047 F(eelsd.net>)-.37 E F0 .547(on Jun 23 2000.)
3.047 F .547(The vulnerability is co)5.547 F -.15(ve)-.15 G(red).15 E
.263(by CER)112 477.6 R 2.763(TA)-.6 G .262
(dvisory CA-2000-1 and by RHSA 2000:039-02.)-2.763 F 1.862 -.8(We n)
5.262 H .262(ote that this problem w).8 F .262(as \214x)-.1 F(ed)-.15 E
1.695(for RedHat in)112 489.6 R F1(wu-ftpd-2.6.0-14.6x)4.195 E F0 4.195
(,w)C 1.695(hich is precisely the v)-4.195 F 1.696
(ersion of the package which w)-.15 F(as)-.1 E
(installed by the intruder on apollo.)112 501.6 Q F1(scan/wu/fs)87 517.2
Q F0 2.357(From the strings in this binary)112 529.2 R 4.857(,t)-.65 G
2.357(his is a program which scans netw)-4.857 F(ork)-.1 E 2.356
(ed hosts for v)-.1 F(arious)-.25 E 2.5(vulnerabilities. The)112 541.2 R
(binary contains a reference to)2.5 E F2(www.r0xcrew.org)2.5 E F0 2.5
(,w)C(hich does not e)-2.5 E(xist.)-.15 E F1(scan/x/pscan)87 556.8 Q
(scan/x/pscan.c)87 572.4 Q F0 .181(This is another instance on the port\
 scanner which is also present in other subdirectories of)112 584.4 R F1
(scan/)2.681 E F0(.)A F1(scan/x/xscan)87 600 Q F0
(This shell script uses)112 612 Q F1(pscan)2.5 E F0
(to look for hosts which are running an X serv)2.5 E(er on port 6000.)
-.15 E F1(scan/x/x)87 627.6 Q F0 .555(From the strings in this binary)
112 639.6 R 3.055(,t)-.65 G .554(his program is intended to w)-3.055 F
.554(ork as an X11 k)-.1 F .854 -.15(ey l)-.1 H .554(ogger for either)
.15 F(indi)112 651.6 Q(vidual hosts or entire subnets.)-.25 E F1
(scan/x/x\214l)87 667.2 Q F0 .711(This shell script is apparently inten\
ded to scan \214les for "interesting" areas, containing k)112 679.2 R
-.15(ey)-.1 G -.1(wo).15 G(rds).1 E 1.576(such as)112 691.2 R F2(telnet)
4.076 E F0(,)A F2(ssh)4.076 E F0(,)A F2(rsh)4.076 E F0(,)A F2(rlogin)
4.076 E F0 4.075(,o)C(r)-4.075 E F2(ftp)4.075 E F0 6.575(.T)C 1.575
(his may be intended to help attack)-6.575 F 1.575(ers \214nd)-.1 F
(passw)112 703.2 Q(ords in k)-.1 E -.15(ey)-.1 G
(board logs generated by).15 E F1(scan/x/x)2.5 E F0(.)A(27 January 2001)
254.95 768 Q EP
%%Page: 23 23
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-23-)279.67 48 Q/F1 10/Times-Bold@0 SF 2.5
(9. Refer)72 84 R(ences)-.18 E F0(CER)87 99.6 Q 2.5(Ta)-.6 G
(dvisories can be found at http://www)-2.5 E(.cert.or)-.65 E(g/.)-.18 E
(Red Hat Security Advisories \(RHSA)87 115.2 Q -.55('s)-1.11 G 2.5(\)c)
.55 G(an be found at http://www)-2.5 E(.redhat.com/.)-.65 E(An archi)87
130.8 Q .3 -.15(ve o)-.25 H 2.5(ft).15 G(he)-2.5 E F1 -.2(bu)2.5 G
(gtraq).2 E F0(mailing list is a)2.5 E -.25(va)-.2 G
(ilable at http://www).25 E(.securityfocus.com/.)-.65 E 1.656
(More information on the internals of TCP/IP pack)87 146.4 R 1.657
(ets can be found in W)-.1 F 4.157(.R)-.92 G 1.657(ichard Ste)-4.157 F
-.15(ve)-.25 G(ns,).15 E/F2 10/Times-Italic@0 SF(TCP/IP)4.157 E(Illustr)
87 158.4 Q(ated, V)-.15 E(olume 1)-1.11 E F0 2.5(,A)C(ddison-W)-2.5 E
(esle)-.8 E 2.5(y1)-.15 G(994.)-2.5 E
(The published source code for linux root kits is a)87 174 Q -.25(va)-.2
G(ilable from ftp://ftp.technotronic.com/unix/trojans/.).25 E F1
(tcpdumpx)87 189.6 Q F0(is a)2.5 E -.25(va)-.2 G
(ilable from ftp://ftp.porcupine.or).25 E(g/pub/deb)-.18 E(ugging/.)-.2
E F2(The Cor)87 205.2 Q(oner')-.45 E 2.5(sT)-.4 G(oolkit)-3.42 E F0
(is a)2.5 E -.25(va)-.2 G(ilable from http://www).25 E(.porcupine.or)
-.65 E(g/forensics/.)-.18 E F1 -.25(Ap)72 229.2 S(pendix).25 E
([Q1] Identify the intrusion method, its date, and time.)72 253.2 Q F0
(See sections 4.2 and 7.2.)87 268.8 Q F1
([Q2] identify as much as possible about the intruder\(s\).)72 292.8 Q
F0 .902(The closest thing to identifying information about the intruder\
 are the time stamps related to netw)87 308.4 R(ork)-.1 E(acti)87 320.4
Q(vities:)-.25 E F1<83>87 336 Q F0(At 23:11 CST on No)21.5 E 2.5(v7)-.15
G 2.5(,2)-2.5 G(000, the intruder attack)-2.5 E
(ed the system from 216.216.74.2.)-.1 E F1<83>87 351.6 Q F0 .323
(At 07:31 CST on No)21.5 F 2.823(v8)-.15 G 2.823(,2)-2.823 G .324
(000, and at 07:45 and 08:05 CST on the same day)-2.823 F 2.824(,t)-.65
G .324(he intruder logged)-2.824 F(into the hack)112 363.6 Q
(ed system from 24.12.200.186, using telnet and ssh clients.)-.1 E 2.113
-.8(We d)87 379.2 T 3.013(on).8 G .513(ot kno)-3.013 F 3.013(ww)-.25 G
.513(hether or not these IP addresses identify systems ab)-3.013 F .513
(used by the intruder)-.2 F 3.013(,o)-.4 G 3.012(rw)-3.013 G(hether)
-3.012 E(the)87 391.2 Q 2.5(yd)-.15 G(irectly lead to him.)-2.5 E
(Additionally)87 406.8 Q 2.98(,t)-.65 G .48
(here are some conjectures we can mak)-2.98 F 2.98(ea)-.1 G .48
(bout the attack)-2.98 F .48(er from the traces he left behind)-.1 F
(on apollo, and from his beha)87 418.8 Q(viour on the system:)-.2 E F1
<83>87 434.4 Q F0 3.272 -.8(We c)21.5 H 1.672(an identify v).8 F 1.671
(arious sources from which the intruder')-.25 F 4.171(st)-.55 G 1.671
(ools come.)-4.171 F 1.671(At least three can be)6.671 F .74
(distinguished: There are programs from lrk4 which were link)112 446.4 R
.74(ed dynamically ag)-.1 F .74(ainst libc5 \(such)-.05 F(as)112 458.4 Q
F1(/bin/ls)3.354 E F0(and)3.354 E F1(/sbin/ifcon\214g\).)3.354 E F0 .853
(Then, there are programs which were link)5.854 F .853
(ed dynamically ag)-.1 F(ainst)-.05 E 2.025
(glibc, such as the generic backdoor wrapper found in)112 470.4 R F1
(/usr/sbin/in.identd)4.526 E F0 4.526(,o)C(r)-4.526 E F1(/usr/sbin/tcpd)
4.526 E F0(.)A(Finally)112 482.4 Q 2.5(,t)-.65 G
(here are statically link)-2.5 E(ed \(and stripped\) binaries such as)
-.1 E F1(/usr/man/.Ci/syslogd)2.5 E F0(.)A F1<83>87 498 Q F0 .378
(The attack)21.5 F .378(er used scripts which didn')-.1 F 2.878(tm)-.18
G .378(atch the trojan horse binaries he installed on the system.)-2.878
F(Note the unused rootkit con\214guration \214le)112 510 Q F1
(/usr/man/p)2.5 E F0(.)A F1<83>87 525.6 Q F0 .714
(When the Linux root kit is b)21.5 F .714(uilt from scratch, se)-.2 F
-.15(ve)-.25 G .714(ral binaries share the same con\214guration \214le,)
.15 F(for instance)112 537.6 Q F1(netstat)2.5 E F0(and)2.5 E F1(tcpd)2.5
E F0 5(.T)C(his is not the case with the binaries found on apollo.)-5 E
F1<83>87 553.2 Q F0 .692
(The intruder installed a set of RedHat security updates which w)21.5 F
.691(ould apply to earlier v)-.1 F .691(ersions of)-.15 F(the distrib)
112 565.2 Q(ution - b)-.2 E(ut actually turn out to be do)-.2 E
(wngrades on more recent RedHat distrib)-.25 E(utions.)-.2 E 2.111 -.8
(We c)87 580.8 T .511(onclude that the intruder most lik).8 F .512
(ely did not b)-.1 F .512
(uild his collection of attack tools from source code,)-.2 F -.2(bu)87
592.8 S 2.5(to).2 G(btained the tools in binary form from v)-2.5 E
(arious sources.)-.25 E(Additionally)87 608.4 Q 4.527(,f)-.65 G 2.027
(rom the installation of)-4.527 F F1(BitchX)4.527 E F0 2.027(\(which w)
4.527 F 2.027(as actually run\), and from the f)-.1 F 2.026
(act that the)-.1 F(attack)87 620.4 Q 1.808
(er performed steps to install an)-.1 F F1(eggdr)4.308 E(op)-.18 E F0
1.808(IRC bot, it seems lik)4.308 F 1.809
(ely that one of his interests is)-.1 F
(Internet Relay Chat, and possibly ab)87 632.4 Q(use of that netw)-.2 E
(ork.)-.1 E F1([Q3] List all the \214les that wer)72 656.4 Q 2.5(ea)-.18
G(dded/modi\214ed by the intruder)-2.5 E 5(.[)-1 G(...])-5 E F0(See v)87
672 Q(arious sections of the report.)-.25 E F1([Q4] W)72 696 Q
(as a sniffer or passw)-.65 E(ord har)-.1 E -.1(ve)-.1 G(sting pr).1 E
(ogram installed?)-.18 E F0(See sections 3, 6.3, and 7.2 of the report.)
87 711.6 Q(27 January 2001)254.95 768 Q EP
%%Page: 24 24
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-24-)279.67 48 Q/F1 10/Times-Bold@0 SF .008
([Q5] W)72 84 R .008(as ther)-.65 F 2.508(ea")-.18 G -.18(ro)-2.508 G
.008(otkit" or other post-concealment tr).18 F .008(ojan horse pr)-.18 F
.008(ograms installed on the system?)-.18 F F0 1.893(See section 3.)87
99.6 R 1.893(The rootkit w)6.893 F 1.893(as no obstacle for the in)-.1 F
-.15(ve)-.4 G(stig).15 E 1.894(ation, since all tools used resided on a)
-.05 F(kno)87 111.6 Q(wn-good system.)-.25 E F1
([Q6] What is publicly kno)72 135.6 Q(wn about the sour)-.1 E
(ce of any pr)-.18 E(ograms f)-.18 E(ound on the system?)-.25 E F0(See \
the report, in particular sections 3, 6.3, 7.2 \(08:52:15\), and 8.)87
151.2 Q F1([Q7] Build a time line of e)72 175.2 Q -.1(ve)-.15 G(nts.).1
E F0(See section 7 of the report.)87 190.8 Q(27 January 2001)254.95 768
Q EP
%%Trailer
end
%%EOF
