%!PS-Adobe-3.0
%%Creator: groff version 1.15
%%CreationDate: Sat Jan 27 21:33:02 2001
%%DocumentNeededResources: font Times-Bold
%%+ font Times-Italic
%%+ font Times-Roman
%%+ font Courier
%%DocumentSuppliedResources: procset grops 1.15 1
%%Pages: 3
%%PageOrder: Ascend
%%Orientation: Portrait
%%EndComments
%%BeginProlog
%%BeginResource: procset grops 1.15 1
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/MF{
findfont
[5 2 roll
0 3 1 roll
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}bind def
/DA{
newpath arcn stroke
}bind def
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
/DL{
SN
moveto
SN
lineto stroke
}bind def
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
/FL{
currentgray exch setgray fill setgray
}bind def
/BL/fill load def
/LW/setlinewidth load def
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
}bind def
/PEND{
clear
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%IncludeResource: font Times-Bold
%%IncludeResource: font Times-Italic
%%IncludeResource: font Times-Roman
%%IncludeResource: font Courier
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 841.89 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron
/Zcaron/scaron/zcaron/Ydieresis/trademark/quotesingle/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/Courier@0 ENC0/Courier RE/Times-Roman@0 ENC0/Times-Roman RE
/Times-Italic@0 ENC0/Times-Italic RE/Times-Bold@0 ENC0/Times-Bold RE
%%EndProlog
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
/F0 12/Times-Bold@0 SF(The A)182.946 123 Q(pollo Incident: T)-.3 E
(echnical Advisory)-1.104 E(.)-.84 E/F1 10/Times-Italic@0 SF
(Thomas Roessler <r)189.25 147 Q(oessler@does-not-e)-.45 E(xist.or)-.2 E
(g>)-.37 E(ABSTRA)264.535 183 Q(CT)-.3 E/F2 10/Times-Roman@0 SF
(apollo.hone)133 210.6 Q 1.705(yp.edu w)-.15 F 1.705(as brok)-.1 F 1.705
(en into on late No)-.1 F -.15(ve)-.15 G 1.705
(mber 7 using a publicly-kno).15 F(wn)-.25 E("e)108 222.6 Q 4.976
(xploit". The)-.15 F(attack)4.976 E 2.476
(er installed a root kit, a passw)-.1 F 2.477
(ord-logging and backdoored ssh)-.1 F(serv)108 234.6 Q(er)-.15 E 3.105
(,a)-.4 G .605(nd a netw)-3.105 F .605(ork snif)-.1 F(fer)-.25 E 5.605
(.T)-.55 G .605(he break-in could ha)-5.605 F .904 -.15(ve b)-.2 H .604
(een pre).15 F -.15(ve)-.25 G .604(nted by proper system).15 F 2.919
(maintenance. Since)108 246.6 R .419(there are v)2.919 F .419
(arious signs that the attack)-.25 F .419(er observ)-.1 F .42
(ed focuses on RedHat)-.15 F
(Linux systems, we focus on these systems, too.)108 258.6 Q/F3 10
/Times-Bold@0 SF 2.5(1. The)72 294.6 R(attack)2.5 E(er')-.1 E 2.5(sm)
-.37 G(odus operandi.)-2.5 E F2 .001(The initial attack e)87 310.2 R
.001(xploits a well-kno)-.15 F .001(wn format string problem in)-.25 F
F3 -.1(rp)2.501 G(c.statd).1 E F2 5(.T)C(he follo)-5 E
(wing line is added)-.25 E(to)87 322.2 Q F3(/etc/inetd.conf)2.5 E F2(:)A
/F4 8/Courier@0 SF(4545 stream tcp nowait root /bin/sh sh -i)102 340.2 Q
F2 .02(Using this back door)87 358.2 R 2.52(,au)-.4 G .021
(ser account adm1 \(user id 5000, primary group 5000\), and a passw)
-2.52 F .021(ord-less root)-.1 F 4.302(account named o)87 370.2 R 4.302
(wn are added to the system. Ev)-.25 F 4.302
(en at this early stage, the attack)-.15 F 4.302(er cleans)-.1 F F3(/v)
87 382.2 Q(ar/log/wtmp)-.1 E F2 2.996(,a)C .497(nd kills)-2.996 F F3
(klogd)2.997 E F2(and)2.997 E F3(syslogd)2.997 E F2 5.497(.H)C 2.997(ea)
-5.497 G .497(lso remo)-2.997 F -.15(ve)-.15 G 2.997(sa).15 G .797 -.15
(ny l)-2.997 H .497(ogging-related startup scripts from).15 F F3(/etc/r)
87 394.2 Q(c.d/init.d)-.18 E F2(.)A .316(The attack)87 409.8 R .316
(er then logs into the system as adm1 using)-.1 F F3(telnet)2.815 E F2
.315(\(or possibly an)2.815 F 2.815(yo)-.15 G .315
(ther remote login service)-2.815 F(such as)87 421.8 Q F3(ssh)2.5 E F2
(\), and uses)A F3(su)2.5 E F2(to switch identities to o)2.5 E
(wn \(i.e., root\).)-.25 E .381(The attack)87 437.4 R .381(er then uses)
-.1 F F3(ftp)2.881 E F2 .382
(to fetch his tool chest from some remote location.)2.881 F .382
(On apollo, this tool chest)5.382 F -.1(wa)87 449.4 S 2.728(se).1 G .228
(xtracted in the directory)-2.878 F F3(/usr/man/.Ci)2.728 E F2 5.227(.S)
C .227(ince this directory is hardcoded in some scripts found on)-5.227
F 1.188(apollo, it is lik)87 461.4 R 1.188(ely that it')-.1 F 3.688(sat)
-.55 G 1.188(ypical \214ngerprint of this speci\214c attack)-3.688 F(er)
-.1 E 6.188(.O)-.55 G(ther)-6.188 E 3.688(,s)-.4 G 1.189
(imilar attacks could,)-3.688 F(ho)87 473.4 Q(we)-.25 E -.15(ve)-.25 G
.8 -.4(r, u).15 H(se an).4 E 2.5(yo)-.15 G
(ther directory or directories.)-2.5 E 1.099(The apollo intruder then c\
ontinues by running a shell script included with his tool chest.)87 489
R 1.098(This script)6.098 F(remo)87 501 Q -.15(ve)-.15 G 4.517(sv).15 G
(arious)-4.767 E F3(.bash_history)4.517 E F2 2.018
(\214les, and replaces them by symbolic links to)4.518 F F3(/de)4.518 E
(v/null)-.15 E F2 7.018(.I)C 4.518(tt)-7.018 G 2.018(ries to)-4.518 F
3.775(replace the follo)87 513 R 3.775
(wing system binaries with trojan v)-.25 F 3.774
(ersions from the Linux Root Kit:)-.15 F F3(/bin/ps)6.274 E F2(,)A F3
(/usr/bin/top)87 525 Q F2(,)A F3(/usr/sbin/syslogd)13 E F2(,)A F3
(/bin/ls)13 E F2(,)A F3(/bin/netstat)13 E F2(,)A F3(/sbin/ifcon\214g)13
E F2(,)A F3(/usr/sbin/tcpd)13 E F2 13(,a)C(nd)-13 E F3
(/usr/sbin/in.identd)87 537 Q F2 5.548(.N)C .548
(ote that, on the RedHat systems the attack)-5.548 F .547
(er seems to be focused on,)-.1 F F3(syslogd)3.047 E F2(is)3.047 E
(actually installed in the)87 549 Q F3(/sbin)2.5 E F2(directory)2.5 E
2.5(,w)-.65 G(hich implies that it')-2.5 E 2.5(sn)-.55 G(ot replaced.)
-2.5 E(On apollo, backup copies of the original system binaries were st\
ored in)87 564.6 Q F3(/usr/man/.Ci/backup)2.5 E F2(.)A 1.258(The instal\
lation procedure used replicates the original \214les' time stamps on t\
he trojan horse binaries)87 580.2 R 2.5(installed. Just)87 592.2 R
(comparing time stamps will)2.5 E F1(not)2.5 E F2
(tell you whether or not these binaries were modi\214ed.)2.5 E 3.049
(The trojan horse v)87 607.8 R 3.049(ersion of)-.15 F F3(ifcon\214g)
5.548 E F2 3.048(conceals netw)5.548 F 3.048(ork interf)-.1 F 3.048
(aces running in promiscuous mode.)-.1 F(Additionally)87 619.8 Q(,)-.65
E F3(ps)4.278 E F2(and)4.278 E F3(top)4.278 E F2 1.779
(do not display certain programs.)4.278 F F3(ls)6.779 E F2 1.779
(is modi\214ed not to sho)4.279 F 4.279(wc)-.25 G 1.779(ertain \214les.)
-4.279 F F3(netstat)87 631.8 Q F2(and)2.5 E F3(tcpd)2.5 E F2(do not sho)
2.5 E 2.5(wc)-.25 G(ertain netw)-2.5 E(ork connections.)-.1 E .941
(The attack)87 647.4 R .941(er further has access to trojan v)-.1 F .941
(ersions of the)-.15 F F3(pstr)3.441 E(ee)-.18 E F2(,)A F3(killall)3.44
E F2 3.44(,a)C(nd)-3.44 E F3(\214nd)3.44 E F2 3.44(programs. Ho)3.44 F
(we)-.25 E -.15(ve)-.25 G -.4(r,).15 G
(these are not installed by the script he uses.)87 659.4 Q(Ne)87 675 Q
.913(xt, a pack)-.15 F .913(et snif)-.1 F .913
(fer is started and put into the background.)-.25 F .913
(This program monitors the netw)5.913 F .914(ork for)-.1 F
(ftp, telnet, rlogin, and imap netw)87 687 Q
(ork connections which are logged to)-.1 E F3(/usr/man/.Ci/tcp.log)2.5 E
F2(.)A(Another script then remo)87 702.6 Q -.15(ve)-.15 G 2.5(sv).15 G
(arious traces from the system')-2.75 E 2.5(sl)-.55 G(og \214les.)-2.5 E
1.949(The ne)87 718.2 R 1.948
(xt steps of the intruder are aimed at securing the system ag)-.15 F
1.948(ainst further attacks from other)-.05 F(attack)87 730.2 Q .538
(ers: V)-.1 F .538(arious possibly dangerous netw)-1.11 F .538
(ork services are remo)-.1 F -.15(ve)-.15 G .539
(d. The suid and sgid bits on v).15 F(arious)-.25 E(27 January 2001)
254.95 768 Q EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-2-)282.17 48 Q -.15(exe)87 84 S 1.608
(cutables on the system are cleaned. The intruder then installs his o)
.15 F 1.608(wn v)-.25 F 1.608(ersions of the follo)-.15 F(wing)-.25 E
(packages:)87 96 Q/F1 10/Times-Bold@0 SF(am-utils)3.498 E F0(,)A F1(lpr)
3.498 E F0(,)A F1(mak)3.498 E(e)-.1 E F0(,)A F1(ypser)3.498 E(v)-.1 E F0
(,)A F1(scr)3.498 E(een)-.18 E F0(,)A F1(telnet)3.498 E F0(,)A F1
(wu-ftpd)3.498 E F0(,)A F1(nfs-utils)3.499 E F0 5.999(.W)C .999
(ith the e)-6.399 F .999(xception of the)-.15 F F1(wu-ftpd)87 108 Q F0
(and)3.027 E F1(nfs-utils)3.027 E F0 .527
(packages, these were actually do)3.027 F 3.027(wngrades. Ho)-.25 F(we)
-.25 E -.15(ve)-.25 G 1.326 -.4(r, w).15 H .526(ith the further e).4 F
(xception)-.15 E(of)87 120 Q F1(mak)2.508 E(e)-.1 E F0 2.508(,a)C .008
(ll packages v)-2.508 F .009(ersions installed match security upgrades \
from RedHat for earlier releases of the)-.15 F(distrib)87 132 Q(ution.)
-.2 E(The attack)87 147.6 Q(er then installs a cop)-.1 E 2.5(yo)-.1 G
2.5(ft)-2.5 G(he)-2.5 E F1(BitchX)2.5 E F0(IRC client to)2.5 E F1
(/bin/bx)2.5 E F0(.)A(Ne)87 163.2 Q .745(xt, a modi\214ed v)-.15 F .745
(ersion of)-.15 F F1(ssh-1.2.27)3.245 E F0 .745
(is installed on the system, and started.)3.245 F .745(This v)5.745 F
.745(ersion includes a)-.15 F(uni)87 175.2 Q -.15(ve)-.25 G(rsal passw)
.15 E(ord, and logs an)-.1 E 2.5(yu)-.15 G(ser passw)-2.5 E
(ords it encounters to)-.1 E F1(/usr/tmp/nap)2.5 E F0(.)A .377
(After this back door is installed, the attack)87 190.8 R .377
(er uses a script to remo)-.1 F .678 -.15(ve t)-.15 H .378
(he adm1 and o).15 F .378(wn accounts.)-.25 F .378(As a)5.378 F(side ef)
87 202.8 Q(fect, the shutdo)-.25 E(wn account is remo)-.25 E -.15(ve)
-.15 G(d, too \(it contains "o).15 E(wn" as a substring\).)-.25 E
(The shell serv)87 218.4 Q(er added to)-.15 E F1(/etc/inetd.conf)2.5 E
F0(is remo)2.5 E -.15(ve)-.15 G 2.5(dm).15 G(anually)-2.5 E(.)-.65 E F1
2.5(2. Detecting)72 242.4 R 2.5(ac)2.5 G(ompr)-2.5 E(omise)-.18 E F0
1.425(Note that, in case of a successfull compromise, you can')87 258 R
3.924(tt)-.18 G 1.424(rust the system tools which are typically)-3.924 F
1.122(replaced by the attack)87 270 R(er)-.1 E 6.122(.S)-.55 G 1.122
(ee http://staf)-6.122 F(f.w)-.25 E(ashington.edu/dittrich/misc/f)-.1 E
(aqs/rootkits.f)-.1 E 1.122(aq for an F)-.1 F 2.223 -.55(AQ o)-.74 H(n)
.55 E -.1(wo)87 282 S(rking on a system which has been sub).1 E -.15(ve)
-.15 G(rted using a root kit.).15 E 1.6 -.8(We n)87 297.6 T .5 -.25
(ow l).8 H(ist v).25 E(arious traces left by the attack)-.25 E(er:)-.1 E
F1<83>87 313.2 Q F0(The shutdo)21.5 E(wn account has been remo)-.25 E
-.15(ve)-.15 G 2.5(df).15 G(rom)-2.5 E F1(/etc/passwd)2.5 E F0(and)2.5 E
F1(/etc/shado)2.5 E(w)-.1 E F0(.)A F1<83>87 328.8 Q F0
(System logging has stopped, and some netw)21.5 E(ork serv)-.1 E(ers ha)
-.15 E .3 -.15(ve d)-.2 H(isappeared from your system.).15 E F1<83>87
344.4 Q F0(There are unusual \214les in the)21.5 E F1(/de)2.5 E(v)-.15 E
F0(directory)2.5 E 5(.T)-.65 G 2.5(oc)-5.8 G(heck for these, type)-2.5 E
/F2 8/Courier@0 SF 4.8(#f)137 362.4 S(ind /dev -type f -print0 | less)
-4.8 E F0 .332(Note that system')112 380.4 R(s)-.55 E F1(\214nd)2.832 E
F0 .331(may lie to you.)2.831 F .331
(Also note that you may encounter \214le names which con-)5.331 F .426
(tain \(or entirely consist of\) special characters or white space.)112
392.4 R .427(Common tricks also include direc-)5.427 F(tory names lik)
112 404.4 Q 2.5(e")-.1 G(.. " \(tw)-2.5 E 2.5(od)-.1 G
(ots and a space character\).)-2.5 E F1<83>87 420 Q F0
(System \214les are inconsistent with the package manager')21.5 E 2.5
(si)-.55 G(dea of the system.)-2.5 E(Run)5 E F2 4.8(#r)137 438 S
(pm -V -a | grep ^..5)-4.8 E F0 .323(in order to \214nd such \214les.)
112 456 R .323(Note that an adv)5.323 F .322(anced attack)-.25 F .322
(er may ha)-.1 F .622 -.15(ve \214)-.2 H -.15(xe).15 G 2.822(dt).15 G
.322(he package manager')-2.822 F(s)-.55 E .789
(idea of the system, or may ha)112 468 R 1.089 -.15(ve i)-.2 H .789
(nstalled his o).15 F .789(wn v)-.25 F .79(ersions of an)-.15 F 3.29(yr)
-.15 G(ele)-3.29 E -.25(va)-.25 G .79(nt packages.).25 F .79(Also note)
5.79 F .13
(that the output of this command will be meaningless if you ha)112 480 R
.429 -.15(ve c)-.2 H .129(ompiled and installed your o).15 F(wn)-.25 E
-.15(ve)112 492 S(rsions of system softw).15 E(are.)-.1 E F1<83>87 507.6
Q F0 .171(System binaries are link)21.5 F .172(ed ag)-.1 F .172
(ainst libc.so.5 on a system based on GNU libc.)-.05 F(Use)5.172 E F1
(ldd)2.672 E F0 .172(\(1\) to check)B
(the system utilities mentioned in section 1.)112 519.6 Q F1 21.5<8369>
87 535.2 S(fcon\214g)-21.5 E F0(isn')2.5 E 2.5(ta)-.18 G
(ble to tell you about promiscuous interf)-2.5 E 2.5(aces. T)-.1 F
(ype this:)-.8 E F2 4.8(#s)137 553.2 S(trings /sbin/ifconfig)-4.8 E 4.8
(|f)9.6 G(grep PROMISC)-4.8 E F0 .943
(If there is no output, this means that)112 571.2 R F1(ifcon\214g)3.442
E F0 .942(is not able to report promiscuous interf)3.442 F 3.442
(aces. It)-.1 F(is)3.442 E(lik)112 583.2 Q
(ely that your host is or will be running a netw)-.1 E(ork snif)-.1 E
(fer in this case.)-.25 E F1<83>87 598.8 Q F0 -1.1(Yo)21.5 G 2.5(un)1.1
G(otice softw)-2.5 E(are upgrades \(or do)-.1 E
(wngrades\) on your system which weren')-.25 E 2.5(td)-.18 G
(one by you.)-2.5 E F1<83>87 614.4 Q F0 -1.1(Yo)21.5 G 3.297(uc)1.1 G
.797(an, of course, look for an)-3.297 F 3.297(yo)-.15 G 3.297(ft)-3.297
G .798(he \214les and directories mentioned in section 1.)-3.297 F
(Remember)5.798 E 1.497(that the system may ha)112 626.4 R 1.796 -.15
(ve a r)-.2 H 1.496
(oot kit installed. Apply the methods from the rootkit F).15 F 2.596
-.55(AQ w)-.74 H(hen).55 E(in)112 638.4 Q -.15(ve)-.4 G(stig).15 E
(ating the system.)-.05 E .958(If you notice an intrusion, please conta\
ct the computing center as soon as possible.)87 654 R -.35(Tr)5.959 G
3.459(yt).35 G 3.459(oa)-3.459 G -.2(vo)-3.659 G .959(id an).2 F(y)-.15
E(acti)87 666 Q .175(vities which could ruin e)-.25 F .175
(vidence found on the machine.)-.25 F .175(In particular)5.175 F 2.675
(,d)-.4 G 2.675(on)-2.675 G .174(ot e)-2.675 F -.15(ve)-.25 G 2.674(nr)
.15 G .174(ead an)-2.674 F 2.674<798c>-.15 G .174(les you)-2.674 F 1.267
(may \214nd in the intruder')87 678 R 3.768(st)-.55 G 1.268(ool chest.)
-3.768 F -.15(Fo)6.268 G 3.768(rm).15 G 1.268(ore advice on ho)-3.768 F
3.768(wt)-.25 G 3.768(oh)-3.768 G 1.268(andle a system brok)-3.768 F
1.268(en into, read)-.1 F(http://staf)87 690 Q(f.w)-.25 E
(ashington.edu/dittrich/misc/f)-.1 E(aqs/responding.f)-.1 E(aq.)-.1 E
(27 January 2001)254.95 768 Q EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(-3-)282.17 48 Q/F1 10/Times-Bold@0 SF 2.5
(3. Detecting)72 84 R(and defending against the vulnerability)2.5 E F0
.641(The speci\214c vulnerability e)87 99.6 R .641(xploited on apollo w)
-.15 F .641(as a format string b)-.1 F .64(ug in)-.2 F F1 -.1(rp)3.14 G
(c.statd).1 E F0 5.64(.T)C .64(his vulnerability)-5.64 F -.1(wa)87 111.6
S 2.56(sp).1 G .06(resent in v)-2.56 F .06(ersions of the)-.15 F F1
(nfs-utils)2.56 E F0 .061(package prior to 0.1.9.1-1.)2.56 F .061
(In order to check what v)5.061 F .061(ersion of the)-.15 F
(package is installed on your system, type:)87 123.6 Q/F2 8/Courier@0 SF
4.8(#r)102 141.6 S(pm -q nfs-utils)-4.8 E F0 .548
(If your system is vulnerable, either remo)87 159.6 R .848 -.15(ve t)
-.15 H(he).15 E F1(nfs-utils)3.048 E F0 .548(package when it')3.048 F
3.048(sn)-.55 G .548(ot needed for daily opera-)-3.048 F 4.241
(tions, or perform a general system update.)87 171.6 R 4.242
(Updated packages can be found at ftp://ftp.red-)9.242 F
(hat.com/pub/redhat/updates/.)87 183.6 Q .522
(Note that just updating or remo)87 199.2 R .521(ving the)-.15 F F1
(nfs-utils)3.021 E F0 .521(package will lea)3.021 F .821 -.15(ve o)-.2 H
.521(ther vulnerabilities open on your).15 F(system.)87 211.2 Q F1 2.5
(4. General)72 238.8 R(system management practices and further r)2.5 E
(eading)-.18 E F0 .17(Note that the intrusion on apollo could ha)87
254.4 R .47 -.15(ve b)-.2 H .17(een a).15 F -.2(vo)-.2 G .17
(ided by just updating softw).2 F .17(are in a timely manner)-.1 F(.)
-.55 E(In particular)87 266.4 Q 2.5(,w)-.4 G 2.5(es)-2.5 G
(uggest you follo)-2.5 E 2.5(wt)-.25 G(hese guidelines:)-2.5 E F1<83>87
282 Q F0 .7(Do not install an)21.5 F 3.199(ys)-.15 G .699
(elf-compiled softw)-3.199 F .699(are in)-.1 F F1(/usr)3.199 E F0 3.199
(,o)C 3.199(ro)-3.199 G .699(ther directories where softw)-3.199 F .699
(are controlled)-.1 F 1.66(by the package manager resides.)112 294 R
(Use)6.66 E F1(/usr/local)4.16 E F0 4.16(instead. If)4.16 F 1.66(you ha)
4.16 F 1.96 -.15(ve t)-.2 H 4.16(oi).15 G 1.66(nstall self-compiled)
-4.16 F(softw)112 306 Q 2.664(are in the parts of the \214le system con\
trolled by the package manager)-.1 F 5.164(,c)-.4 G 2.664(reate custom)
-5.164 F .04(packages and install them using the package manager)112 318
R 5.04(.A)-.55 G(rchi)-5.04 E .34 -.15(ve t)-.25 H .04
(he packages you generate of).15 F(\215ine,)-.25 E(ideally on CD-R)112
330 Q(OM.)-.4 E(That w)112 345.6 Q(ay)-.1 E 2.5(,y)-.65 G
(ou can use the package manager to quickly v)-2.5 E
(erify the consistenc)-.15 E 2.5(yo)-.15 G 2.5(fy)-2.5 G(our system.)
-2.5 E F1<83>87 361.2 Q F0 .607(Do not install or run an)21.5 F 3.107
(ys)-.15 G(oftw)-3.107 E .606(are you don')-.1 F 3.106(tn)-.18 G 3.106
(eed. F)-3.106 F .606(or instance, there is no need to run an NFS)-.15 F
(serv)112 373.2 Q 3.027(er if you aren')-.15 F 5.527(te)-.18 G 3.028
(xporting an)-5.677 F 3.028(ything that w)-.15 F(ay)-.1 E 8.028(.N)-.65
G 3.028(ote that def)-8.028 F 3.028(ault installations of Linux)-.1 F
(distrib)112 385.2 Q 1.298(utions will re)-.2 F 1.298
(gularly put lots of softw)-.15 F 1.298(are onto your machine which)-.1
F/F3 10/Times-Italic@0 SF(you)3.798 E F0 1.297(will ne)3.798 F -.15(ve)
-.25 G 3.797(rn).15 G(eed.)-3.797 E(This softw)112 397.2 Q(are may)-.1 E
2.5(,h)-.65 G -.25(ow)-2.5 G -2.15 -.25(ev e).25 H .8 -.4(r, b).25 H 2.5
(eq).4 G(uite helpful to an attack)-2.5 E(er)-.1 E(.)-.55 E F1<83>87
412.8 Q F0(Re)21.5 E(gularly monitor your system')-.15 E 2.5(sl)-.55 G
(og \214les.)-2.5 E F1<83>87 428.4 Q F0(Re)21.5 E(gularly apply v)-.15 E
(endor)-.15 E(-supplied updates.)-.2 E F1<83>87 444 Q F0 2.243
(Subscribe to your v)21.5 F(endor')-.15 E 4.743(sa)-.55 G 2.243
(nnouncement list.)-4.743 F 2.244
(If you are running RedHat Linux, subscribe)7.243 F
(yourself to redhat-w)112 456 Q
(atch-list at https://listman.redhat.com.)-.1 E(Finally)87 471.6 Q 4.589
(,t)-.65 G 2.089(he most important rule is: Be prepared.)-4.589 F 2.088
(Inform yourself about security before someone)12.088 F
(breaks into your system.)87 483.6 Q
(Some suggested reading is listed belo)5 E(w:)-.25 E F1<83>87 499.2 Q F3
(Pr)21.5 E .916(actical Unix & Internet Securtity)-.15 F F0 .916
(by Spaf)3.416 F .916(ford and Gar\214nk)-.25 F .916(el w)-.1 F .916
(as published by O'Reilly)-.1 F 5.917(.T)-.65 G(he)-5.917 E(book gi)112
511.2 Q -.15(ve)-.25 G 2.5(sy).15 G
(ou an idea of what you are going to encounter)-2.5 E(.)-.55 E F1<83>87
526.8 Q F0(www)21.5 E(.cert.or)-.65 E 6.644(g. This)-.18 F 4.144
(is the Computer Emer)6.644 F(genc)-.18 E 6.644(yR)-.15 G 4.144
(esponse T)-6.644 F(eam')-.7 E 6.643(sw)-.55 G 4.143(eb site, which has)
-6.643 F(information about vulnerabilities, ongoing acti)112 538.8 Q
(vities, and proacti)-.25 E .3 -.15(ve m)-.25 H(easures you can tak).15
E(e.)-.1 E F1<83>87 554.4 Q F0(www)21.5 E 2.595
(.securityfocus.com. This)-.65 F .095(web site w)2.595 F .095(as b)-.1 F
.095(uilt around the b)-.2 F .096(ugtraq mailing list.)-.2 F .096
(It has e)5.096 F(xtensi)-.15 E -.15(ve)-.25 G(information on an)112
566.4 Q 2.5(yr)-.15 G(ecent, security-related de)-2.5 E -.15(ve)-.25 G
(lopments.).15 E F1<83>87 582 Q F0 3.159(ftp.technotronic.com. Here,)
21.5 F .659(you can \214nd a collection of tools which will be used ag)
3.159 F .658(ainst you at)-.05 F .767(some point in the future.)112 594
R .768(It may be a good idea to become f)5.768 F .768
(amiliar with these tools before you)-.1 F(\214nd them on your o)112 606
Q(wn systems.)-.25 E(27 January 2001)254.95 768 Q EP
%%Trailer
end
%%EOF
